[aiter] WARNING: NUMA balancing is enabled, which may cause errors. It is recommended to disable NUMA balancing by running "sudo sh -c 'echo 0 > /proc/sys/kernel/numa_balancing'" for more details: https://rocm.docs.amd.com/en/latest/how-to/system-optimization/mi300x.html#disable-numa-auto-balancing
[W827 13:56:01.800370976 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())

start rmsnorm2d fuse add Smoothquant test
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                         aten::rms_norm         3.35%     707.699us        34.09%       7.207ms      71.356us       0.000us         0.00%       5.644ms      55.885us           101  
                                              aten::max         2.84%     599.380us         4.51%     952.540us       9.431us       2.242ms        18.08%       2.242ms      22.202us           101  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       2.242ms        18.08%       2.242ms      22.202us           101  
                                               aten::to         1.49%     315.326us        18.10%       3.825ms       6.312us       0.000us         0.00%       2.198ms       3.626us           606  
                                         aten::_to_copy         2.68%     566.950us        16.60%       3.510ms       8.688us       0.000us         0.00%       2.198ms       5.439us           404  
                                            aten::copy_         4.32%     912.277us        10.69%       2.260ms       5.593us       2.198ms        17.72%       2.198ms       5.439us           404  
                                              aten::mul         4.97%       1.051ms         9.77%       2.065ms       6.815us       2.124ms        17.13%       2.124ms       7.011us           303  
void at::native::elementwise_kernel<512, 1, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.386ms        11.18%       1.386ms       6.863us           202  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.140ms         9.19%       1.140ms       5.643us           202  
                                             aten::mean         2.29%     484.544us         4.05%     856.886us       8.484us       1.139ms         9.18%       1.139ms      11.277us           101  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 21.140ms
Self CUDA time total: 12.403ms

aten::add
hipLaunchKernel
aten::rms_norm
aten::to
aten::_to_copy
aten::empty_strided
aten::copy_
aten::pow
aten::result_type
aten::mean
aten::add_
aten::rsqrt
aten::mul
aten::type_as
aten::abs
aten::empty
aten::resize_
aten::max
aten::div
aten::eq
aten::lift_fresh
aten::index_put_
aten::_index_put_impl_
aten::item
aten::_local_scalar_dense
aten::masked_fill_
void at::native::vectorized_elementwise_kernel<8, at::native::CUDAFunctor_add<c10::BFloat16>, std::array<char*, 3ul> >(int, at::native::CUDAFunctor_add<c10::BFloat16>, std::array<char*, 3ul>)
void at::native::elementwise_kernel<512, 1, at::native::gpu_kernel_impl<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}>(at::TensorIteratorBase&, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1} const&)::{lambda(int)#1}>(int, at::native::gpu_kernel_impl<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}>(at::TensorIteratorBase&, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1} const&)::{lambda(int)#1})
void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::pow_tensor_scalar_kernel_impl<float, float>(at::TensorIteratorBase&, float)::{lambda(float)#1}, std::array<char*, 2ul> >(int, at::native::(anonymous namespace)::pow_tensor_scalar_kernel_impl<float, float>(at::TensorIteratorBase&, float)::{lambda(float)#1}, std::array<char*, 2ul>)
void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::MeanOps<float, float, float, float>, unsigned int, float, 4, 4> >(at::native::ReduceOp<float, at::native::MeanOps<float, float, float, float>, unsigned int, float, 4, 4>)
void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctorOnSelf_add<float>, std::array<char*, 2ul> >(int, at::native::CUDAFunctorOnSelf_add<float>, std::array<char*, 2ul>)
void at::native::vectorized_elementwise_kernel<4, at::native::rsqrt_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#2}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul> >(int, at::native::rsqrt_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#2}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>)
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl_nocast<at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > >(at::TensorIteratorBase&, at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > const&)::{lambda(int)#1}>(int, at::native::gpu_kernel_impl_nocast<at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > >(at::TensorIteratorBase&, at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > const&)::{lambda(int)#1})
void at::native::elementwise_kernel<128, 4, at::native::gpu_kernel_impl<at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > >(at::TensorIteratorBase&, at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > const&)::{lambda(int)#2}>(int, at::native::gpu_kernel_impl<at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > >(at::TensorIteratorBase&, at::native::BinaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> > const&)::{lambda(int)#2})
void at::native::vectorized_elementwise_kernel<4, at::native::bfloat16_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda(float)#1}, std::array<char*, 2ul> >(int, at::native::bfloat16_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda(float)#1}, std::array<char*, 2ul>)
void at::native::vectorized_elementwise_kernel<4, at::native::AbsFunctor<float>, std::array<char*, 2ul> >(int, at::native::AbsFunctor<float>, std::array<char*, 2ul>)
void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::MaxOps<float>, unsigned int, float, 4, 4> >(at::native::ReduceOp<float, at::native::MaxOps<float>, unsigned int, float, 4, 4>)
void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, std::array<char*, 2ul> >(int, at::native::BUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, std::array<char*, 2ul>)
void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, float, bool, at::native::(anonymous namespace)::CompareEqFunctor<float> >, std::array<char*, 2ul> >(int, at::native::AUnaryFunctor<float, float, bool, at::native::(anonymous namespace)::CompareEqFunctor<float> >, std::array<char*, 2ul>)
void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::masked_fill_kernel(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#7}::operator()() const::{lambda(float, bool)#1}, std::array<char*, 3ul> >(int, at::native::(anonymous namespace)::masked_fill_kernel(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#7}::operator()() const::{lambda(float, bool)#1}, std::array<char*, 3ul>)[aiter] start build [module_rmsnorm_fused] under /data/code/aiter/aiter/jit/build/module_rmsnorm_fused
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for host.
[92mSuccessfully preprocessed all matching files.[0m

void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl_nocast<at::native::BinaryFunctor<float, float, float, at::native::binary_internal::DivFunctor<float> > >(at::TensorIteratorBase&, at::native::BinaryFunctor<float, float, float, at::native::binary_internal::DivFunctor<float> > const&)::{lambda(int)#1}>(int, at::native::gpu_kernel_impl_nocast<at::native::BinaryFunctor<float, float, float, at::native::binary_internal::DivFunctor<float> > >(at::TensorIteratorBase&, at::native::BinaryFunctor<float, float, float, at::native::binary_internal::DivFunctor<float> > const&)::{lambda(int)#1})
void at::native::elementwise_kernel<512, 1, at::native::gpu_kernel_impl<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#2}::operator()() const::{lambda(signed char)#1}>(at::TensorIteratorBase&, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#2}::operator()() const::{lambda(signed char)#1} const&)::{lambda(int)#1}>(int, at::native::gpu_kernel_impl<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#2}::operator()() const::{lambda(signed char)#1}>(at::TensorIteratorBase&, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#2}::operator()() const::{lambda(signed char)#1} const&)::{lambda(int)#1})
hipDeviceSynchronize
hipFree
[aiter] [31mfailed build jit [module_rmsnorm_fused][0mâ†“â†“â†“â†“â†“â†“â†“â†“â†“â†“
-->[History]: Traceback (most recent call last):
-->  File "/data/code/aiter/aiter/jit/core.py", line 670, in wrapper
    module = get_module(md)
             ^^^^^^^^^^^^^^
-->  File "/data/code/aiter/aiter/jit/core.py", line 235, in get_module
    get_module_custom_op(md_name)
-->  File "/data/code/aiter/aiter/jit/utils/torch_guard.py", line 37, in outer_wrapper
    return getattr(torch.ops.aiter, op_name)(dummy, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->  File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1158, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->  File "/data/code/aiter/aiter/jit/utils/torch_guard.py", line 68, in custom_impl
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
-->  File "/data/code/aiter/aiter/jit/core.py", line 228, in get_module_custom_op
    __mds[md_name] = importlib.import_module(f"{__package__}.{md_name}")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->  File "/usr/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
-->  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
-->  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
-->ModuleNotFound[31merror:[0m No module named 'aiter.jit.module_rmsnorm_fused'
-->
During handling of the above exception, another exception occurred:

-->Traceback (most recent call last):
-->  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1478, in _run_ninja_build
    subprocess.run(
-->  File "/usr/lib/python3.12/subprocess.py", line 573, in run
    raise CalledProcessError(retcode, process.args,
-->subprocess.CalledProcess[31merror:[0m Command '['ninja', '-v', '-j', '179']' returned non-zero exit status 1.
-->
The above exception was the direct cause of the following exception:

-->Traceback (most recent call last):
-->  File "/data/code/aiter/aiter/jit/core.py", line 377, in MainFunc
    _jit_compile(
-->  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1224, in _jit_compile
    _write_ninja_file_and_build_library(
-->  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1350, in _write_ninja_file_and_build_library
    _run_ninja_build(
-->  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1495, in _run_ninja_build
    raise RuntimeError(message) from e
-->Runtime[31merror:[0m Error building extension 'module_rmsnorm_fused': [1/3] /opt/rocm/bin/hipcc  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template --offload-arch=native -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip -o rmsnorm_kernels_fused.cuda.o 
FAILED: rmsnorm_kernels_fused.cuda.o 
/opt/rocm/bin/hipcc  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template --offload-arch=native -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip -o rmsnorm_kernels_fused.cuda.o 
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
In file included from /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:11:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core_hip.hpp:31:
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/numeric/e8m0.hpp:90:16: warning: implicit conversion from 'const uint32_t' (aka 'const unsigned int') to 'float' changes value from 2139095041 to 2139095040 [-Wimplicit-const-int-float-conversion]
   90 |         return traits::NaN;
      |         ~~~~~~ ^~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:44:48: [31merror:[0m invalid vector element type '__hip_bfloat16'
   44 | using bf16x8_t = __hip_bfloat16 __attribute__((ext_vector_type(8)));
      |                                                ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:60:70: [31merror:[0m expected ';' at end of declaration
   60 |     auto src_wave_buffer_resource = make_wave_buffer_resource(buffer)
      |                                                                      ^
      |                                                                      ;
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:61:18: [31merror:[0m use of undeclared identifier '__builtin_amdgcn_raw_buffer_load_b128'
   61 |  int32x4_t tmp = __builtin_amdgcn_raw_buffer_load_b128(src_wave_buffer_resource,
      |                  ^
In file included from /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:11:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core_hip.hpp:7:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/algorithm/cluster_descriptor_hip.hpp:8:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/algorithm/coordinate_transform_hip.hpp:8:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/container/multi_index_hip.hpp:8:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/container/array_hip.hpp:14:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/functional_hip.hpp:10:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/container/sequence_hip.hpp:10:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/numeric/math_hip.hpp:10:
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/bit_cast.hpp:14:19: [31merror:[0m static assertion failed due to requirement 'sizeof(int __attribute__((ext_vector_type(4)))) == sizeof(__hip_bfloat16)': Do not support cast between different size of type
   14 |     static_assert(sizeof(X) == sizeof(Y), "Do not support cast between different size of type");
      |                   ^~~~~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:65:18: note: in instantiation of function template specialization 'ck_tile::bit_cast<__hip_bfloat16, int __attribute__((ext_vector_type(4)))>' requested here
   65 |  return ck_tile::bit_cast<bf16x8_t>(tmp);
      |                  ^
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/bit_cast.hpp:14:29: note: expression evaluates to '16 == 2'
   14 |     static_assert(sizeof(X) == sizeof(Y), "Do not support cast between different size of type");
      |                   ~~~~~~~~~~^~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/bit_cast.hpp:16:12: [31merror:[0m __builtin_bit_cast source size does not equal destination size (16 vs 2)
   16 |     return __builtin_bit_cast(Y, x);
      |            ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:65:2: [31merror:[0m void function 'amd_buffer_load_raw' should not return a value [-Wreturn-type]
   65 |  return ck_tile::bit_cast<bf16x8_t>(tmp);
      |  ^      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:365:77: [31merror:[0m use of undeclared identifier 'T'
  365 |       make_wave_buffer_resource(p_src_wave, src_element_space_size * sizeof(T));
      |                                                                             ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:365:45: [31merror:[0m use of undeclared identifier 'src_element_space_size'
  365 |       make_wave_buffer_resource(p_src_wave, src_element_space_size * sizeof(T));
      |                                             ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:365:33: [31merror:[0m use of undeclared identifier 'p_src_wave'
  365 |       make_wave_buffer_resource(p_src_wave, src_element_space_size * sizeof(T));
      |                                 ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:372:59: [31merror:[0m no matching function for call to 'amd_buffer_load_raw'
  372 |   reinterpret_cast<bf16x8_t*>(&(residual_out_local))[0] = amd_buffer_load_raw(input_v, id, 0);
      |                                                           ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:372:57: [31merror:[0m no viable overloaded '='
  372 |   reinterpret_cast<bf16x8_t*>(&(residual_out_local))[0] = amd_buffer_load_raw(input_v, id, 0);
      |   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:373:58: [31merror:[0m no matching function for call to 'amd_buffer_load_raw'
  373 |   reinterpret_cast<bf16x8_t*>(&(residual_in_local))[0] = amd_buffer_load_raw(residual_in, id, 0);
      |                                                          ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:373:56: [31merror:[0m no viable overloaded '='
  373 |   reinterpret_cast<bf16x8_t*>(&(residual_in_local))[0] = amd_buffer_load_raw(residual_in, id, 0);
      |   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:385:63: [31merror:[0m no matching function for call to 'amd_buffer_load_raw'
  385 |     reinterpret_cast<bf16x8_t*>(&(residual_out_local))[idx] = amd_buffer_load_raw(input_v, id, 0);
      |                                                               ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:385:61: [31merror:[0m no viable overloaded '='
  385 |     reinterpret_cast<bf16x8_t*>(&(residual_out_local))[idx] = amd_buffer_load_raw(input_v, id, 0);
      |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:387:66: [31merror:[0m no matching function for call to 'amd_buffer_load_raw'
  387 |     reinterpret_cast<bf16x8_t*>(&(residual_in_local))[idx & 1] = amd_buffer_load_raw(residual_in, id, 0);
      |                                                                  ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:387:64: [31merror:[0m no viable overloaded '='
  387 |     reinterpret_cast<bf16x8_t*>(&(residual_in_local))[idx & 1] = amd_buffer_load_raw(residual_in, id, 0);
      |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:364:19: [31merror:[0m default initialization of an object of const type 'const int32x4_t' (vector of 4 'int32_t' values)
  364 |   const int32x4_t src_wave_buffer_resource =
      |                   ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:506:10: note: in instantiation of function template specialization 'fused_add_smooth_quant_rms_norm_kernel<__hip_bfloat16, 5120, 8, 128, float, signed char>' requested here
  506 |  do { (( fused_add_smooth_quant_rms_norm_kernel<__hip_bfloat16, 5120, 8, 128, float, int8_t>))<<<(dim3(grid)), (dim3(block)), (0), (stream)>>>(params); } while (0);
      |          ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:416:24: [31merror:[0m assigning to 'int32x4_t' (vector of 4 'int32_t' values) from incompatible type 'arr_t<__hip_bfloat16, 8>'
  416 |     residual_out[id] = residual_out_local[idx];
      |                        ^~~~~~~~~~~~~~~~~~~~~~~
2 warnings and 19 errors generated when compiling for gfx942.
failed to execute:/opt/rocm/lib/llvm/bin/clang++  --offload-arch=native  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c -x hip /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip -o "rmsnorm_kernels_fused.cuda.o"
[2/3] /opt/rocm/bin/hipcc  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template --offload-arch=native -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_fused_pybind.cu -o rmsnorm_fused_pybind.cuda.o 
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for host.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for host.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated.
ninja: build stopped: subcommand failed.

[31mfailed build jit [module_rmsnorm_fused][0mâ†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘
[aiter] finish build [module_rmsnorm_fused], cost 49.30194141s
Traceback (most recent call last):
  File "/data/code/aiter/aiter/jit/core.py", line 670, in wrapper
    module = get_module(md)
             ^^^^^^^^^^^^^^
  File "/data/code/aiter/aiter/jit/core.py", line 235, in get_module
    get_module_custom_op(md_name)
  File "/data/code/aiter/aiter/jit/utils/torch_guard.py", line 37, in outer_wrapper
    return getattr(torch.ops.aiter, op_name)(dummy, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1158, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/code/aiter/aiter/jit/utils/torch_guard.py", line 68, in custom_impl
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/code/aiter/aiter/jit/core.py", line 228, in get_module_custom_op
    __mds[md_name] = importlib.import_module(f"{__package__}.{md_name}")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'aiter.jit.module_rmsnorm_fused'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1478, in _run_ninja_build
    subprocess.run(
  File "/usr/lib/python3.12/subprocess.py", line 573, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['ninja', '-v', '-j', '179']' returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/code/aiter/op_tests/test_rmsnorm2dFusedAddQuant.py", line 307, in <module>
    test_rmsnorm2d_fuseAdd_Smoothquant(args.m, args.n)
  File "/data/code/aiter/op_tests/test_rmsnorm2dFusedAddQuant.py", line 235, in test_rmsnorm2d_fuseAdd_Smoothquant
    test_rmsnorm2d_fuseAdd_Smoothquant_instance(
  File "/data/code/aiter/op_tests/test_rmsnorm2dFusedAddQuant.py", line 149, in test_rmsnorm2d_fuseAdd_Smoothquant_instance
    (b, res_b, yscale_b, ynorm_b), avg_b = run_ck(
                                           ^^^^^^^
  File "/data/code/aiter/aiter/test_common.py", line 29, in wrapper
    iter_used_memory, inputSize, _, _ = device_memory_profiling(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/code/aiter/aiter/test_common.py", line 134, in device_memory_profiling
    data = func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/code/aiter/op_tests/test_rmsnorm2dFusedAddQuant.py", line 76, in run_ck
    aiter.rmsnorm2d_with_add_smoothquant_hip(
  File "/data/code/aiter/aiter/jit/core.py", line 909, in wrapper_custom
    result = getattr(torch.ops.aiter, f"wrapper_{loadName}")(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1158, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/code/aiter/aiter/jit/core.py", line 891, in outer_wrapper
    wrapper(*args, **kwargs)
  File "/data/code/aiter/aiter/jit/core.py", line 695, in wrapper
    build_module(
  File "/data/code/aiter/aiter/jit/core.py", line 417, in build_module
    mp_lock(lockPath=lock_path, MainFunc=MainFunc, FinalFunc=FinalFunc)
  File "/data/code/aiter/aiter/jit/core.py", line 43, in mp_lock
    ret = MainFunc()
          ^^^^^^^^^^
  File "/data/code/aiter/aiter/jit/core.py", line 377, in MainFunc
    _jit_compile(
  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1224, in _jit_compile
    _write_ninja_file_and_build_library(
  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1350, in _write_ninja_file_and_build_library
    _run_ninja_build(
  File "/data/code/aiter/aiter/jit/utils/cpp_extension.py", line 1495, in _run_ninja_build
    raise RuntimeError(message) from e
RuntimeError: Error building extension 'module_rmsnorm_fused': [1/3] /opt/rocm/bin/hipcc  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template --offload-arch=native -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip -o rmsnorm_kernels_fused.cuda.o 
FAILED: rmsnorm_kernels_fused.cuda.o 
/opt/rocm/bin/hipcc  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template --offload-arch=native -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip -o rmsnorm_kernels_fused.cuda.o 
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
In file included from /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:11:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core_hip.hpp:31:
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/numeric/e8m0.hpp:90:16: warning: implicit conversion from 'const uint32_t' (aka 'const unsigned int') to 'float' changes value from 2139095041 to 2139095040 [-Wimplicit-const-int-float-conversion]
   90 |         return traits::NaN;
      |         ~~~~~~ ^~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:44:48: error: invalid vector element type '__hip_bfloat16'
   44 | using bf16x8_t = __hip_bfloat16 __attribute__((ext_vector_type(8)));
      |                                                ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:60:70: error: expected ';' at end of declaration
   60 |     auto src_wave_buffer_resource = make_wave_buffer_resource(buffer)
      |                                                                      ^
      |                                                                      ;
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:61:18: error: use of undeclared identifier '__builtin_amdgcn_raw_buffer_load_b128'
   61 |  int32x4_t tmp = __builtin_amdgcn_raw_buffer_load_b128(src_wave_buffer_resource,
      |                  ^
In file included from /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:11:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core_hip.hpp:7:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/algorithm/cluster_descriptor_hip.hpp:8:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/algorithm/coordinate_transform_hip.hpp:8:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/container/multi_index_hip.hpp:8:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/container/array_hip.hpp:14:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/functional_hip.hpp:10:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/container/sequence_hip.hpp:10:
In file included from /data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/numeric/math_hip.hpp:10:
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/bit_cast.hpp:14:19: error: static assertion failed due to requirement 'sizeof(int __attribute__((ext_vector_type(4)))) == sizeof(__hip_bfloat16)': Do not support cast between different size of type
   14 |     static_assert(sizeof(X) == sizeof(Y), "Do not support cast between different size of type");
      |                   ^~~~~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:65:18: note: in instantiation of function template specialization 'ck_tile::bit_cast<__hip_bfloat16, int __attribute__((ext_vector_type(4)))>' requested here
   65 |  return ck_tile::bit_cast<bf16x8_t>(tmp);
      |                  ^
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/bit_cast.hpp:14:29: note: expression evaluates to '16 == 2'
   14 |     static_assert(sizeof(X) == sizeof(Y), "Do not support cast between different size of type");
      |                   ~~~~~~~~~~^~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/ck/include/ck_tile/core/utility/bit_cast.hpp:16:12: error: __builtin_bit_cast source size does not equal destination size (16 vs 2)
   16 |     return __builtin_bit_cast(Y, x);
      |            ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:65:2: error: void function 'amd_buffer_load_raw' should not return a value [-Wreturn-type]
   65 |  return ck_tile::bit_cast<bf16x8_t>(tmp);
      |  ^      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:365:77: error: use of undeclared identifier 'T'
  365 |       make_wave_buffer_resource(p_src_wave, src_element_space_size * sizeof(T));
      |                                                                             ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:365:45: error: use of undeclared identifier 'src_element_space_size'
  365 |       make_wave_buffer_resource(p_src_wave, src_element_space_size * sizeof(T));
      |                                             ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:365:33: error: use of undeclared identifier 'p_src_wave'
  365 |       make_wave_buffer_resource(p_src_wave, src_element_space_size * sizeof(T));
      |                                 ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:372:59: error: no matching function for call to 'amd_buffer_load_raw'
  372 |   reinterpret_cast<bf16x8_t*>(&(residual_out_local))[0] = amd_buffer_load_raw(input_v, id, 0);
      |                                                           ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:372:57: error: no viable overloaded '='
  372 |   reinterpret_cast<bf16x8_t*>(&(residual_out_local))[0] = amd_buffer_load_raw(input_v, id, 0);
      |   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:373:58: error: no matching function for call to 'amd_buffer_load_raw'
  373 |   reinterpret_cast<bf16x8_t*>(&(residual_in_local))[0] = amd_buffer_load_raw(residual_in, id, 0);
      |                                                          ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:373:56: error: no viable overloaded '='
  373 |   reinterpret_cast<bf16x8_t*>(&(residual_in_local))[0] = amd_buffer_load_raw(residual_in, id, 0);
      |   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:385:63: error: no matching function for call to 'amd_buffer_load_raw'
  385 |     reinterpret_cast<bf16x8_t*>(&(residual_out_local))[idx] = amd_buffer_load_raw(input_v, id, 0);
      |                                                               ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:385:61: error: no viable overloaded '='
  385 |     reinterpret_cast<bf16x8_t*>(&(residual_out_local))[idx] = amd_buffer_load_raw(input_v, id, 0);
      |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:387:66: error: no matching function for call to 'amd_buffer_load_raw'
  387 |     reinterpret_cast<bf16x8_t*>(&(residual_in_local))[idx & 1] = amd_buffer_load_raw(residual_in, id, 0);
      |                                                                  ^~~~~~~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:58:30: note: candidate template ignored: couldn't infer template argument 'T'
   58 | __attribute__((device)) void amd_buffer_load_raw(void *buffer, int src_thread_addr_offset, int src_wave_addr_offset)
      |                              ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:387:64: error: no viable overloaded '='
  387 |     reinterpret_cast<bf16x8_t*>(&(residual_in_local))[idx & 1] = amd_buffer_load_raw(residual_in, id, 0);
      |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:375:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned int' for 1st argument
  375 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned int val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:381:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'int' for 1st argument
  381 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(int val) {
      |                                                                 ^         ~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:387:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'unsigned short' for 1st argument
  387 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(unsigned short val) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:393:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'short' for 1st argument
  393 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(short val) {
      |                                                                 ^         ~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:399:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const double' for 1st argument
  399 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const double f) {
      |                                                                 ^         ~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:405:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const float' for 1st argument
  405 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const float f) {
      |                                                                 ^         ~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:411:65: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  411 |   __attribute__((host)) __attribute__((device)) __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) {
      |                                                                 ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:417:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16_raw' for 1st argument
  417 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(const __hip_bfloat16_raw& hr) volatile {
      |                                                                          ^         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:423:74: note: candidate function not viable: cannot convert argument of incomplete type 'void' to 'const volatile __hip_bfloat16_raw &' for 1st argument
  423 |   __attribute__((host)) __attribute__((device)) volatile __hip_bfloat16& operator=(
      |                                                                          ^
  424 |       const volatile __hip_bfloat16_raw& hr) volatile {
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit copy assignment operator) not viable: cannot convert argument of incomplete type 'void' to 'const __hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/opt/rocm/include/hip/amd_detail/amd_hip_bf16.h:187:36: note: candidate function (the implicit move assignment operator) not viable: cannot convert argument of incomplete type 'void' to '__hip_bfloat16' for 1st argument
  187 | struct __attribute__((aligned(2))) __hip_bfloat16 {
      |                                    ^~~~~~~~~~~~~~
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:364:19: error: default initialization of an object of const type 'const int32x4_t' (vector of 4 'int32_t' values)
  364 |   const int32x4_t src_wave_buffer_resource =
      |                   ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:506:10: note: in instantiation of function template specialization 'fused_add_smooth_quant_rms_norm_kernel<__hip_bfloat16, 5120, 8, 128, float, signed char>' requested here
  506 |  do { (( fused_add_smooth_quant_rms_norm_kernel<__hip_bfloat16, 5120, 8, 128, float, int8_t>))<<<(dim3(grid)), (dim3(block)), (0), (stream)>>>(params); } while (0);
      |          ^
/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip:416:24: error: assigning to 'int32x4_t' (vector of 4 'int32_t' values) from incompatible type 'arr_t<__hip_bfloat16, 8>'
  416 |     residual_out[id] = residual_out_local[idx];
      |                        ^~~~~~~~~~~~~~~~~~~~~~~
2 warnings and 19 errors generated when compiling for gfx942.
failed to execute:/opt/rocm/lib/llvm/bin/clang++  --offload-arch=native  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c -x hip /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_kernels_fused.hip -o "rmsnorm_kernels_fused.cuda.o"
[2/3] /opt/rocm/bin/hipcc  -DWITH_HIP -DTORCH_EXTENSION_NAME=module_rmsnorm_fused -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1016\" -D_GLIBCXX_USE_CXX11_ABI=1 -I/data/code/aiter/aiter/jit/build/ck/include -I/data/code/aiter/aiter/jit/build/ck/library/include -I/data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/torch/csrc/api/include -isystem /usr/local/lib/python3.12/dist-packages/torch/include/TH -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THC -isystem /usr/local/lib/python3.12/dist-packages/torch/include/THH -isystem /opt/rocm/include -isystem /usr/include/python3.12 -fPIC -std=c++20 -O3 -std=c++20 -fPIC -D__HIP_PLATFORM_AMD__=1 -DUSE_ROCM=1 -DHIPBLAS_V2 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -mcmodel=large -fno-unique-section-names -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fgpu-flush-denormals-to-zero -U__HIP_NO_HALF_CONVERSIONS__ -Wno-vla-cxx-extension -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -mllvm --lsr-drop-solution=1 -mllvm -enable-post-misched=0 -DUSE_PROF_API=1 -Wno-macro-redefined -U__HIP_NO_HALF_OPERATORS__ -ffast-math -Wno-unused-result -Wno-undefined-func-template --offload-arch=native -DLEGACY_HIPBLAS_DIRECT --save-temps -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -mllvm --amdgpu-kernarg-preload-count=16 -Wno-switch-bool -D__HIP_PLATFORM_AMD__=1 -D__HIP_PLATFORM_HCC__=1 -Wno-missing-template-arg-list-after-template-kw -fno-gpu-rdc -c /data/code/aiter/aiter/jit/build/module_rmsnorm_fused/build/srcs/rmsnorm_fused_pybind.cu -o rmsnorm_fused_pybind.cuda.o 
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for gfx942.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for host.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated when compiling for host.
warning: unknown warning option '-Wno-missing-template-arg-list-after-template-kw'; did you mean '-Wno-gnu-string-literal-operator-template'? [-Wunknown-warning-option]
1 warning generated.
ninja: build stopped: subcommand failed.


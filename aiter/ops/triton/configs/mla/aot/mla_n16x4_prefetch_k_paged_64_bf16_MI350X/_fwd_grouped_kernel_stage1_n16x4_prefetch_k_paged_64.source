#blocked = #ttg.blocked<{sizePerThread = [1, 16], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [4, 16], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1, 16], threadsPerWarp = [64, 1], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked3 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked4 = #ttg.blocked<{sizePerThread = [1, 1, 16], threadsPerWarp = [16, 1, 4], warpsPerCTA = [1, 1, 4], order = [2, 1, 0]}>
#blocked5 = #ttg.blocked<{sizePerThread = [1, 16, 1], threadsPerWarp = [16, 4, 1], warpsPerCTA = [1, 4, 1], order = [1, 2, 0]}>
#blocked6 = #ttg.blocked<{sizePerThread = [16, 4], threadsPerWarp = [4, 16], warpsPerCTA = [4, 1], order = [0, 1]}>
#blocked7 = #ttg.blocked<{sizePerThread = [16, 1], threadsPerWarp = [1, 64], warpsPerCTA = [4, 1], order = [0, 1]}>
#linear = #ttg.linear<{register = [[0, 0, 1], [0, 1, 0], [0, 2, 0], [0, 64, 0], [0, 128, 0]], lane = [[1, 0, 0], [2, 0, 0], [4, 0, 0], [8, 0, 0], [0, 4, 0], [0, 8, 0]], warp = [[0, 16, 0], [0, 32, 0]], block = []}>
#linear1 = #ttg.linear<{register = [[0, 1, 0], [0, 0, 1], [0, 0, 2], [0, 0, 64], [0, 0, 128]], lane = [[1, 0, 0], [2, 0, 0], [4, 0, 0], [8, 0, 0], [0, 0, 4], [0, 0, 8]], warp = [[0, 0, 16], [0, 0, 32]], block = []}>
#linear2 = #ttg.linear<{register = [[0, 256], [0, 1], [0, 2], [0, 64], [0, 128]], lane = [[1, 0], [2, 0], [4, 0], [8, 0], [0, 4], [0, 8]], warp = [[0, 16], [0, 32]], block = []}>
#loc = loc(unknown)
#loc1 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":41:0)
#loc317 = loc("/workspace/triton/python/triton/language/standard.py":32:0)
#loc320 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":28:0)
#loc349 = loc("/workspace/triton/python/triton/language/standard.py":175:0)
#loc353 = loc("/workspace/triton/python/triton/language/standard.py":167:0)
#loc357 = loc("/workspace/triton/python/triton/language/standard.py":285:0)
#loc361 = loc("/workspace/triton/python/triton/language/standard.py":260:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [1, 4], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 8, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared2 = #ttg.swizzled_shared<{vec = 16, perPhase = 1, maxPhase = 16, order = [0, 1]}>
#smem = #ttg.shared_memory
#loc365 = loc("Q"(#loc1))
#loc366 = loc("K_Buffer"(#loc1))
#loc367 = loc("V_buffer"(#loc1))
#loc368 = loc("sm_scale"(#loc1))
#loc369 = loc("kv_indptr"(#loc1))
#loc370 = loc("kv_indices"(#loc1))
#loc371 = loc("Att_Out"(#loc1))
#loc372 = loc("Att_Lse"(#loc1))
#loc373 = loc("stride_qb"(#loc1))
#loc374 = loc("stride_qh"(#loc1))
#loc375 = loc("stride_buf_kbs"(#loc1))
#loc376 = loc("stride_buf_kh"(#loc1))
#loc377 = loc("stride_mid_ob"(#loc1))
#loc378 = loc("stride_mid_oh"(#loc1))
#loc379 = loc("stride_mid_os"(#loc1))
#loc380 = loc("stride_mid_lse_b"(#loc1))
#loc381 = loc("stride_mid_lse_h"(#loc1))
#loc382 = loc("stride_mid_lse_s"(#loc1))
#loc383 = loc("stride_b_block_table"(#loc1))
#loc648 = loc("pid"(#loc320))
#loc649 = loc("GRID_MN"(#loc320))
#loc667 = loc("x"(#loc317))
#loc668 = loc("input"(#loc349))
#loc669 = loc("a"(#loc353))
#loc670 = loc("b"(#loc353))
#loc671 = loc("input"(#loc357))
#loc672 = loc("a"(#loc361))
#loc673 = loc("b"(#loc361))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 4 : i32, ttg.target = "hip:gfx950", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @_fwd_grouped_kernel_stage1_n16x4_prefetch_k_paged_64(%Q: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Q"(#loc1)), %K_Buffer: !tt.ptr<bf16> {tt.divisibility = 16 : i32} loc("K_Buffer"(#loc1)), %V_buffer: !tt.ptr<bf16> {tt.divisibility = 16 : i32} loc("V_buffer"(#loc1)), %sm_scale: f32 {tt.divisibility = 16 : i32} loc("sm_scale"(#loc1)), %kv_indptr: !tt.ptr<i32> {tt.divisibility = 16 : i32} loc("kv_indptr"(#loc1)), %kv_indices: !tt.ptr<i32> {tt.divisibility = 16 : i32} loc("kv_indices"(#loc1)), %Att_Out: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("Att_Out"(#loc1)), %Att_Lse: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("Att_Lse"(#loc1)), %stride_qb: i32 {tt.divisibility = 16 : i32} loc("stride_qb"(#loc1)), %stride_qh: i32 {tt.divisibility = 16 : i32} loc("stride_qh"(#loc1)), %stride_buf_kbs: i32 {tt.divisibility = 16 : i32} loc("stride_buf_kbs"(#loc1)), %stride_buf_kh: i32 {tt.divisibility = 16 : i32} loc("stride_buf_kh"(#loc1)), %stride_mid_ob: i32 {tt.divisibility = 16 : i32} loc("stride_mid_ob"(#loc1)), %stride_mid_oh: i32 {tt.divisibility = 16 : i32} loc("stride_mid_oh"(#loc1)), %stride_mid_os: i32 {tt.divisibility = 16 : i32} loc("stride_mid_os"(#loc1)), %stride_mid_lse_b: i32 loc("stride_mid_lse_b"(#loc1)), %stride_mid_lse_h: i32 loc("stride_mid_lse_h"(#loc1)), %stride_mid_lse_s: i32 loc("stride_mid_lse_s"(#loc1)), %stride_b_block_table: i32 loc("stride_b_block_table"(#loc1))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc384)
    %num_q_head_blk = tt.call @"triton.language.standard.cdiv____(0,)cconstexpr_8__(1,)cconstexpr_16_"() : () -> i32 loc(#loc385)
    %pid_head_kv_split = arith.constant 8 : i32 loc(#loc386)
    %pid_head_kv_split_0 = arith.constant 8 : i32 loc(#loc386)
    %pid_head_kv_split_1 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc386)
    %pid_head_kv_split_2 = arith.extsi %pid_head_kv_split_0 : i32 to i64 loc(#loc386)
    %pid_head_kv_split_3 = arith.muli %pid_head_kv_split_1, %pid_head_kv_split_2 : i64 loc(#loc386)
    %pid_head_kv_split_4 = arith.constant 2147483647 : i64 loc(#loc386)
    %pid_head_kv_split_5 = arith.constant -2147483648 : i64 loc(#loc386)
    %pid_head_kv_split_6 = arith.cmpi sle, %pid_head_kv_split_3, %pid_head_kv_split_4 : i64 loc(#loc386)
    %pid_head_kv_split_7 = arith.cmpi sge, %pid_head_kv_split_3, %pid_head_kv_split_5 : i64 loc(#loc386)
    %pid_head_kv_split_8 = arith.andi %pid_head_kv_split_6, %pid_head_kv_split_7 : i1 loc(#loc386)
    %pid_head_kv_split_9 = arith.muli %num_q_head_blk, %pid_head_kv_split_0 : i32 loc(#loc386)
    %pid_head_kv_split_10 = arith.remsi %pid, %pid_head_kv_split_9 : i32 loc(#loc387)
    %pid_head_kv_split_11 = arith.constant 8 : i32 loc(#loc388)
    %pid_head_kv_split_12 = arith.constant 8 : i32 loc(#loc388)
    %pid_head_kv_split_13 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc388)
    %pid_head_kv_split_14 = arith.extsi %pid_head_kv_split_12 : i32 to i64 loc(#loc388)
    %pid_head_kv_split_15 = arith.muli %pid_head_kv_split_13, %pid_head_kv_split_14 : i64 loc(#loc388)
    %pid_head_kv_split_16 = arith.constant 2147483647 : i64 loc(#loc388)
    %pid_head_kv_split_17 = arith.constant -2147483648 : i64 loc(#loc388)
    %pid_head_kv_split_18 = arith.cmpi sle, %pid_head_kv_split_15, %pid_head_kv_split_16 : i64 loc(#loc388)
    %pid_head_kv_split_19 = arith.cmpi sge, %pid_head_kv_split_15, %pid_head_kv_split_17 : i64 loc(#loc388)
    %pid_head_kv_split_20 = arith.andi %pid_head_kv_split_18, %pid_head_kv_split_19 : i1 loc(#loc388)
    %pid_head_kv_split_21 = arith.muli %num_q_head_blk, %pid_head_kv_split_12 : i32 loc(#loc388)
    %pid_head_kv_split_22 = tt.call @"aiter.ops.triton.utils._triton.pid_preprocessing.remap_xcd__i32_i32__(2,)cconstexpr_8_"(%pid_head_kv_split_10, %pid_head_kv_split_21) : (i32, i32) -> i32 loc(#loc389)
    %cur_head_id = arith.remsi %pid_head_kv_split_22, %num_q_head_blk : i32 loc(#loc390)
    %split_kv_id = arith.divsi %pid_head_kv_split_22, %num_q_head_blk : i32 loc(#loc391)
    %split_kv_id_23 = arith.constant 8 : i32 loc(#loc392)
    %split_kv_id_24 = arith.constant 8 : i32 loc(#loc392)
    %split_kv_id_25 = arith.remsi %split_kv_id, %split_kv_id_24 : i32 loc(#loc392)
    %cur_batch = arith.constant 8 : i32 loc(#loc393)
    %cur_batch_26 = arith.constant 8 : i32 loc(#loc393)
    %cur_batch_27 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc393)
    %cur_batch_28 = arith.extsi %cur_batch_26 : i32 to i64 loc(#loc393)
    %cur_batch_29 = arith.muli %cur_batch_27, %cur_batch_28 : i64 loc(#loc393)
    %cur_batch_30 = arith.constant 2147483647 : i64 loc(#loc393)
    %cur_batch_31 = arith.constant -2147483648 : i64 loc(#loc393)
    %cur_batch_32 = arith.cmpi sle, %cur_batch_29, %cur_batch_30 : i64 loc(#loc393)
    %cur_batch_33 = arith.cmpi sge, %cur_batch_29, %cur_batch_31 : i64 loc(#loc393)
    %cur_batch_34 = arith.andi %cur_batch_32, %cur_batch_33 : i1 loc(#loc393)
    %cur_batch_35 = arith.muli %num_q_head_blk, %cur_batch_26 : i32 loc(#loc393)
    %cur_batch_36 = arith.divsi %pid, %cur_batch_35 : i32 loc(#loc394)
    %cur_batch_37 = arith.constant 512 : i32 loc(#loc395)
    %cur_batch_38 = arith.constant 512 : i32 loc(#loc395)
    %cur_batch_39 = arith.remsi %cur_batch_36, %cur_batch_38 : i32 loc(#loc395)
    %cur_batch_kv_start_idx = tt.addptr %kv_indptr, %cur_batch_39 : !tt.ptr<i32>, i32 loc(#loc396)
    %cur_batch_kv_start_idx_40 = tt.load %cur_batch_kv_start_idx : !tt.ptr<i32> loc(#loc397)
    %cur_batch_kv_end_idx = tt.addptr %kv_indptr, %cur_batch_39 : !tt.ptr<i32>, i32 loc(#loc398)
    %cur_batch_kv_end_idx_41 = arith.constant 1 : i32 loc(#loc399)
    %cur_batch_kv_end_idx_42 = tt.addptr %cur_batch_kv_end_idx, %cur_batch_kv_end_idx_41 : !tt.ptr<i32>, i32 loc(#loc399)
    %cur_batch_kv_end_idx_43 = tt.load %cur_batch_kv_end_idx_42 : !tt.ptr<i32> loc(#loc400)
    %smem_q0_nope = ttg.local_alloc : () -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc401)
    %smem_q1_nope = ttg.local_alloc : () -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc402)
    %smem_q_rope = ttg.local_alloc : () -> !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc403)
    %smem_p = ttg.local_alloc : () -> !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> loc(#loc404)
    %cur_head = arith.constant 8 : i32 loc(#loc405)
    %cur_head_44 = arith.constant 8 : i32 loc(#loc405)
    %cur_head_45 = arith.extsi %cur_head_id : i32 to i64 loc(#loc405)
    %cur_head_46 = arith.extsi %cur_head_44 : i32 to i64 loc(#loc405)
    %cur_head_47 = arith.muli %cur_head_45, %cur_head_46 : i64 loc(#loc405)
    %cur_head_48 = arith.constant 2147483647 : i64 loc(#loc405)
    %cur_head_49 = arith.constant -2147483648 : i64 loc(#loc405)
    %cur_head_50 = arith.cmpi sle, %cur_head_47, %cur_head_48 : i64 loc(#loc405)
    %cur_head_51 = arith.cmpi sge, %cur_head_47, %cur_head_49 : i64 loc(#loc405)
    %cur_head_52 = arith.andi %cur_head_50, %cur_head_51 : i1 loc(#loc405)
    %cur_head_53 = arith.muli %cur_head_id, %cur_head_44 : i32 loc(#loc405)
    %cur_head_54 = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc406)
    %cur_head_55 = tt.splat %cur_head_53 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_56 = arith.extsi %cur_head_55 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_57 = arith.extsi %cur_head_54 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_58 = arith.addi %cur_head_56, %cur_head_57 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_59 = arith.constant 2147483647 : i64 loc(#loc407)
    %cur_head_60 = arith.constant -2147483648 : i64 loc(#loc407)
    %cur_head_61 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_62 = arith.cmpi sle, %cur_head_58, %cur_head_61 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_63 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_64 = arith.cmpi sge, %cur_head_58, %cur_head_63 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_65 = arith.andi %cur_head_62, %cur_head_64 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %cur_head_66 = arith.addi %cur_head_55, %cur_head_54 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc407)
    %mask_h = arith.constant 1 : i32 loc(#loc408)
    %mask_h_67 = arith.constant 1 : i32 loc(#loc408)
    %mask_h_68 = arith.extsi %cur_head_id : i32 to i64 loc(#loc408)
    %mask_h_69 = arith.extsi %mask_h_67 : i32 to i64 loc(#loc408)
    %mask_h_70 = arith.addi %mask_h_68, %mask_h_69 : i64 loc(#loc408)
    %mask_h_71 = arith.constant 2147483647 : i64 loc(#loc408)
    %mask_h_72 = arith.constant -2147483648 : i64 loc(#loc408)
    %mask_h_73 = arith.cmpi sle, %mask_h_70, %mask_h_71 : i64 loc(#loc408)
    %mask_h_74 = arith.cmpi sge, %mask_h_70, %mask_h_72 : i64 loc(#loc408)
    %mask_h_75 = arith.andi %mask_h_73, %mask_h_74 : i1 loc(#loc408)
    %mask_h_76 = arith.addi %cur_head_id, %mask_h_67 : i32 loc(#loc408)
    %mask_h_77 = arith.constant 8 : i32 loc(#loc409)
    %mask_h_78 = arith.constant 8 : i32 loc(#loc409)
    %mask_h_79 = arith.extsi %mask_h_76 : i32 to i64 loc(#loc409)
    %mask_h_80 = arith.extsi %mask_h_78 : i32 to i64 loc(#loc409)
    %mask_h_81 = arith.muli %mask_h_79, %mask_h_80 : i64 loc(#loc409)
    %mask_h_82 = arith.constant 2147483647 : i64 loc(#loc409)
    %mask_h_83 = arith.constant -2147483648 : i64 loc(#loc409)
    %mask_h_84 = arith.cmpi sle, %mask_h_81, %mask_h_82 : i64 loc(#loc409)
    %mask_h_85 = arith.cmpi sge, %mask_h_81, %mask_h_83 : i64 loc(#loc409)
    %mask_h_86 = arith.andi %mask_h_84, %mask_h_85 : i1 loc(#loc409)
    %mask_h_87 = arith.muli %mask_h_76, %mask_h_78 : i32 loc(#loc409)
    %mask_h_88 = tt.splat %mask_h_87 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc410)
    %mask_h_89 = arith.cmpi slt, %cur_head_66, %mask_h_88 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc410)
    %mask_h_90 = arith.constant 8 : i32 loc(#loc411)
    %mask_h_91 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc411)
    %mask_h_92 = arith.cmpi slt, %cur_head_66, %mask_h_91 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc411)
    %mask_h_93 = arith.andi %mask_h_89, %mask_h_92 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc412)
    %cur_N = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc413)
    %cur_N_pe = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc414)
    %cur_head_pe = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc415)
    %mask_h_pe = arith.constant 8 : i32 loc(#loc416)
    %mask_h_pe_94 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc416)
    %mask_h_pe_95 = arith.cmpi slt, %cur_head_pe, %mask_h_pe_94 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc416)
    %mask_h_pe_96 = arith.constant 8 : i32 loc(#loc417)
    %mask_h_pe_97 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc417)
    %mask_h_pe_98 = arith.cmpi slt, %cur_head_pe, %mask_h_pe_97 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc417)
    %mask_h_pe_99 = arith.andi %mask_h_pe_95, %mask_h_pe_98 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc418)
    %offs_c = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc419)
    %offs_om = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc420)
    %mask_om = arith.constant 8 : i32 loc(#loc421)
    %mask_om_100 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc421)
    %mask_om_101 = arith.cmpi slt, %offs_om, %mask_om_100 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc421)
    %mask_om_102 = arith.constant 8 : i32 loc(#loc422)
    %mask_om_103 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc422)
    %mask_om_104 = arith.cmpi slt, %offs_om, %mask_om_103 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc422)
    %mask_om_105 = arith.andi %mask_om_101, %mask_om_104 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc423)
    %offs_on = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc424)
    %mask_on = arith.constant 512 : i32 loc(#loc425)
    %mask_on_106 = arith.constant dense<512> : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc425)
    %mask_on_107 = arith.cmpi slt, %offs_on, %mask_on_106 : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc425)
    %offs_qk_r = tt.make_range {end = 576 : i32, start = 512 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc426)
    %offs_k_c = tt.make_range {end = 256 : i32, start = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc427)
    %offs_k_r = tt.make_range {end = 576 : i32, start = 512 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc428)
    %cur_batch_seq_len = arith.extsi %cur_batch_kv_end_idx_43 : i32 to i64 loc(#loc429)
    %cur_batch_seq_len_108 = arith.extsi %cur_batch_kv_start_idx_40 : i32 to i64 loc(#loc429)
    %cur_batch_seq_len_109 = arith.subi %cur_batch_seq_len, %cur_batch_seq_len_108 : i64 loc(#loc429)
    %cur_batch_seq_len_110 = arith.constant 2147483647 : i64 loc(#loc429)
    %cur_batch_seq_len_111 = arith.constant -2147483648 : i64 loc(#loc429)
    %cur_batch_seq_len_112 = arith.cmpi sle, %cur_batch_seq_len_109, %cur_batch_seq_len_110 : i64 loc(#loc429)
    %cur_batch_seq_len_113 = arith.cmpi sge, %cur_batch_seq_len_109, %cur_batch_seq_len_111 : i64 loc(#loc429)
    %cur_batch_seq_len_114 = arith.andi %cur_batch_seq_len_112, %cur_batch_seq_len_113 : i1 loc(#loc429)
    %cur_batch_seq_len_115 = arith.subi %cur_batch_kv_end_idx_43, %cur_batch_kv_start_idx_40 : i32 loc(#loc429)
    %cur_batch_block_nums = tt.call @"triton.language.standard.cdiv__i32__(1,)cconstexpr_64_"(%cur_batch_seq_len_115) : (i32) -> i32 loc(#loc430)
    %off_q_pe = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc431)
    %off_q_pe_116 = arith.extsi %stride_qb : i32 to i64 loc(#loc431)
    %off_q_pe_117 = arith.muli %off_q_pe, %off_q_pe_116 : i64 loc(#loc431)
    %off_q_pe_118 = arith.constant 2147483647 : i64 loc(#loc431)
    %off_q_pe_119 = arith.constant -2147483648 : i64 loc(#loc431)
    %off_q_pe_120 = arith.cmpi sle, %off_q_pe_117, %off_q_pe_118 : i64 loc(#loc431)
    %off_q_pe_121 = arith.cmpi sge, %off_q_pe_117, %off_q_pe_119 : i64 loc(#loc431)
    %off_q_pe_122 = arith.andi %off_q_pe_120, %off_q_pe_121 : i1 loc(#loc431)
    %off_q_pe_123 = arith.muli %cur_batch_39, %stride_qb : i32 loc(#loc431)
    %off_q_pe_124 = tt.expand_dims %cur_head_pe {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<16x1xi32, #blocked3> loc(#loc432)
    %off_q_pe_125 = tt.splat %stride_qh : i32 -> tensor<16x1xi32, #blocked3> loc(#loc433)
    %off_q_pe_126 = arith.extsi %off_q_pe_124 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_127 = arith.extsi %off_q_pe_125 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_128 = arith.muli %off_q_pe_126, %off_q_pe_127 : tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_129 = arith.constant 2147483647 : i64 loc(#loc433)
    %off_q_pe_130 = arith.constant -2147483648 : i64 loc(#loc433)
    %off_q_pe_131 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_132 = arith.cmpi sle, %off_q_pe_128, %off_q_pe_131 : tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_133 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_134 = arith.cmpi sge, %off_q_pe_128, %off_q_pe_133 : tensor<16x1xi64, #blocked3> loc(#loc433)
    %off_q_pe_135 = arith.andi %off_q_pe_132, %off_q_pe_134 : tensor<16x1xi1, #blocked3> loc(#loc433)
    %off_q_pe_136 = arith.muli %off_q_pe_124, %off_q_pe_125 : tensor<16x1xi32, #blocked3> loc(#loc433)
    %off_q_pe_137 = tt.splat %off_q_pe_123 : i32 -> tensor<16x1xi32, #blocked3> loc(#loc434)
    %off_q_pe_138 = arith.extsi %off_q_pe_137 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_139 = arith.extsi %off_q_pe_136 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_140 = arith.addi %off_q_pe_138, %off_q_pe_139 : tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_141 = arith.constant 2147483647 : i64 loc(#loc434)
    %off_q_pe_142 = arith.constant -2147483648 : i64 loc(#loc434)
    %off_q_pe_143 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_144 = arith.cmpi sle, %off_q_pe_140, %off_q_pe_143 : tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_145 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_146 = arith.cmpi sge, %off_q_pe_140, %off_q_pe_145 : tensor<16x1xi64, #blocked3> loc(#loc434)
    %off_q_pe_147 = arith.andi %off_q_pe_144, %off_q_pe_146 : tensor<16x1xi1, #blocked3> loc(#loc434)
    %off_q_pe_148 = arith.addi %off_q_pe_137, %off_q_pe_136 : tensor<16x1xi32, #blocked3> loc(#loc434)
    %off_q_pe_149 = tt.expand_dims %offs_qk_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> -> tensor<1x64xi32, #blocked3> loc(#loc435)
    %off_q_pe_150 = tt.broadcast %off_q_pe_148 : tensor<16x1xi32, #blocked3> -> tensor<16x64xi32, #blocked3> loc(#loc436)
    %off_q_pe_151 = tt.broadcast %off_q_pe_149 : tensor<1x64xi32, #blocked3> -> tensor<16x64xi32, #blocked3> loc(#loc436)
    %off_q_pe_152 = arith.extsi %off_q_pe_150 : tensor<16x64xi32, #blocked3> to tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_153 = arith.extsi %off_q_pe_151 : tensor<16x64xi32, #blocked3> to tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_154 = arith.addi %off_q_pe_152, %off_q_pe_153 : tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_155 = arith.constant 2147483647 : i64 loc(#loc436)
    %off_q_pe_156 = arith.constant -2147483648 : i64 loc(#loc436)
    %off_q_pe_157 = arith.constant dense<2147483647> : tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_158 = arith.cmpi sle, %off_q_pe_154, %off_q_pe_157 : tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_159 = arith.constant dense<-2147483648> : tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_160 = arith.cmpi sge, %off_q_pe_154, %off_q_pe_159 : tensor<16x64xi64, #blocked3> loc(#loc436)
    %off_q_pe_161 = arith.andi %off_q_pe_158, %off_q_pe_160 : tensor<16x64xi1, #blocked3> loc(#loc436)
    %off_q_pe_162 = arith.addi %off_q_pe_150, %off_q_pe_151 : tensor<16x64xi32, #blocked3> loc(#loc436)
    %offs_q = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc437)
    %offs_q_163 = arith.extsi %stride_qb : i32 to i64 loc(#loc437)
    %offs_q_164 = arith.muli %offs_q, %offs_q_163 : i64 loc(#loc437)
    %offs_q_165 = arith.constant 2147483647 : i64 loc(#loc437)
    %offs_q_166 = arith.constant -2147483648 : i64 loc(#loc437)
    %offs_q_167 = arith.cmpi sle, %offs_q_164, %offs_q_165 : i64 loc(#loc437)
    %offs_q_168 = arith.cmpi sge, %offs_q_164, %offs_q_166 : i64 loc(#loc437)
    %offs_q_169 = arith.andi %offs_q_167, %offs_q_168 : i1 loc(#loc437)
    %offs_q_170 = arith.muli %cur_batch_39, %stride_qb : i32 loc(#loc437)
    %offs_q_171 = tt.expand_dims %cur_head_66 {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi32, #blocked> loc(#loc438)
    %offs_q_172 = tt.splat %stride_qh : i32 -> tensor<16x1xi32, #blocked> loc(#loc439)
    %offs_q_173 = arith.extsi %offs_q_171 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_174 = arith.extsi %offs_q_172 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_175 = arith.muli %offs_q_173, %offs_q_174 : tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_176 = arith.constant 2147483647 : i64 loc(#loc439)
    %offs_q_177 = arith.constant -2147483648 : i64 loc(#loc439)
    %offs_q_178 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_179 = arith.cmpi sle, %offs_q_175, %offs_q_178 : tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_180 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_181 = arith.cmpi sge, %offs_q_175, %offs_q_180 : tensor<16x1xi64, #blocked> loc(#loc439)
    %offs_q_182 = arith.andi %offs_q_179, %offs_q_181 : tensor<16x1xi1, #blocked> loc(#loc439)
    %offs_q_183 = arith.muli %offs_q_171, %offs_q_172 : tensor<16x1xi32, #blocked> loc(#loc439)
    %offs_q_184 = tt.splat %offs_q_170 : i32 -> tensor<16x1xi32, #blocked> loc(#loc440)
    %offs_q_185 = arith.extsi %offs_q_184 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_186 = arith.extsi %offs_q_183 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_187 = arith.addi %offs_q_185, %offs_q_186 : tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_188 = arith.constant 2147483647 : i64 loc(#loc440)
    %offs_q_189 = arith.constant -2147483648 : i64 loc(#loc440)
    %offs_q_190 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_191 = arith.cmpi sle, %offs_q_187, %offs_q_190 : tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_192 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_193 = arith.cmpi sge, %offs_q_187, %offs_q_192 : tensor<16x1xi64, #blocked> loc(#loc440)
    %offs_q_194 = arith.andi %offs_q_191, %offs_q_193 : tensor<16x1xi1, #blocked> loc(#loc440)
    %offs_q_195 = arith.addi %offs_q_184, %offs_q_183 : tensor<16x1xi32, #blocked> loc(#loc440)
    %offs_q_196 = tt.expand_dims %offs_c {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc441)
    %offs_q_197 = tt.broadcast %offs_q_195 : tensor<16x1xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc442)
    %offs_q_198 = tt.broadcast %offs_q_196 : tensor<1x512xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc442)
    %offs_q_199 = arith.extsi %offs_q_197 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_200 = arith.extsi %offs_q_198 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_201 = arith.addi %offs_q_199, %offs_q_200 : tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_202 = arith.constant 2147483647 : i64 loc(#loc442)
    %offs_q_203 = arith.constant -2147483648 : i64 loc(#loc442)
    %offs_q_204 = arith.constant dense<2147483647> : tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_205 = arith.cmpi sle, %offs_q_201, %offs_q_204 : tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_206 = arith.constant dense<-2147483648> : tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_207 = arith.cmpi sge, %offs_q_201, %offs_q_206 : tensor<16x512xi64, #blocked> loc(#loc442)
    %offs_q_208 = arith.andi %offs_q_205, %offs_q_207 : tensor<16x512xi1, #blocked> loc(#loc442)
    %offs_q_209 = arith.addi %offs_q_197, %offs_q_198 : tensor<16x512xi32, #blocked> loc(#loc442)
    %mask_c = arith.constant 512 : i32 loc(#loc443)
    %mask_c_210 = arith.constant dense<512> : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc443)
    %mask_c_211 = arith.cmpi slt, %offs_c, %mask_c_210 : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc443)
    %mask_k_c = arith.constant 512 : i32 loc(#loc444)
    %mask_k_c_212 = arith.constant dense<512> : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc444)
    %mask_k_c_213 = arith.cmpi slt, %offs_k_c, %mask_k_c_212 : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc444)
    %mask_qk_r = arith.constant 576 : i32 loc(#loc445)
    %mask_qk_r_214 = arith.constant dense<576> : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc445)
    %mask_qk_r_215 = arith.cmpi slt, %offs_qk_r, %mask_qk_r_214 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc445)
    %mask_k_r = arith.constant 576 : i32 loc(#loc446)
    %mask_k_r_216 = arith.constant dense<576> : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc446)
    %mask_k_r_217 = arith.cmpi slt, %offs_k_r, %mask_k_r_216 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc446)
    %blocks_per_split = tt.call @"triton.language.standard.cdiv__i32__(1,)cconstexpr_8_"(%cur_batch_block_nums) : (i32) -> i32 loc(#loc447)
    %split_kv_start = arith.extsi %blocks_per_split : i32 to i64 loc(#loc448)
    %split_kv_start_218 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc448)
    %split_kv_start_219 = arith.muli %split_kv_start, %split_kv_start_218 : i64 loc(#loc448)
    %split_kv_start_220 = arith.constant 2147483647 : i64 loc(#loc448)
    %split_kv_start_221 = arith.constant -2147483648 : i64 loc(#loc448)
    %split_kv_start_222 = arith.cmpi sle, %split_kv_start_219, %split_kv_start_220 : i64 loc(#loc448)
    %split_kv_start_223 = arith.cmpi sge, %split_kv_start_219, %split_kv_start_221 : i64 loc(#loc448)
    %split_kv_start_224 = arith.andi %split_kv_start_222, %split_kv_start_223 : i1 loc(#loc448)
    %split_kv_start_225 = arith.muli %blocks_per_split, %split_kv_id_25 : i32 loc(#loc448)
    %c64_i32 = arith.constant 64 : i32 loc(#loc67)
    %c64_i32_226 = arith.constant 64 : i32 loc(#loc67)
    %0 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc67)
    %1 = arith.extsi %c64_i32_226 : i32 to i64 loc(#loc67)
    %2 = arith.muli %0, %1 : i64 loc(#loc67)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc67)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc67)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc67)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc67)
    %5 = arith.andi %3, %4 : i1 loc(#loc67)
    %6 = arith.muli %split_kv_start_225, %c64_i32_226 : i32 loc(#loc67)
    %7 = arith.cmpi sgt, %6, %cur_batch_seq_len_115 : i32 loc(#loc68)
    cf.cond_br %7, ^bb1, ^bb2 loc(#loc68)
  ^bb1:  // pred: ^bb0
    tt.return loc(#loc69)
  ^bb2:  // pred: ^bb0
    cf.br ^bb4 loc(#loc)
  ^bb3:  // no predecessors
    cf.br ^bb4 loc(#loc)
  ^bb4:  // 2 preds: ^bb2, ^bb3
    %split_kv_end = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc449)
    %split_kv_end_227 = arith.extsi %blocks_per_split : i32 to i64 loc(#loc449)
    %split_kv_end_228 = arith.addi %split_kv_end, %split_kv_end_227 : i64 loc(#loc449)
    %split_kv_end_229 = arith.constant 2147483647 : i64 loc(#loc449)
    %split_kv_end_230 = arith.constant -2147483648 : i64 loc(#loc449)
    %split_kv_end_231 = arith.cmpi sle, %split_kv_end_228, %split_kv_end_229 : i64 loc(#loc449)
    %split_kv_end_232 = arith.cmpi sge, %split_kv_end_228, %split_kv_end_230 : i64 loc(#loc449)
    %split_kv_end_233 = arith.andi %split_kv_end_231, %split_kv_end_232 : i1 loc(#loc449)
    %split_kv_end_234 = arith.addi %split_kv_start_225, %blocks_per_split : i32 loc(#loc449)
    %split_kv_end_235 = arith.minsi %split_kv_end_234, %cur_batch_block_nums : i32 loc(#loc450)
    %q = tt.expand_dims %mask_h_93 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi1, #blocked> loc(#loc451)
    %q_236 = tt.expand_dims %mask_c_211 {axis = 0 : i32} : tensor<512xi1, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi1, #blocked> loc(#loc452)
    %q_237 = tt.broadcast %q : tensor<16x1xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc453)
    %q_238 = tt.broadcast %q_236 : tensor<1x512xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc453)
    %q_239 = arith.andi %q_237, %q_238 : tensor<16x512xi1, #blocked> loc(#loc453)
    %q_240 = amdgpu.buffer_load %Q[%offs_q_209], %q_239 : tensor<16x512xbf16, #blocked> loc(#loc454)
    %q_pe = tt.expand_dims %mask_h_pe_99 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<16x1xi1, #blocked3> loc(#loc455)
    %q_pe_241 = tt.expand_dims %mask_qk_r_215 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked3}>> -> tensor<1x64xi1, #blocked3> loc(#loc456)
    %q_pe_242 = tt.broadcast %q_pe : tensor<16x1xi1, #blocked3> -> tensor<16x64xi1, #blocked3> loc(#loc457)
    %q_pe_243 = tt.broadcast %q_pe_241 : tensor<1x64xi1, #blocked3> -> tensor<16x64xi1, #blocked3> loc(#loc457)
    %q_pe_244 = arith.andi %q_pe_242, %q_pe_243 : tensor<16x64xi1, #blocked3> loc(#loc457)
    %q_pe_245 = amdgpu.buffer_load %Q[%off_q_pe_162], %q_pe_244 : tensor<16x64xbf16, #blocked3> loc(#loc458)
    %kv_loc = tt.addptr %kv_indices, %split_kv_start_225 : !tt.ptr<i32>, i32 loc(#loc459)
    %kv_loc_246 = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc460)
    %kv_loc_247 = arith.extsi %stride_b_block_table : i32 to i64 loc(#loc460)
    %kv_loc_248 = arith.muli %kv_loc_246, %kv_loc_247 : i64 loc(#loc460)
    %kv_loc_249 = arith.constant 2147483647 : i64 loc(#loc460)
    %kv_loc_250 = arith.constant -2147483648 : i64 loc(#loc460)
    %kv_loc_251 = arith.cmpi sle, %kv_loc_248, %kv_loc_249 : i64 loc(#loc460)
    %kv_loc_252 = arith.cmpi sge, %kv_loc_248, %kv_loc_250 : i64 loc(#loc460)
    %kv_loc_253 = arith.andi %kv_loc_251, %kv_loc_252 : i1 loc(#loc460)
    %kv_loc_254 = arith.muli %cur_batch_39, %stride_b_block_table : i32 loc(#loc460)
    %kv_loc_255 = tt.addptr %kv_loc, %kv_loc_254 : !tt.ptr<i32>, i32 loc(#loc461)
    %kv_loc_256 = tt.load %kv_loc_255 : !tt.ptr<i32> loc(#loc462)
    %q_257 = tt.reshape %q_240 : tensor<16x512xbf16, #blocked> -> tensor<16x2x256xbf16, #blocked4> loc(#loc463)
    %q_258 = tt.trans %q_257 {order = array<i32: 0, 2, 1>} : tensor<16x2x256xbf16, #blocked4> -> tensor<16x256x2xbf16, #blocked5> loc(#loc464)
    %outLHS, %outRHS = tt.split %q_258 : tensor<16x256x2xbf16, #blocked5> -> tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> loc(#loc86)
    ttg.local_store %outLHS, %smem_q0_nope : tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc87)
    ttg.local_store %outRHS, %smem_q1_nope : tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc88)
    %q0 = ttg.local_load %smem_q0_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> -> tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc465)
    %q1 = ttg.local_load %smem_q1_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> -> tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc466)
    ttg.local_store %q_pe_245, %smem_q_rope : tensor<16x64xbf16, #blocked3> -> !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc91)
    %q_pe_259 = ttg.local_load %smem_q_rope : !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc467)
    ttg.local_dealloc %smem_q0_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc93)
    ttg.local_dealloc %smem_q1_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc94)
    ttg.local_dealloc %smem_q_rope : !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc95)
    %smem_k_rope = ttg.local_alloc : () -> !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> loc(#loc468)
    %acc1 = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x256xf32, #mma> loc(#loc469)
    %acc2 = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x256xf32, #mma> loc(#loc470)
    %zeros = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_64__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x64xf32, #mma> loc(#loc471)
    %k_id = arith.constant 64 : i32 loc(#loc472)
    %k_id_260 = arith.constant 64 : i32 loc(#loc472)
    %k_id_261 = arith.extsi %kv_loc_256 : i32 to i64 loc(#loc472)
    %k_id_262 = arith.extsi %k_id_260 : i32 to i64 loc(#loc472)
    %k_id_263 = arith.muli %k_id_261, %k_id_262 : i64 loc(#loc472)
    %k_id_264 = arith.constant 2147483647 : i64 loc(#loc472)
    %k_id_265 = arith.constant -2147483648 : i64 loc(#loc472)
    %k_id_266 = arith.cmpi sle, %k_id_263, %k_id_264 : i64 loc(#loc472)
    %k_id_267 = arith.cmpi sge, %k_id_263, %k_id_265 : i64 loc(#loc472)
    %k_id_268 = arith.andi %k_id_266, %k_id_267 : i1 loc(#loc472)
    %k_id_269 = arith.muli %kv_loc_256, %k_id_260 : i32 loc(#loc472)
    %k_id_270 = tt.splat %k_id_269 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_271 = arith.extsi %k_id_270 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_272 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_273 = arith.addi %k_id_271, %k_id_272 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_274 = arith.constant 2147483647 : i64 loc(#loc473)
    %k_id_275 = arith.constant -2147483648 : i64 loc(#loc473)
    %k_id_276 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_277 = arith.cmpi sle, %k_id_273, %k_id_276 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_278 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_279 = arith.cmpi sge, %k_id_273, %k_id_278 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_280 = arith.andi %k_id_277, %k_id_279 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %k_id_281 = arith.addi %k_id_270, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc473)
    %mask_k_id = arith.constant 64 : i32 loc(#loc474)
    %mask_k_id_282 = arith.constant 64 : i32 loc(#loc474)
    %mask_k_id_283 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc474)
    %mask_k_id_284 = arith.extsi %mask_k_id_282 : i32 to i64 loc(#loc474)
    %mask_k_id_285 = arith.muli %mask_k_id_283, %mask_k_id_284 : i64 loc(#loc474)
    %mask_k_id_286 = arith.constant 2147483647 : i64 loc(#loc474)
    %mask_k_id_287 = arith.constant -2147483648 : i64 loc(#loc474)
    %mask_k_id_288 = arith.cmpi sle, %mask_k_id_285, %mask_k_id_286 : i64 loc(#loc474)
    %mask_k_id_289 = arith.cmpi sge, %mask_k_id_285, %mask_k_id_287 : i64 loc(#loc474)
    %mask_k_id_290 = arith.andi %mask_k_id_288, %mask_k_id_289 : i1 loc(#loc474)
    %mask_k_id_291 = arith.muli %split_kv_start_225, %mask_k_id_282 : i32 loc(#loc474)
    %mask_k_id_292 = tt.splat %mask_k_id_291 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_293 = arith.extsi %mask_k_id_292 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_294 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_295 = arith.addi %mask_k_id_293, %mask_k_id_294 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_296 = arith.constant 2147483647 : i64 loc(#loc475)
    %mask_k_id_297 = arith.constant -2147483648 : i64 loc(#loc475)
    %mask_k_id_298 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_299 = arith.cmpi sle, %mask_k_id_295, %mask_k_id_298 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_300 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_301 = arith.cmpi sge, %mask_k_id_295, %mask_k_id_300 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_302 = arith.andi %mask_k_id_299, %mask_k_id_301 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k_id_303 = arith.addi %mask_k_id_292, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc475)
    %mask_k = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc476)
    %mask_k_304 = arith.cmpi slt, %mask_k_id_303, %mask_k : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc476)
    %offs_buf_kv = tt.expand_dims %k_id_281 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc477)
    %offs_buf_kv_305 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked1> loc(#loc478)
    %offs_buf_kv_306 = arith.extsi %offs_buf_kv : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_307 = arith.extsi %offs_buf_kv_305 : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_308 = arith.muli %offs_buf_kv_306, %offs_buf_kv_307 : tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_309 = arith.constant 2147483647 : i64 loc(#loc478)
    %offs_buf_kv_310 = arith.constant -2147483648 : i64 loc(#loc478)
    %offs_buf_kv_311 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_312 = arith.cmpi sle, %offs_buf_kv_308, %offs_buf_kv_311 : tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_313 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_314 = arith.cmpi sge, %offs_buf_kv_308, %offs_buf_kv_313 : tensor<64x1xi64, #blocked1> loc(#loc478)
    %offs_buf_kv_315 = arith.andi %offs_buf_kv_312, %offs_buf_kv_314 : tensor<64x1xi1, #blocked1> loc(#loc478)
    %offs_buf_kv_316 = arith.muli %offs_buf_kv, %offs_buf_kv_305 : tensor<64x1xi32, #blocked1> loc(#loc478)
    %offs_buf_kv_317 = tt.expand_dims %offs_k_c {axis = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi32, #blocked1> loc(#loc479)
    %offs_buf_kv_318 = tt.broadcast %offs_buf_kv_316 : tensor<64x1xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc480)
    %offs_buf_kv_319 = tt.broadcast %offs_buf_kv_317 : tensor<1x256xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc480)
    %offs_buf_kv_320 = arith.extsi %offs_buf_kv_318 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_321 = arith.extsi %offs_buf_kv_319 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_322 = arith.addi %offs_buf_kv_320, %offs_buf_kv_321 : tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_323 = arith.constant 2147483647 : i64 loc(#loc480)
    %offs_buf_kv_324 = arith.constant -2147483648 : i64 loc(#loc480)
    %offs_buf_kv_325 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_326 = arith.cmpi sle, %offs_buf_kv_322, %offs_buf_kv_325 : tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_327 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_328 = arith.cmpi sge, %offs_buf_kv_322, %offs_buf_kv_327 : tensor<64x256xi64, #blocked1> loc(#loc480)
    %offs_buf_kv_329 = arith.andi %offs_buf_kv_326, %offs_buf_kv_328 : tensor<64x256xi1, #blocked1> loc(#loc480)
    %offs_buf_kv_330 = arith.addi %offs_buf_kv_318, %offs_buf_kv_319 : tensor<64x256xi32, #blocked1> loc(#loc480)
    %kv1 = tt.expand_dims %mask_k_304 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi1, #blocked1> loc(#loc481)
    %kv1_331 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc482)
    %kv1_332 = tt.broadcast %kv1 : tensor<64x1xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc483)
    %kv1_333 = tt.broadcast %kv1_331 : tensor<1x256xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc483)
    %kv1_334 = arith.andi %kv1_332, %kv1_333 : tensor<64x256xi1, #blocked1> loc(#loc483)
    %kv1_335 = amdgpu.buffer_load %K_Buffer[%offs_buf_kv_330], %kv1_334 : tensor<64x256xbf16, #blocked1> loc(#loc484)
    %kv2 = arith.constant 256 : i32 loc(#loc485)
    %kv2_336 = arith.constant 256 : i32 loc(#loc485)
    %kv2_337 = arith.constant dense<256> : tensor<64x256xi32, #blocked1> loc(#loc485)
    %kv2_338 = arith.extsi %offs_buf_kv_330 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_339 = arith.extsi %kv2_337 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_340 = arith.addi %kv2_338, %kv2_339 : tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_341 = arith.constant 2147483647 : i64 loc(#loc485)
    %kv2_342 = arith.constant -2147483648 : i64 loc(#loc485)
    %kv2_343 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_344 = arith.cmpi sle, %kv2_340, %kv2_343 : tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_345 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_346 = arith.cmpi sge, %kv2_340, %kv2_345 : tensor<64x256xi64, #blocked1> loc(#loc485)
    %kv2_347 = arith.andi %kv2_344, %kv2_346 : tensor<64x256xi1, #blocked1> loc(#loc485)
    %kv2_348 = arith.addi %offs_buf_kv_330, %kv2_337 : tensor<64x256xi32, #blocked1> loc(#loc485)
    %kv2_349 = tt.expand_dims %mask_k_304 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi1, #blocked1> loc(#loc486)
    %kv2_350 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc487)
    %kv2_351 = tt.broadcast %kv2_349 : tensor<64x1xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc488)
    %kv2_352 = tt.broadcast %kv2_350 : tensor<1x256xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc488)
    %kv2_353 = arith.andi %kv2_351, %kv2_352 : tensor<64x256xi1, #blocked1> loc(#loc488)
    %kv2_354 = amdgpu.buffer_load %K_Buffer[%kv2_348], %kv2_353 : tensor<64x256xbf16, #blocked1> loc(#loc489)
    %smem_kv1 = ttg.local_alloc : () -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc490)
    %smem_kv2 = ttg.local_alloc : () -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc491)
    rocdl.sched.barrier 0 loc(#loc120)
    %8 = tt.trans %kv1_335 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc121)
    ttg.local_store %8, %smem_kv1 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc121)
    %9 = tt.trans %kv2_354 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc122)
    ttg.local_store %9, %smem_kv2 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc122)
    %k_id_pe = arith.constant 64 : i32 loc(#loc492)
    %k_id_pe_355 = arith.constant 64 : i32 loc(#loc492)
    %k_id_pe_356 = arith.extsi %kv_loc_256 : i32 to i64 loc(#loc492)
    %k_id_pe_357 = arith.extsi %k_id_pe_355 : i32 to i64 loc(#loc492)
    %k_id_pe_358 = arith.muli %k_id_pe_356, %k_id_pe_357 : i64 loc(#loc492)
    %k_id_pe_359 = arith.constant 2147483647 : i64 loc(#loc492)
    %k_id_pe_360 = arith.constant -2147483648 : i64 loc(#loc492)
    %k_id_pe_361 = arith.cmpi sle, %k_id_pe_358, %k_id_pe_359 : i64 loc(#loc492)
    %k_id_pe_362 = arith.cmpi sge, %k_id_pe_358, %k_id_pe_360 : i64 loc(#loc492)
    %k_id_pe_363 = arith.andi %k_id_pe_361, %k_id_pe_362 : i1 loc(#loc492)
    %k_id_pe_364 = arith.muli %kv_loc_256, %k_id_pe_355 : i32 loc(#loc492)
    %k_id_pe_365 = tt.splat %k_id_pe_364 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_366 = arith.extsi %k_id_pe_365 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_367 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_368 = arith.addi %k_id_pe_366, %k_id_pe_367 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_369 = arith.constant 2147483647 : i64 loc(#loc493)
    %k_id_pe_370 = arith.constant -2147483648 : i64 loc(#loc493)
    %k_id_pe_371 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_372 = arith.cmpi sle, %k_id_pe_368, %k_id_pe_371 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_373 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_374 = arith.cmpi sge, %k_id_pe_368, %k_id_pe_373 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_375 = arith.andi %k_id_pe_372, %k_id_pe_374 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %k_id_pe_376 = arith.addi %k_id_pe_365, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc493)
    %offs_buf_k_pe = tt.expand_dims %k_id_pe_376 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc494)
    %offs_buf_k_pe_377 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked2> loc(#loc495)
    %offs_buf_k_pe_378 = arith.extsi %offs_buf_k_pe : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_379 = arith.extsi %offs_buf_k_pe_377 : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_380 = arith.muli %offs_buf_k_pe_378, %offs_buf_k_pe_379 : tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_381 = arith.constant 2147483647 : i64 loc(#loc495)
    %offs_buf_k_pe_382 = arith.constant -2147483648 : i64 loc(#loc495)
    %offs_buf_k_pe_383 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_384 = arith.cmpi sle, %offs_buf_k_pe_380, %offs_buf_k_pe_383 : tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_385 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_386 = arith.cmpi sge, %offs_buf_k_pe_380, %offs_buf_k_pe_385 : tensor<64x1xi64, #blocked2> loc(#loc495)
    %offs_buf_k_pe_387 = arith.andi %offs_buf_k_pe_384, %offs_buf_k_pe_386 : tensor<64x1xi1, #blocked2> loc(#loc495)
    %offs_buf_k_pe_388 = arith.muli %offs_buf_k_pe, %offs_buf_k_pe_377 : tensor<64x1xi32, #blocked2> loc(#loc495)
    %offs_buf_k_pe_389 = tt.expand_dims %offs_k_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc496)
    %offs_buf_k_pe_390 = tt.broadcast %offs_buf_k_pe_388 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc497)
    %offs_buf_k_pe_391 = tt.broadcast %offs_buf_k_pe_389 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc497)
    %offs_buf_k_pe_392 = arith.extsi %offs_buf_k_pe_390 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_393 = arith.extsi %offs_buf_k_pe_391 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_394 = arith.addi %offs_buf_k_pe_392, %offs_buf_k_pe_393 : tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_395 = arith.constant 2147483647 : i64 loc(#loc497)
    %offs_buf_k_pe_396 = arith.constant -2147483648 : i64 loc(#loc497)
    %offs_buf_k_pe_397 = arith.constant dense<2147483647> : tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_398 = arith.cmpi sle, %offs_buf_k_pe_394, %offs_buf_k_pe_397 : tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_399 = arith.constant dense<-2147483648> : tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_400 = arith.cmpi sge, %offs_buf_k_pe_394, %offs_buf_k_pe_399 : tensor<64x64xi64, #blocked2> loc(#loc497)
    %offs_buf_k_pe_401 = arith.andi %offs_buf_k_pe_398, %offs_buf_k_pe_400 : tensor<64x64xi1, #blocked2> loc(#loc497)
    %offs_buf_k_pe_402 = arith.addi %offs_buf_k_pe_390, %offs_buf_k_pe_391 : tensor<64x64xi32, #blocked2> loc(#loc497)
    %mask_k_id_403 = arith.constant 64 : i32 loc(#loc498)
    %mask_k_id_404 = arith.constant 64 : i32 loc(#loc498)
    %mask_k_id_405 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc498)
    %mask_k_id_406 = arith.extsi %mask_k_id_404 : i32 to i64 loc(#loc498)
    %mask_k_id_407 = arith.muli %mask_k_id_405, %mask_k_id_406 : i64 loc(#loc498)
    %mask_k_id_408 = arith.constant 2147483647 : i64 loc(#loc498)
    %mask_k_id_409 = arith.constant -2147483648 : i64 loc(#loc498)
    %mask_k_id_410 = arith.cmpi sle, %mask_k_id_407, %mask_k_id_408 : i64 loc(#loc498)
    %mask_k_id_411 = arith.cmpi sge, %mask_k_id_407, %mask_k_id_409 : i64 loc(#loc498)
    %mask_k_id_412 = arith.andi %mask_k_id_410, %mask_k_id_411 : i1 loc(#loc498)
    %mask_k_id_413 = arith.muli %split_kv_start_225, %mask_k_id_404 : i32 loc(#loc498)
    %mask_k_id_414 = tt.splat %mask_k_id_413 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_415 = arith.extsi %mask_k_id_414 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_416 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_417 = arith.addi %mask_k_id_415, %mask_k_id_416 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_418 = arith.constant 2147483647 : i64 loc(#loc499)
    %mask_k_id_419 = arith.constant -2147483648 : i64 loc(#loc499)
    %mask_k_id_420 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_421 = arith.cmpi sle, %mask_k_id_417, %mask_k_id_420 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_422 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_423 = arith.cmpi sge, %mask_k_id_417, %mask_k_id_422 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_424 = arith.andi %mask_k_id_421, %mask_k_id_423 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_id_425 = arith.addi %mask_k_id_414, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc499)
    %mask_k_pe = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc500)
    %mask_k_pe_426 = arith.cmpi slt, %mask_k_id_425, %mask_k_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc500)
    %k_pe = tt.expand_dims %mask_k_pe_426 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi1, #blocked2> loc(#loc501)
    %k_pe_427 = tt.expand_dims %mask_k_r_217 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi1, #blocked2> loc(#loc502)
    %k_pe_428 = tt.broadcast %k_pe : tensor<64x1xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc503)
    %k_pe_429 = tt.broadcast %k_pe_427 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc503)
    %k_pe_430 = arith.andi %k_pe_428, %k_pe_429 : tensor<64x64xi1, #blocked2> loc(#loc503)
    %k_pe_431 = amdgpu.buffer_load %K_Buffer[%offs_buf_k_pe_402], %k_pe_430 : tensor<64x64xbf16, #blocked2> loc(#loc504)
    %e_sum = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc505)
    %e_sum_432 = arith.sitofp %e_sum : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc506)
    %e_sum_433 = arith.constant 0.000000e+00 : f32 loc(#loc507)
    %e_sum_434 = arith.constant 0.000000e+00 : f32 loc(#loc507)
    %e_sum_435 = arith.constant dense<0.000000e+00> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc507)
    %e_sum_436 = arith.mulf %e_sum_432, %e_sum_435 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc507)
    %e_max = arith.constant 0x7F800000 : f32 loc(#loc508)
    %e_max_437 = arith.constant 0x7F800000 : f32 loc(#loc508)
    %e_max_438 = arith.constant dense<0x7F800000> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc508)
    %e_max_439 = arith.subf %e_sum_436, %e_max_438 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc508)
    %cur_k1 = ttg.local_load %smem_kv1 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc509)
    %cur_k2 = ttg.local_load %smem_kv2 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc510)
    rocdl.sched.barrier 0 loc(#loc142)
    %smem_kv1_440 = ttg.memdesc_reinterpret %smem_kv1 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc511)
    %kv1_transpose = tt.trans %kv1_335 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc512)
    rocdl.sched.barrier 0 loc(#loc145)
    %10 = tt.trans %kv1_transpose {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc146)
    ttg.local_store %10, %smem_kv1_440 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc146)
    %smem_kv2_441 = ttg.memdesc_reinterpret %smem_kv2 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc513)
    %kv2_transpose = tt.trans %kv2_354 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc514)
    rocdl.sched.barrier 0 loc(#loc149)
    %11 = tt.trans %kv2_transpose {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc150)
    ttg.local_store %11, %smem_kv2_441 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc150)
    %12 = tt.trans %k_pe_431 {order = array<i32: 1, 0>} : tensor<64x64xbf16, #blocked2> -> tensor<64x64xbf16, #blocked7> loc(#loc151)
    ttg.local_store %12, %smem_k_rope : tensor<64x64xbf16, #blocked7> -> !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> loc(#loc151)
    rocdl.sched.barrier 0 loc(#loc152)
    %split_kv_start_442 = arith.constant 1 : i32 loc(#loc515)
    %split_kv_start_443 = arith.constant 1 : i32 loc(#loc515)
    %split_kv_start_444 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc515)
    %split_kv_start_445 = arith.extsi %split_kv_start_443 : i32 to i64 loc(#loc515)
    %split_kv_start_446 = arith.addi %split_kv_start_444, %split_kv_start_445 : i64 loc(#loc515)
    %split_kv_start_447 = arith.constant 2147483647 : i64 loc(#loc515)
    %split_kv_start_448 = arith.constant -2147483648 : i64 loc(#loc515)
    %split_kv_start_449 = arith.cmpi sle, %split_kv_start_446, %split_kv_start_447 : i64 loc(#loc515)
    %split_kv_start_450 = arith.cmpi sge, %split_kv_start_446, %split_kv_start_448 : i64 loc(#loc515)
    %split_kv_start_451 = arith.andi %split_kv_start_449, %split_kv_start_450 : i1 loc(#loc515)
    %split_kv_start_452 = arith.addi %split_kv_start_225, %split_kv_start_443 : i32 loc(#loc515)
    %mask_qk_h = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc516)
    %c1_i32 = arith.constant 1 : i32 loc(#loc155)
    %13 = arith.bitcast %split_kv_start_452 : i32 to i32 loc(#loc155)
    %14 = arith.bitcast %split_kv_end_235 : i32 to i32 loc(#loc155)
    %15 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc155)
    %16 = ub.poison : i32 loc(#loc155)
    %kv2_transpose_453:21 = scf.for %start_n = %13 to %14 step %15 iter_args(%kv_loc_689 = %kv_loc_256, %acc1_690 = %acc1, %acc2_691 = %acc2, %k_id_692 = %k_id_281, %mask_k_id_693 = %mask_k_id_425, %mask_k_694 = %mask_k_304, %offs_buf_kv_695 = %offs_buf_kv_330, %kv1_696 = %kv1_335, %kv2_697 = %kv2_354, %smem_kv1_698 = %smem_kv1_440, %smem_kv2_699 = %smem_kv2_441, %k_id_pe_700 = %k_id_pe_376, %offs_buf_k_pe_701 = %offs_buf_k_pe_402, %mask_k_pe_702 = %mask_k_pe_426, %k_pe_703 = %k_pe_431, %e_sum_704 = %e_sum_436, %e_max_705 = %e_max_439, %cur_k1_706 = %cur_k1, %cur_k2_707 = %cur_k2, %kv1_transpose_708 = %kv1_transpose, %kv2_transpose_709 = %kv2_transpose) -> (i32, tensor<16x256xf32, #mma>, tensor<16x256xf32, #mma>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64x256xi32, #blocked1>, tensor<64x256xbf16, #blocked1>, tensor<64x256xbf16, #blocked1>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xi32, #blocked2>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xbf16, #blocked2>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #blocked6>, tensor<256x64xbf16, #blocked6>)  : i32 {
      %kv_loc_710 = tt.addptr %kv_indices, %start_n : !tt.ptr<i32>, i32 loc(#loc518)
      %kv_loc_711 = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc519)
      %kv_loc_712 = arith.extsi %stride_b_block_table : i32 to i64 loc(#loc519)
      %kv_loc_713 = arith.muli %kv_loc_711, %kv_loc_712 : i64 loc(#loc519)
      %kv_loc_714 = arith.constant 2147483647 : i64 loc(#loc519)
      %kv_loc_715 = arith.constant -2147483648 : i64 loc(#loc519)
      %kv_loc_716 = arith.cmpi sle, %kv_loc_713, %kv_loc_714 : i64 loc(#loc519)
      %kv_loc_717 = arith.cmpi sge, %kv_loc_713, %kv_loc_715 : i64 loc(#loc519)
      %kv_loc_718 = arith.andi %kv_loc_716, %kv_loc_717 : i1 loc(#loc519)
      %kv_loc_719 = arith.muli %cur_batch_39, %stride_b_block_table : i32 loc(#loc519)
      %kv_loc_720 = tt.addptr %kv_loc_710, %kv_loc_719 : !tt.ptr<i32>, i32 loc(#loc520)
      %kv_loc_721 = tt.load %kv_loc_720 : !tt.ptr<i32> loc(#loc521)
      %cur_k_pe_722 = ttg.local_load %smem_k_rope : !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> -> tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc522)
      rocdl.sched.barrier 0 loc(#loc161)
      %k_id_723 = arith.constant 64 : i32 loc(#loc523)
      %k_id_724 = arith.constant 64 : i32 loc(#loc523)
      %k_id_725 = arith.extsi %kv_loc_721 : i32 to i64 loc(#loc523)
      %k_id_726 = arith.extsi %k_id_724 : i32 to i64 loc(#loc523)
      %k_id_727 = arith.muli %k_id_725, %k_id_726 : i64 loc(#loc523)
      %k_id_728 = arith.constant 2147483647 : i64 loc(#loc523)
      %k_id_729 = arith.constant -2147483648 : i64 loc(#loc523)
      %k_id_730 = arith.cmpi sle, %k_id_727, %k_id_728 : i64 loc(#loc523)
      %k_id_731 = arith.cmpi sge, %k_id_727, %k_id_729 : i64 loc(#loc523)
      %k_id_732 = arith.andi %k_id_730, %k_id_731 : i1 loc(#loc523)
      %k_id_733 = arith.muli %kv_loc_721, %k_id_724 : i32 loc(#loc523)
      %k_id_734 = tt.splat %k_id_733 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_735 = arith.extsi %k_id_734 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_736 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_737 = arith.addi %k_id_735, %k_id_736 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_738 = arith.constant 2147483647 : i64 loc(#loc524)
      %k_id_739 = arith.constant -2147483648 : i64 loc(#loc524)
      %k_id_740 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_741 = arith.cmpi sle, %k_id_737, %k_id_740 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_742 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_743 = arith.cmpi sge, %k_id_737, %k_id_742 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_744 = arith.andi %k_id_741, %k_id_743 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %k_id_745 = arith.addi %k_id_734, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc524)
      %offs_buf_kv_746 = tt.expand_dims %k_id_745 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc525)
      %offs_buf_kv_747 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked1> loc(#loc526)
      %offs_buf_kv_748 = arith.extsi %offs_buf_kv_746 : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_749 = arith.extsi %offs_buf_kv_747 : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_750 = arith.muli %offs_buf_kv_748, %offs_buf_kv_749 : tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_751 = arith.constant 2147483647 : i64 loc(#loc526)
      %offs_buf_kv_752 = arith.constant -2147483648 : i64 loc(#loc526)
      %offs_buf_kv_753 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_754 = arith.cmpi sle, %offs_buf_kv_750, %offs_buf_kv_753 : tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_755 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_756 = arith.cmpi sge, %offs_buf_kv_750, %offs_buf_kv_755 : tensor<64x1xi64, #blocked1> loc(#loc526)
      %offs_buf_kv_757 = arith.andi %offs_buf_kv_754, %offs_buf_kv_756 : tensor<64x1xi1, #blocked1> loc(#loc526)
      %offs_buf_kv_758 = arith.muli %offs_buf_kv_746, %offs_buf_kv_747 : tensor<64x1xi32, #blocked1> loc(#loc526)
      %offs_buf_kv_759 = tt.expand_dims %offs_k_c {axis = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi32, #blocked1> loc(#loc527)
      %offs_buf_kv_760 = tt.broadcast %offs_buf_kv_758 : tensor<64x1xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc528)
      %offs_buf_kv_761 = tt.broadcast %offs_buf_kv_759 : tensor<1x256xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc528)
      %offs_buf_kv_762 = arith.extsi %offs_buf_kv_760 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_763 = arith.extsi %offs_buf_kv_761 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_764 = arith.addi %offs_buf_kv_762, %offs_buf_kv_763 : tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_765 = arith.constant 2147483647 : i64 loc(#loc528)
      %offs_buf_kv_766 = arith.constant -2147483648 : i64 loc(#loc528)
      %offs_buf_kv_767 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_768 = arith.cmpi sle, %offs_buf_kv_764, %offs_buf_kv_767 : tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_769 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_770 = arith.cmpi sge, %offs_buf_kv_764, %offs_buf_kv_769 : tensor<64x256xi64, #blocked1> loc(#loc528)
      %offs_buf_kv_771 = arith.andi %offs_buf_kv_768, %offs_buf_kv_770 : tensor<64x256xi1, #blocked1> loc(#loc528)
      %offs_buf_kv_772 = arith.addi %offs_buf_kv_760, %offs_buf_kv_761 : tensor<64x256xi32, #blocked1> loc(#loc528)
      %mask_k_id_773 = arith.constant 64 : i32 loc(#loc529)
      %mask_k_id_774 = arith.constant 64 : i32 loc(#loc529)
      %mask_k_id_775 = arith.extsi %start_n : i32 to i64 loc(#loc529)
      %mask_k_id_776 = arith.extsi %mask_k_id_774 : i32 to i64 loc(#loc529)
      %mask_k_id_777 = arith.muli %mask_k_id_775, %mask_k_id_776 : i64 loc(#loc529)
      %mask_k_id_778 = arith.constant 2147483647 : i64 loc(#loc529)
      %mask_k_id_779 = arith.constant -2147483648 : i64 loc(#loc529)
      %mask_k_id_780 = arith.cmpi sle, %mask_k_id_777, %mask_k_id_778 : i64 loc(#loc529)
      %mask_k_id_781 = arith.cmpi sge, %mask_k_id_777, %mask_k_id_779 : i64 loc(#loc529)
      %mask_k_id_782 = arith.andi %mask_k_id_780, %mask_k_id_781 : i1 loc(#loc529)
      %mask_k_id_783 = arith.muli %start_n, %mask_k_id_774 : i32 loc(#loc529)
      %mask_k_id_784 = tt.splat %mask_k_id_783 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_785 = arith.extsi %mask_k_id_784 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_786 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_787 = arith.addi %mask_k_id_785, %mask_k_id_786 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_788 = arith.constant 2147483647 : i64 loc(#loc530)
      %mask_k_id_789 = arith.constant -2147483648 : i64 loc(#loc530)
      %mask_k_id_790 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_791 = arith.cmpi sle, %mask_k_id_787, %mask_k_id_790 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_792 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_793 = arith.cmpi sge, %mask_k_id_787, %mask_k_id_792 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_794 = arith.andi %mask_k_id_791, %mask_k_id_793 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_id_795 = arith.addi %mask_k_id_784, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc530)
      %mask_k_796 = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc531)
      %mask_k_797 = arith.cmpi slt, %mask_k_id_795, %mask_k_796 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc531)
      rocdl.sched.barrier 0 loc(#loc171)
      %qk_798 = arith.constant 0.000000e+00 : f32 loc(#loc532)
      %qk_799 = tt.dot %q0, %cur_k1_706, %zeros : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc532)
      %kv1_800 = tt.expand_dims %mask_k_797 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi1, #blocked1> loc(#loc533)
      %kv1_801 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc534)
      %kv1_802 = tt.broadcast %kv1_800 : tensor<64x1xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc535)
      %kv1_803 = tt.broadcast %kv1_801 : tensor<1x256xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc535)
      %kv1_804 = arith.andi %kv1_802, %kv1_803 : tensor<64x256xi1, #blocked1> loc(#loc535)
      %kv1_805 = amdgpu.buffer_load %K_Buffer[%offs_buf_kv_772], %kv1_804 : tensor<64x256xbf16, #blocked1> loc(#loc536)
      rocdl.sched.barrier 0 loc(#loc177)
      %qk_806 = arith.constant 0.000000e+00 : f32 loc(#loc537)
      %qk_807 = tt.dot %q1, %cur_k2_707, %qk_799 : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc537)
      %kv2_808 = arith.constant 256 : i32 loc(#loc538)
      %kv2_809 = arith.constant 256 : i32 loc(#loc538)
      %kv2_810 = arith.constant dense<256> : tensor<64x256xi32, #blocked1> loc(#loc538)
      %kv2_811 = arith.extsi %offs_buf_kv_772 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_812 = arith.extsi %kv2_810 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_813 = arith.addi %kv2_811, %kv2_812 : tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_814 = arith.constant 2147483647 : i64 loc(#loc538)
      %kv2_815 = arith.constant -2147483648 : i64 loc(#loc538)
      %kv2_816 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_817 = arith.cmpi sle, %kv2_813, %kv2_816 : tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_818 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_819 = arith.cmpi sge, %kv2_813, %kv2_818 : tensor<64x256xi64, #blocked1> loc(#loc538)
      %kv2_820 = arith.andi %kv2_817, %kv2_819 : tensor<64x256xi1, #blocked1> loc(#loc538)
      %kv2_821 = arith.addi %offs_buf_kv_772, %kv2_810 : tensor<64x256xi32, #blocked1> loc(#loc538)
      %kv2_822 = tt.expand_dims %mask_k_797 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi1, #blocked1> loc(#loc539)
      %kv2_823 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc540)
      %kv2_824 = tt.broadcast %kv2_822 : tensor<64x1xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc541)
      %kv2_825 = tt.broadcast %kv2_823 : tensor<1x256xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc541)
      %kv2_826 = arith.andi %kv2_824, %kv2_825 : tensor<64x256xi1, #blocked1> loc(#loc541)
      %kv2_827 = amdgpu.buffer_load %K_Buffer[%kv2_821], %kv2_826 : tensor<64x256xbf16, #blocked1> loc(#loc542)
      %cur_k1_828 = ttg.local_load %smem_kv1_698 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc543)
      %cur_k2_829 = ttg.local_load %smem_kv2_699 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc544)
      %qk_830 = arith.constant 0.000000e+00 : f32 loc(#loc545)
      %qk_831 = tt.dot %q_pe_259, %cur_k_pe_722, %qk_807 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc545)
      %qk_832 = tt.splat %sm_scale : f32 -> tensor<16x64xf32, #mma> loc(#loc546)
      %qk_833 = arith.mulf %qk_831, %qk_832 : tensor<16x64xf32, #mma> loc(#loc546)
      %k_id_pe_834 = arith.constant 64 : i32 loc(#loc547)
      %k_id_pe_835 = arith.constant 64 : i32 loc(#loc547)
      %k_id_pe_836 = arith.extsi %kv_loc_721 : i32 to i64 loc(#loc547)
      %k_id_pe_837 = arith.extsi %k_id_pe_835 : i32 to i64 loc(#loc547)
      %k_id_pe_838 = arith.muli %k_id_pe_836, %k_id_pe_837 : i64 loc(#loc547)
      %k_id_pe_839 = arith.constant 2147483647 : i64 loc(#loc547)
      %k_id_pe_840 = arith.constant -2147483648 : i64 loc(#loc547)
      %k_id_pe_841 = arith.cmpi sle, %k_id_pe_838, %k_id_pe_839 : i64 loc(#loc547)
      %k_id_pe_842 = arith.cmpi sge, %k_id_pe_838, %k_id_pe_840 : i64 loc(#loc547)
      %k_id_pe_843 = arith.andi %k_id_pe_841, %k_id_pe_842 : i1 loc(#loc547)
      %k_id_pe_844 = arith.muli %kv_loc_721, %k_id_pe_835 : i32 loc(#loc547)
      %k_id_pe_845 = tt.splat %k_id_pe_844 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_846 = arith.extsi %k_id_pe_845 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_847 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_848 = arith.addi %k_id_pe_846, %k_id_pe_847 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_849 = arith.constant 2147483647 : i64 loc(#loc548)
      %k_id_pe_850 = arith.constant -2147483648 : i64 loc(#loc548)
      %k_id_pe_851 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_852 = arith.cmpi sle, %k_id_pe_848, %k_id_pe_851 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_853 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_854 = arith.cmpi sge, %k_id_pe_848, %k_id_pe_853 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_855 = arith.andi %k_id_pe_852, %k_id_pe_854 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %k_id_pe_856 = arith.addi %k_id_pe_845, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc548)
      %offs_buf_k_pe_857 = tt.expand_dims %k_id_pe_856 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc549)
      %offs_buf_k_pe_858 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked2> loc(#loc550)
      %offs_buf_k_pe_859 = arith.extsi %offs_buf_k_pe_857 : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_860 = arith.extsi %offs_buf_k_pe_858 : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_861 = arith.muli %offs_buf_k_pe_859, %offs_buf_k_pe_860 : tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_862 = arith.constant 2147483647 : i64 loc(#loc550)
      %offs_buf_k_pe_863 = arith.constant -2147483648 : i64 loc(#loc550)
      %offs_buf_k_pe_864 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_865 = arith.cmpi sle, %offs_buf_k_pe_861, %offs_buf_k_pe_864 : tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_866 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_867 = arith.cmpi sge, %offs_buf_k_pe_861, %offs_buf_k_pe_866 : tensor<64x1xi64, #blocked2> loc(#loc550)
      %offs_buf_k_pe_868 = arith.andi %offs_buf_k_pe_865, %offs_buf_k_pe_867 : tensor<64x1xi1, #blocked2> loc(#loc550)
      %offs_buf_k_pe_869 = arith.muli %offs_buf_k_pe_857, %offs_buf_k_pe_858 : tensor<64x1xi32, #blocked2> loc(#loc550)
      %offs_buf_k_pe_870 = tt.expand_dims %offs_k_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc551)
      %offs_buf_k_pe_871 = tt.broadcast %offs_buf_k_pe_869 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc552)
      %offs_buf_k_pe_872 = tt.broadcast %offs_buf_k_pe_870 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc552)
      %offs_buf_k_pe_873 = arith.extsi %offs_buf_k_pe_871 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_874 = arith.extsi %offs_buf_k_pe_872 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_875 = arith.addi %offs_buf_k_pe_873, %offs_buf_k_pe_874 : tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_876 = arith.constant 2147483647 : i64 loc(#loc552)
      %offs_buf_k_pe_877 = arith.constant -2147483648 : i64 loc(#loc552)
      %offs_buf_k_pe_878 = arith.constant dense<2147483647> : tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_879 = arith.cmpi sle, %offs_buf_k_pe_875, %offs_buf_k_pe_878 : tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_880 = arith.constant dense<-2147483648> : tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_881 = arith.cmpi sge, %offs_buf_k_pe_875, %offs_buf_k_pe_880 : tensor<64x64xi64, #blocked2> loc(#loc552)
      %offs_buf_k_pe_882 = arith.andi %offs_buf_k_pe_879, %offs_buf_k_pe_881 : tensor<64x64xi1, #blocked2> loc(#loc552)
      %offs_buf_k_pe_883 = arith.addi %offs_buf_k_pe_871, %offs_buf_k_pe_872 : tensor<64x64xi32, #blocked2> loc(#loc552)
      %mask_k_id_884 = arith.constant 64 : i32 loc(#loc553)
      %mask_k_id_885 = arith.constant 64 : i32 loc(#loc553)
      %mask_k_id_886 = arith.extsi %start_n : i32 to i64 loc(#loc553)
      %mask_k_id_887 = arith.extsi %mask_k_id_885 : i32 to i64 loc(#loc553)
      %mask_k_id_888 = arith.muli %mask_k_id_886, %mask_k_id_887 : i64 loc(#loc553)
      %mask_k_id_889 = arith.constant 2147483647 : i64 loc(#loc553)
      %mask_k_id_890 = arith.constant -2147483648 : i64 loc(#loc553)
      %mask_k_id_891 = arith.cmpi sle, %mask_k_id_888, %mask_k_id_889 : i64 loc(#loc553)
      %mask_k_id_892 = arith.cmpi sge, %mask_k_id_888, %mask_k_id_890 : i64 loc(#loc553)
      %mask_k_id_893 = arith.andi %mask_k_id_891, %mask_k_id_892 : i1 loc(#loc553)
      %mask_k_id_894 = arith.muli %start_n, %mask_k_id_885 : i32 loc(#loc553)
      %mask_k_id_895 = tt.splat %mask_k_id_894 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_896 = arith.extsi %mask_k_id_895 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_897 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_898 = arith.addi %mask_k_id_896, %mask_k_id_897 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_899 = arith.constant 2147483647 : i64 loc(#loc554)
      %mask_k_id_900 = arith.constant -2147483648 : i64 loc(#loc554)
      %mask_k_id_901 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_902 = arith.cmpi sle, %mask_k_id_898, %mask_k_id_901 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_903 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_904 = arith.cmpi sge, %mask_k_id_898, %mask_k_id_903 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_905 = arith.andi %mask_k_id_902, %mask_k_id_904 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_id_906 = arith.addi %mask_k_id_895, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc554)
      %mask_k_pe_907 = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc555)
      %mask_k_pe_908 = arith.cmpi slt, %mask_k_id_906, %mask_k_pe_907 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc555)
      rocdl.sched.barrier 0 loc(#loc197)
      %k_pe_909 = tt.expand_dims %mask_k_pe_908 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi1, #blocked2> loc(#loc556)
      %k_pe_910 = tt.expand_dims %mask_k_r_217 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi1, #blocked2> loc(#loc557)
      %k_pe_911 = tt.broadcast %k_pe_909 : tensor<64x1xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc558)
      %k_pe_912 = tt.broadcast %k_pe_910 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc558)
      %k_pe_913 = arith.andi %k_pe_911, %k_pe_912 : tensor<64x64xi1, #blocked2> loc(#loc558)
      %k_pe_914 = amdgpu.buffer_load %K_Buffer[%offs_buf_k_pe_883], %k_pe_913 : tensor<64x64xbf16, #blocked2> loc(#loc559)
      %n_e_max_915 = tt.call @"triton.language.standard.max__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%qk_833) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc560)
      %n_e_max_916 = ttg.convert_layout %n_e_max_915 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc561)
      %n_e_max_917 = arith.maxnumf %n_e_max_916, %e_max_705 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc562)
      %re_scale_918 = arith.subf %e_max_705, %n_e_max_917 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc563)
      %re_scale_919 = arith.constant 1.44269502 : f32 loc(#loc564)
      %re_scale_920 = arith.constant 1.44269502 : f32 loc(#loc564)
      %re_scale_921 = arith.constant dense<1.44269502> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc564)
      %re_scale_922 = arith.mulf %re_scale_918, %re_scale_921 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc564)
      %re_scale_923 = math.exp2 %re_scale_922 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc565)
      %p_924 = tt.expand_dims %n_e_max_917 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc566)
      %p_925 = tt.broadcast %p_924 : tensor<16x1xf32, #mma> -> tensor<16x64xf32, #mma> loc(#loc567)
      %p_926 = arith.subf %qk_833, %p_925 : tensor<16x64xf32, #mma> loc(#loc567)
      %p_927 = arith.constant 1.44269502 : f32 loc(#loc568)
      %p_928 = arith.constant 1.44269502 : f32 loc(#loc568)
      %p_929 = arith.constant dense<1.44269502> : tensor<16x64xf32, #mma> loc(#loc568)
      %p_930 = arith.mulf %p_926, %p_929 : tensor<16x64xf32, #mma> loc(#loc568)
      %p_931 = math.exp2 %p_930 : tensor<16x64xf32, #mma> loc(#loc569)
      %28 = arith.truncf %p_931 : tensor<16x64xf32, #mma> to tensor<16x64xbf16, #mma> loc(#loc212)
      ttg.local_store %28, %smem_p : tensor<16x64xbf16, #mma> -> !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> loc(#loc213)
      rocdl.sched.barrier 0 loc(#loc214)
      %cur_p_932 = ttg.local_load %smem_p : !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc570)
      %smem_kv1_933 = ttg.memdesc_reinterpret %smem_kv1_698 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc571)
      %smem_kv2_934 = ttg.memdesc_reinterpret %smem_kv2_699 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc572)
      %29 = tt.trans %kv1_805 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc218)
      ttg.local_store %29, %smem_kv1_933 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc218)
      %acc1_935 = tt.expand_dims %re_scale_923 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc573)
      %acc1_936 = tt.broadcast %acc1_935 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc574)
      %acc1_937 = arith.mulf %acc1_690, %acc1_936 : tensor<16x256xf32, #mma> loc(#loc574)
      %acc1_938 = arith.constant 0.000000e+00 : f32 loc(#loc575)
      %acc1_939 = tt.dot %cur_p_932, %cur_k1_828, %acc1_937 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc575)
      %e_sum_940 = arith.mulf %e_sum_704, %re_scale_923 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc576)
      %e_sum_941 = tt.call @"triton.language.standard.sum__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%p_931) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc577)
      %e_sum_942 = arith.addf %e_sum_940, %e_sum_941 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc578)
      %30 = tt.trans %kv2_827 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc225)
      ttg.local_store %30, %smem_kv2_934 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc225)
      %acc2_943 = tt.expand_dims %re_scale_923 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc579)
      %acc2_944 = tt.broadcast %acc2_943 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc580)
      %acc2_945 = arith.mulf %acc2_691, %acc2_944 : tensor<16x256xf32, #mma> loc(#loc580)
      %acc2_946 = arith.constant 0.000000e+00 : f32 loc(#loc581)
      %acc2_947 = tt.dot %cur_p_932, %cur_k2_829, %acc2_945 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc581)
      %31 = tt.trans %k_pe_914 {order = array<i32: 1, 0>} : tensor<64x64xbf16, #blocked2> -> tensor<64x64xbf16, #blocked7> loc(#loc229)
      ttg.local_store %31, %smem_k_rope : tensor<64x64xbf16, #blocked7> -> !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> loc(#loc229)
      %cur_k1_948 = ttg.local_load %smem_kv1_933 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc582)
      %kv1_transpose_949 = tt.trans %kv1_805 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc583)
      rocdl.sched.barrier 0 loc(#loc232)
      %smem_kv1_950 = ttg.memdesc_reinterpret %smem_kv1_933 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc584)
      %32 = tt.trans %kv1_transpose_949 {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc234)
      ttg.local_store %32, %smem_kv1_950 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc234)
      %cur_k2_951 = ttg.local_load %smem_kv2_934 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc585)
      %kv2_transpose_952 = tt.trans %kv2_827 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc586)
      rocdl.sched.barrier 0 loc(#loc237)
      %smem_kv2_953 = ttg.memdesc_reinterpret %smem_kv2_934 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc587)
      %33 = tt.trans %kv2_transpose_952 {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc239)
      ttg.local_store %33, %smem_kv2_953 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc239)
      scf.yield %kv_loc_721, %acc1_939, %acc2_947, %k_id_745, %mask_k_id_906, %mask_k_797, %offs_buf_kv_772, %kv1_805, %kv2_827, %smem_kv1_950, %smem_kv2_953, %k_id_pe_856, %offs_buf_k_pe_883, %mask_k_pe_908, %k_pe_914, %e_sum_942, %n_e_max_917, %cur_k1_948, %cur_k2_951, %kv1_transpose_949, %kv2_transpose_952 : i32, tensor<16x256xf32, #mma>, tensor<16x256xf32, #mma>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64x256xi32, #blocked1>, tensor<64x256xbf16, #blocked1>, tensor<64x256xbf16, #blocked1>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xi32, #blocked2>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xbf16, #blocked2>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #blocked6>, tensor<256x64xbf16, #blocked6> loc(#loc240)
    } loc(#loc695)
    %qk = arith.constant 0.000000e+00 : f32 loc(#loc588)
    %qk_454 = tt.dot %q0, %kv2_transpose_453#17, %zeros : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc588)
    %qk_455 = arith.constant 0.000000e+00 : f32 loc(#loc589)
    %qk_456 = tt.dot %q1, %kv2_transpose_453#18, %qk_454 : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc589)
    %cur_k_pe = ttg.local_load %smem_k_rope : !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> -> tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc590)
    %qk_457 = arith.constant 0.000000e+00 : f32 loc(#loc591)
    %qk_458 = tt.dot %q_pe_259, %cur_k_pe, %qk_456 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc591)
    %cur_k1_459 = ttg.local_load %kv2_transpose_453#9 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc592)
    %cur_k2_460 = ttg.local_load %kv2_transpose_453#10 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc593)
    %qk_461 = tt.splat %sm_scale : f32 -> tensor<16x64xf32, #mma> loc(#loc594)
    %qk_462 = arith.mulf %qk_458, %qk_461 : tensor<16x64xf32, #mma> loc(#loc594)
    %mask_qk_n = arith.constant 1 : i32 loc(#loc595)
    %mask_qk_n_463 = arith.constant 1 : i32 loc(#loc595)
    %mask_qk_n_464 = arith.extsi %split_kv_end_235 : i32 to i64 loc(#loc595)
    %mask_qk_n_465 = arith.extsi %mask_qk_n_463 : i32 to i64 loc(#loc595)
    %mask_qk_n_466 = arith.subi %mask_qk_n_464, %mask_qk_n_465 : i64 loc(#loc595)
    %mask_qk_n_467 = arith.constant 2147483647 : i64 loc(#loc595)
    %mask_qk_n_468 = arith.constant -2147483648 : i64 loc(#loc595)
    %mask_qk_n_469 = arith.cmpi sle, %mask_qk_n_466, %mask_qk_n_467 : i64 loc(#loc595)
    %mask_qk_n_470 = arith.cmpi sge, %mask_qk_n_466, %mask_qk_n_468 : i64 loc(#loc595)
    %mask_qk_n_471 = arith.andi %mask_qk_n_469, %mask_qk_n_470 : i1 loc(#loc595)
    %mask_qk_n_472 = arith.subi %split_kv_end_235, %mask_qk_n_463 : i32 loc(#loc595)
    %mask_qk_n_473 = arith.constant 64 : i32 loc(#loc596)
    %mask_qk_n_474 = arith.constant 64 : i32 loc(#loc596)
    %mask_qk_n_475 = arith.extsi %mask_qk_n_472 : i32 to i64 loc(#loc596)
    %mask_qk_n_476 = arith.extsi %mask_qk_n_474 : i32 to i64 loc(#loc596)
    %mask_qk_n_477 = arith.muli %mask_qk_n_475, %mask_qk_n_476 : i64 loc(#loc596)
    %mask_qk_n_478 = arith.constant 2147483647 : i64 loc(#loc596)
    %mask_qk_n_479 = arith.constant -2147483648 : i64 loc(#loc596)
    %mask_qk_n_480 = arith.cmpi sle, %mask_qk_n_477, %mask_qk_n_478 : i64 loc(#loc596)
    %mask_qk_n_481 = arith.cmpi sge, %mask_qk_n_477, %mask_qk_n_479 : i64 loc(#loc596)
    %mask_qk_n_482 = arith.andi %mask_qk_n_480, %mask_qk_n_481 : i1 loc(#loc596)
    %mask_qk_n_483 = arith.muli %mask_qk_n_472, %mask_qk_n_474 : i32 loc(#loc596)
    %mask_qk_n_484 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc597)
    %mask_qk_n_485 = tt.splat %mask_qk_n_483 : i32 -> tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_486 = arith.extsi %mask_qk_n_485 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_487 = arith.extsi %mask_qk_n_484 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_488 = arith.addi %mask_qk_n_486, %mask_qk_n_487 : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_489 = arith.constant 2147483647 : i64 loc(#loc598)
    %mask_qk_n_490 = arith.constant -2147483648 : i64 loc(#loc598)
    %mask_qk_n_491 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_492 = arith.cmpi sle, %mask_qk_n_488, %mask_qk_n_491 : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_493 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_494 = arith.cmpi sge, %mask_qk_n_488, %mask_qk_n_493 : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_495 = arith.andi %mask_qk_n_492, %mask_qk_n_494 : tensor<64xi1, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %mask_qk_n_496 = arith.addi %mask_qk_n_485, %mask_qk_n_484 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc598)
    %qk_497 = tt.expand_dims %mask_qk_n_496 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x64xi32, #mma> loc(#loc599)
    %qk_498 = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<1x64xi32, #mma> loc(#loc600)
    %qk_499 = arith.cmpi slt, %qk_497, %qk_498 : tensor<1x64xi32, #mma> loc(#loc600)
    %qk_500 = tt.expand_dims %mask_qk_h {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xi32, #mma> loc(#loc601)
    %qk_501 = arith.constant 0 : i32 loc(#loc602)
    %qk_502 = arith.constant dense<0> : tensor<16x1xi32, #mma> loc(#loc602)
    %qk_503 = arith.cmpi sge, %qk_500, %qk_502 : tensor<16x1xi32, #mma> loc(#loc602)
    %qk_504 = tt.broadcast %qk_499 : tensor<1x64xi1, #mma> -> tensor<16x64xi1, #mma> loc(#loc603)
    %qk_505 = tt.broadcast %qk_503 : tensor<16x1xi1, #mma> -> tensor<16x64xi1, #mma> loc(#loc603)
    %qk_506 = arith.andi %qk_504, %qk_505 : tensor<16x64xi1, #mma> loc(#loc603)
    %qk_507 = arith.constant 0xFF800000 : f32 loc(#loc604)
    %qk_508 = arith.constant 0xFF800000 : f32 loc(#loc604)
    %qk_509 = arith.constant dense<0xFF800000> : tensor<16x64xf32, #mma> loc(#loc604)
    %qk_510 = arith.select %qk_506, %qk_462, %qk_509 : tensor<16x64xi1, #mma>, tensor<16x64xf32, #mma> loc(#loc604)
    %n_e_max = tt.call @"triton.language.standard.max__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%qk_510) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc605)
    %n_e_max_511 = ttg.convert_layout %n_e_max : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc606)
    %n_e_max_512 = arith.maxnumf %n_e_max_511, %kv2_transpose_453#16 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc607)
    %re_scale = arith.subf %kv2_transpose_453#16, %n_e_max_512 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc608)
    %re_scale_513 = arith.constant 1.44269502 : f32 loc(#loc609)
    %re_scale_514 = arith.constant 1.44269502 : f32 loc(#loc609)
    %re_scale_515 = arith.constant dense<1.44269502> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc609)
    %re_scale_516 = arith.mulf %re_scale, %re_scale_515 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc609)
    %re_scale_517 = math.exp2 %re_scale_516 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc610)
    %p = tt.expand_dims %n_e_max_512 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc611)
    %p_518 = tt.broadcast %p : tensor<16x1xf32, #mma> -> tensor<16x64xf32, #mma> loc(#loc612)
    %p_519 = arith.subf %qk_510, %p_518 : tensor<16x64xf32, #mma> loc(#loc612)
    %p_520 = arith.constant 1.44269502 : f32 loc(#loc613)
    %p_521 = arith.constant 1.44269502 : f32 loc(#loc613)
    %p_522 = arith.constant dense<1.44269502> : tensor<16x64xf32, #mma> loc(#loc613)
    %p_523 = arith.mulf %p_519, %p_522 : tensor<16x64xf32, #mma> loc(#loc613)
    %p_524 = math.exp2 %p_523 : tensor<16x64xf32, #mma> loc(#loc614)
    %17 = arith.truncf %p_524 : tensor<16x64xf32, #mma> to tensor<16x64xbf16, #mma> loc(#loc268)
    ttg.local_store %17, %smem_p : tensor<16x64xbf16, #mma> -> !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> loc(#loc269)
    %acc1_525 = tt.expand_dims %re_scale_517 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc615)
    %acc1_526 = tt.broadcast %acc1_525 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc616)
    %acc1_527 = arith.mulf %kv2_transpose_453#1, %acc1_526 : tensor<16x256xf32, #mma> loc(#loc616)
    %acc2_528 = tt.expand_dims %re_scale_517 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc617)
    %acc2_529 = tt.broadcast %acc2_528 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc618)
    %acc2_530 = arith.mulf %kv2_transpose_453#2, %acc2_529 : tensor<16x256xf32, #mma> loc(#loc618)
    %e_sum_531 = arith.mulf %kv2_transpose_453#15, %re_scale_517 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc619)
    %e_sum_532 = tt.call @"triton.language.standard.sum__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%p_524) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc620)
    %e_sum_533 = arith.addf %e_sum_531, %e_sum_532 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc621)
    rocdl.sched.barrier 0 loc(#loc277)
    %cur_p = ttg.local_load %smem_p : !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc622)
    %acc1_534 = arith.constant 0.000000e+00 : f32 loc(#loc623)
    %acc1_535 = tt.dot %cur_p, %cur_k1_459, %acc1_527 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc623)
    %acc2_536 = arith.constant 0.000000e+00 : f32 loc(#loc624)
    %acc2_537 = tt.dot %cur_p, %cur_k2_460, %acc2_530 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc624)
    ttg.local_dealloc %kv2_transpose_453#9 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc281)
    ttg.local_dealloc %kv2_transpose_453#10 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc282)
    %acc = tt.join %acc1_535, %acc2_537 : tensor<16x256xf32, #mma> -> tensor<16x256x2xf32, #linear> loc(#loc625)
    %acc_538 = tt.trans %acc {order = array<i32: 0, 2, 1>} : tensor<16x256x2xf32, #linear> -> tensor<16x2x256xf32, #linear1> loc(#loc626)
    %acc_539 = tt.reshape %acc_538 : tensor<16x2x256xf32, #linear1> -> tensor<16x512xf32, #linear2> loc(#loc627)
    %acc_540 = ttg.convert_layout %acc_539 : tensor<16x512xf32, #linear2> -> tensor<16x512xf32, #mma> loc(#loc628)
    %smem_o = ttg.local_alloc : () -> !ttg.memdesc<16x512xf32, #shared, #smem, mutable> loc(#loc629)
    %e_sum_541 = arith.constant 1 : i32 loc(#loc630)
    %e_sum_542 = arith.constant 1.000000e+00 : f32 loc(#loc630)
    %e_sum_543 = arith.constant dense<1.000000e+00> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc630)
    %e_sum_544 = arith.divf %e_sum_543, %e_sum_533 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc630)
    %18 = tt.expand_dims %e_sum_544 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc289)
    %19 = tt.broadcast %18 : tensor<16x1xf32, #mma> -> tensor<16x512xf32, #mma> loc(#loc290)
    %20 = arith.mulf %acc_540, %19 : tensor<16x512xf32, #mma> loc(#loc290)
    ttg.local_store %20, %smem_o : tensor<16x512xf32, #mma> -> !ttg.memdesc<16x512xf32, #shared, #smem, mutable> loc(#loc291)
    %cur_o = ttg.local_load %smem_o : !ttg.memdesc<16x512xf32, #shared, #smem, mutable> -> tensor<16x512xf32, #blocked> loc(#loc631)
    %offs_mid_o = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc632)
    %offs_mid_o_545 = arith.extsi %stride_mid_ob : i32 to i64 loc(#loc632)
    %offs_mid_o_546 = arith.muli %offs_mid_o, %offs_mid_o_545 : i64 loc(#loc632)
    %offs_mid_o_547 = arith.constant 2147483647 : i64 loc(#loc632)
    %offs_mid_o_548 = arith.constant -2147483648 : i64 loc(#loc632)
    %offs_mid_o_549 = arith.cmpi sle, %offs_mid_o_546, %offs_mid_o_547 : i64 loc(#loc632)
    %offs_mid_o_550 = arith.cmpi sge, %offs_mid_o_546, %offs_mid_o_548 : i64 loc(#loc632)
    %offs_mid_o_551 = arith.andi %offs_mid_o_549, %offs_mid_o_550 : i1 loc(#loc632)
    %offs_mid_o_552 = arith.muli %cur_batch_39, %stride_mid_ob : i32 loc(#loc632)
    %offs_mid_o_553 = tt.expand_dims %cur_head_66 {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi32, #blocked> loc(#loc633)
    %offs_mid_o_554 = tt.splat %stride_mid_oh : i32 -> tensor<16x1xi32, #blocked> loc(#loc634)
    %offs_mid_o_555 = arith.extsi %offs_mid_o_553 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_556 = arith.extsi %offs_mid_o_554 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_557 = arith.muli %offs_mid_o_555, %offs_mid_o_556 : tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_558 = arith.constant 2147483647 : i64 loc(#loc634)
    %offs_mid_o_559 = arith.constant -2147483648 : i64 loc(#loc634)
    %offs_mid_o_560 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_561 = arith.cmpi sle, %offs_mid_o_557, %offs_mid_o_560 : tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_562 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_563 = arith.cmpi sge, %offs_mid_o_557, %offs_mid_o_562 : tensor<16x1xi64, #blocked> loc(#loc634)
    %offs_mid_o_564 = arith.andi %offs_mid_o_561, %offs_mid_o_563 : tensor<16x1xi1, #blocked> loc(#loc634)
    %offs_mid_o_565 = arith.muli %offs_mid_o_553, %offs_mid_o_554 : tensor<16x1xi32, #blocked> loc(#loc634)
    %offs_mid_o_566 = tt.splat %offs_mid_o_552 : i32 -> tensor<16x1xi32, #blocked> loc(#loc635)
    %offs_mid_o_567 = arith.extsi %offs_mid_o_566 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_568 = arith.extsi %offs_mid_o_565 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_569 = arith.addi %offs_mid_o_567, %offs_mid_o_568 : tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_570 = arith.constant 2147483647 : i64 loc(#loc635)
    %offs_mid_o_571 = arith.constant -2147483648 : i64 loc(#loc635)
    %offs_mid_o_572 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_573 = arith.cmpi sle, %offs_mid_o_569, %offs_mid_o_572 : tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_574 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_575 = arith.cmpi sge, %offs_mid_o_569, %offs_mid_o_574 : tensor<16x1xi64, #blocked> loc(#loc635)
    %offs_mid_o_576 = arith.andi %offs_mid_o_573, %offs_mid_o_575 : tensor<16x1xi1, #blocked> loc(#loc635)
    %offs_mid_o_577 = arith.addi %offs_mid_o_566, %offs_mid_o_565 : tensor<16x1xi32, #blocked> loc(#loc635)
    %offs_mid_o_578 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc636)
    %offs_mid_o_579 = arith.extsi %stride_mid_os : i32 to i64 loc(#loc636)
    %offs_mid_o_580 = arith.muli %offs_mid_o_578, %offs_mid_o_579 : i64 loc(#loc636)
    %offs_mid_o_581 = arith.constant 2147483647 : i64 loc(#loc636)
    %offs_mid_o_582 = arith.constant -2147483648 : i64 loc(#loc636)
    %offs_mid_o_583 = arith.cmpi sle, %offs_mid_o_580, %offs_mid_o_581 : i64 loc(#loc636)
    %offs_mid_o_584 = arith.cmpi sge, %offs_mid_o_580, %offs_mid_o_582 : i64 loc(#loc636)
    %offs_mid_o_585 = arith.andi %offs_mid_o_583, %offs_mid_o_584 : i1 loc(#loc636)
    %offs_mid_o_586 = arith.muli %split_kv_id_25, %stride_mid_os : i32 loc(#loc636)
    %offs_mid_o_587 = tt.splat %offs_mid_o_586 : i32 -> tensor<16x1xi32, #blocked> loc(#loc637)
    %offs_mid_o_588 = arith.extsi %offs_mid_o_577 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_589 = arith.extsi %offs_mid_o_587 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_590 = arith.addi %offs_mid_o_588, %offs_mid_o_589 : tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_591 = arith.constant 2147483647 : i64 loc(#loc637)
    %offs_mid_o_592 = arith.constant -2147483648 : i64 loc(#loc637)
    %offs_mid_o_593 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_594 = arith.cmpi sle, %offs_mid_o_590, %offs_mid_o_593 : tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_595 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_596 = arith.cmpi sge, %offs_mid_o_590, %offs_mid_o_595 : tensor<16x1xi64, #blocked> loc(#loc637)
    %offs_mid_o_597 = arith.andi %offs_mid_o_594, %offs_mid_o_596 : tensor<16x1xi1, #blocked> loc(#loc637)
    %offs_mid_o_598 = arith.addi %offs_mid_o_577, %offs_mid_o_587 : tensor<16x1xi32, #blocked> loc(#loc637)
    %offs_mid_o_599 = tt.expand_dims %offs_c {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc638)
    %offs_mid_o_600 = tt.broadcast %offs_mid_o_598 : tensor<16x1xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc639)
    %offs_mid_o_601 = tt.broadcast %offs_mid_o_599 : tensor<1x512xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc639)
    %offs_mid_o_602 = arith.extsi %offs_mid_o_600 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_603 = arith.extsi %offs_mid_o_601 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_604 = arith.addi %offs_mid_o_602, %offs_mid_o_603 : tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_605 = arith.constant 2147483647 : i64 loc(#loc639)
    %offs_mid_o_606 = arith.constant -2147483648 : i64 loc(#loc639)
    %offs_mid_o_607 = arith.constant dense<2147483647> : tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_608 = arith.cmpi sle, %offs_mid_o_604, %offs_mid_o_607 : tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_609 = arith.constant dense<-2147483648> : tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_610 = arith.cmpi sge, %offs_mid_o_604, %offs_mid_o_609 : tensor<16x512xi64, #blocked> loc(#loc639)
    %offs_mid_o_611 = arith.andi %offs_mid_o_608, %offs_mid_o_610 : tensor<16x512xi1, #blocked> loc(#loc639)
    %offs_mid_o_612 = arith.addi %offs_mid_o_600, %offs_mid_o_601 : tensor<16x512xi32, #blocked> loc(#loc639)
    %21 = tt.expand_dims %mask_h_93 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi1, #blocked> loc(#loc301)
    %22 = tt.expand_dims %mask_c_211 {axis = 0 : i32} : tensor<512xi1, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi1, #blocked> loc(#loc302)
    %23 = tt.broadcast %21 : tensor<16x1xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc303)
    %24 = tt.broadcast %22 : tensor<1x512xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc303)
    %25 = arith.andi %23, %24 : tensor<16x512xi1, #blocked> loc(#loc303)
    amdgpu.buffer_store %cur_o, %Att_Out[%offs_mid_o_612], %25 : tensor<16x512xf32, #blocked> loc(#loc304)
    %offs_mid_lse = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc640)
    %offs_mid_lse_613 = arith.extsi %stride_mid_lse_b : i32 to i64 loc(#loc640)
    %offs_mid_lse_614 = arith.muli %offs_mid_lse, %offs_mid_lse_613 : i64 loc(#loc640)
    %offs_mid_lse_615 = arith.constant 2147483647 : i64 loc(#loc640)
    %offs_mid_lse_616 = arith.constant -2147483648 : i64 loc(#loc640)
    %offs_mid_lse_617 = arith.cmpi sle, %offs_mid_lse_614, %offs_mid_lse_615 : i64 loc(#loc640)
    %offs_mid_lse_618 = arith.cmpi sge, %offs_mid_lse_614, %offs_mid_lse_616 : i64 loc(#loc640)
    %offs_mid_lse_619 = arith.andi %offs_mid_lse_617, %offs_mid_lse_618 : i1 loc(#loc640)
    %offs_mid_lse_620 = arith.muli %cur_batch_39, %stride_mid_lse_b : i32 loc(#loc640)
    %offs_mid_lse_621 = tt.splat %stride_mid_lse_h : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_622 = arith.extsi %offs_om : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_623 = arith.extsi %offs_mid_lse_621 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_624 = arith.muli %offs_mid_lse_622, %offs_mid_lse_623 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_625 = arith.constant 2147483647 : i64 loc(#loc641)
    %offs_mid_lse_626 = arith.constant -2147483648 : i64 loc(#loc641)
    %offs_mid_lse_627 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_628 = arith.cmpi sle, %offs_mid_lse_624, %offs_mid_lse_627 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_629 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_630 = arith.cmpi sge, %offs_mid_lse_624, %offs_mid_lse_629 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_631 = arith.andi %offs_mid_lse_628, %offs_mid_lse_630 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_632 = arith.muli %offs_om, %offs_mid_lse_621 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc641)
    %offs_mid_lse_633 = tt.splat %offs_mid_lse_620 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_634 = arith.extsi %offs_mid_lse_633 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_635 = arith.extsi %offs_mid_lse_632 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_636 = arith.addi %offs_mid_lse_634, %offs_mid_lse_635 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_637 = arith.constant 2147483647 : i64 loc(#loc642)
    %offs_mid_lse_638 = arith.constant -2147483648 : i64 loc(#loc642)
    %offs_mid_lse_639 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_640 = arith.cmpi sle, %offs_mid_lse_636, %offs_mid_lse_639 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_641 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_642 = arith.cmpi sge, %offs_mid_lse_636, %offs_mid_lse_641 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_643 = arith.andi %offs_mid_lse_640, %offs_mid_lse_642 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_644 = arith.addi %offs_mid_lse_633, %offs_mid_lse_632 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc642)
    %offs_mid_lse_645 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc643)
    %offs_mid_lse_646 = arith.extsi %stride_mid_lse_s : i32 to i64 loc(#loc643)
    %offs_mid_lse_647 = arith.muli %offs_mid_lse_645, %offs_mid_lse_646 : i64 loc(#loc643)
    %offs_mid_lse_648 = arith.constant 2147483647 : i64 loc(#loc643)
    %offs_mid_lse_649 = arith.constant -2147483648 : i64 loc(#loc643)
    %offs_mid_lse_650 = arith.cmpi sle, %offs_mid_lse_647, %offs_mid_lse_648 : i64 loc(#loc643)
    %offs_mid_lse_651 = arith.cmpi sge, %offs_mid_lse_647, %offs_mid_lse_649 : i64 loc(#loc643)
    %offs_mid_lse_652 = arith.andi %offs_mid_lse_650, %offs_mid_lse_651 : i1 loc(#loc643)
    %offs_mid_lse_653 = arith.muli %split_kv_id_25, %stride_mid_lse_s : i32 loc(#loc643)
    %offs_mid_lse_654 = tt.splat %offs_mid_lse_653 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_655 = arith.extsi %offs_mid_lse_644 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_656 = arith.extsi %offs_mid_lse_654 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_657 = arith.addi %offs_mid_lse_655, %offs_mid_lse_656 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_658 = arith.constant 2147483647 : i64 loc(#loc644)
    %offs_mid_lse_659 = arith.constant -2147483648 : i64 loc(#loc644)
    %offs_mid_lse_660 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_661 = arith.cmpi sle, %offs_mid_lse_657, %offs_mid_lse_660 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_662 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_663 = arith.cmpi sge, %offs_mid_lse_657, %offs_mid_lse_662 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_664 = arith.andi %offs_mid_lse_661, %offs_mid_lse_663 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %offs_mid_lse_665 = arith.addi %offs_mid_lse_644, %offs_mid_lse_654 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc644)
    %mask_lse = arith.constant 1 : i32 loc(#loc645)
    %mask_lse_666 = arith.constant 1 : i32 loc(#loc645)
    %mask_lse_667 = arith.extsi %cur_head_id : i32 to i64 loc(#loc645)
    %mask_lse_668 = arith.extsi %mask_lse_666 : i32 to i64 loc(#loc645)
    %mask_lse_669 = arith.addi %mask_lse_667, %mask_lse_668 : i64 loc(#loc645)
    %mask_lse_670 = arith.constant 2147483647 : i64 loc(#loc645)
    %mask_lse_671 = arith.constant -2147483648 : i64 loc(#loc645)
    %mask_lse_672 = arith.cmpi sle, %mask_lse_669, %mask_lse_670 : i64 loc(#loc645)
    %mask_lse_673 = arith.cmpi sge, %mask_lse_669, %mask_lse_671 : i64 loc(#loc645)
    %mask_lse_674 = arith.andi %mask_lse_672, %mask_lse_673 : i1 loc(#loc645)
    %mask_lse_675 = arith.addi %cur_head_id, %mask_lse_666 : i32 loc(#loc645)
    %mask_lse_676 = arith.constant 8 : i32 loc(#loc646)
    %mask_lse_677 = arith.constant 8 : i32 loc(#loc646)
    %mask_lse_678 = arith.extsi %mask_lse_675 : i32 to i64 loc(#loc646)
    %mask_lse_679 = arith.extsi %mask_lse_677 : i32 to i64 loc(#loc646)
    %mask_lse_680 = arith.muli %mask_lse_678, %mask_lse_679 : i64 loc(#loc646)
    %mask_lse_681 = arith.constant 2147483647 : i64 loc(#loc646)
    %mask_lse_682 = arith.constant -2147483648 : i64 loc(#loc646)
    %mask_lse_683 = arith.cmpi sle, %mask_lse_680, %mask_lse_681 : i64 loc(#loc646)
    %mask_lse_684 = arith.cmpi sge, %mask_lse_680, %mask_lse_682 : i64 loc(#loc646)
    %mask_lse_685 = arith.andi %mask_lse_683, %mask_lse_684 : i1 loc(#loc646)
    %mask_lse_686 = arith.muli %mask_lse_675, %mask_lse_677 : i32 loc(#loc646)
    %mask_lse_687 = tt.splat %mask_lse_686 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc647)
    %mask_lse_688 = arith.cmpi slt, %offs_om, %mask_lse_687 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc647)
    %26 = math.log %e_sum_544 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc313)
    %27 = arith.subf %n_e_max_512, %26 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc314)
    amdgpu.buffer_store %27, %Att_Lse[%offs_mid_lse_665], %mask_lse_688 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc315)
    tt.return loc(#loc316)
  } loc(#loc1)
  tt.func private @"triton.language.standard.cdiv____(0,)cconstexpr_8__(1,)cconstexpr_16_"() -> i32 attributes {noinline = false} {
    %c1_i32 = arith.constant 1 : i32 loc(#loc318)
    tt.return %c1_i32 : i32 loc(#loc318)
  ^bb1:  // no predecessors
    %0 = ub.poison : i32 loc(#loc319)
    tt.return %0 : i32 loc(#loc319)
  } loc(#loc317)
  tt.func private @"aiter.ops.triton.utils._triton.pid_preprocessing.remap_xcd__i32_i32__(2,)cconstexpr_8_"(%pid: i32 loc("pid"(#loc320)), %GRID_MN: i32 loc("GRID_MN"(#loc320))) -> i32 attributes {noinline = false} {
    %pids_per_xcd = arith.constant 8 : i32 loc(#loc650)
    %pids_per_xcd_0 = arith.constant 8 : i32 loc(#loc650)
    %pids_per_xcd_1 = arith.extsi %GRID_MN : i32 to i64 loc(#loc650)
    %pids_per_xcd_2 = arith.extsi %pids_per_xcd_0 : i32 to i64 loc(#loc650)
    %pids_per_xcd_3 = arith.addi %pids_per_xcd_1, %pids_per_xcd_2 : i64 loc(#loc650)
    %pids_per_xcd_4 = arith.constant 2147483647 : i64 loc(#loc650)
    %pids_per_xcd_5 = arith.constant -2147483648 : i64 loc(#loc650)
    %pids_per_xcd_6 = arith.cmpi sle, %pids_per_xcd_3, %pids_per_xcd_4 : i64 loc(#loc650)
    %pids_per_xcd_7 = arith.cmpi sge, %pids_per_xcd_3, %pids_per_xcd_5 : i64 loc(#loc650)
    %pids_per_xcd_8 = arith.andi %pids_per_xcd_6, %pids_per_xcd_7 : i1 loc(#loc650)
    %pids_per_xcd_9 = arith.addi %GRID_MN, %pids_per_xcd_0 : i32 loc(#loc650)
    %pids_per_xcd_10 = arith.constant 1 : i32 loc(#loc651)
    %pids_per_xcd_11 = arith.constant 1 : i32 loc(#loc651)
    %pids_per_xcd_12 = arith.extsi %pids_per_xcd_9 : i32 to i64 loc(#loc651)
    %pids_per_xcd_13 = arith.extsi %pids_per_xcd_11 : i32 to i64 loc(#loc651)
    %pids_per_xcd_14 = arith.subi %pids_per_xcd_12, %pids_per_xcd_13 : i64 loc(#loc651)
    %pids_per_xcd_15 = arith.constant 2147483647 : i64 loc(#loc651)
    %pids_per_xcd_16 = arith.constant -2147483648 : i64 loc(#loc651)
    %pids_per_xcd_17 = arith.cmpi sle, %pids_per_xcd_14, %pids_per_xcd_15 : i64 loc(#loc651)
    %pids_per_xcd_18 = arith.cmpi sge, %pids_per_xcd_14, %pids_per_xcd_16 : i64 loc(#loc651)
    %pids_per_xcd_19 = arith.andi %pids_per_xcd_17, %pids_per_xcd_18 : i1 loc(#loc651)
    %pids_per_xcd_20 = arith.subi %pids_per_xcd_9, %pids_per_xcd_11 : i32 loc(#loc651)
    %pids_per_xcd_21 = arith.constant 8 : i32 loc(#loc652)
    %pids_per_xcd_22 = arith.constant 8 : i32 loc(#loc652)
    %pids_per_xcd_23 = arith.divsi %pids_per_xcd_20, %pids_per_xcd_22 : i32 loc(#loc652)
    %tall_xcds = arith.constant 8 : i32 loc(#loc653)
    %tall_xcds_24 = arith.constant 8 : i32 loc(#loc653)
    %tall_xcds_25 = arith.remsi %GRID_MN, %tall_xcds_24 : i32 loc(#loc653)
    %tall_xcds_26 = arith.constant 0 : i32 loc(#loc654)
    %tall_xcds_27 = arith.cmpi eq, %tall_xcds_25, %tall_xcds_26 : i32 loc(#loc654)
    %tall_xcds_28 = scf.if %tall_xcds_27 -> (i32) {
      %tall_xcds_33 = arith.constant 8 : i32 loc(#loc656)
      scf.yield %tall_xcds_33 : i32 loc(#loc656)
    } else {
      scf.yield %tall_xcds_25 : i32 loc(#loc)
    } loc(#loc655)
    %xcd = arith.constant 8 : i32 loc(#loc657)
    %xcd_29 = arith.constant 8 : i32 loc(#loc657)
    %xcd_30 = arith.remsi %pid, %xcd_29 : i32 loc(#loc657)
    %local_pid = arith.constant 8 : i32 loc(#loc658)
    %local_pid_31 = arith.constant 8 : i32 loc(#loc658)
    %local_pid_32 = arith.divsi %pid, %local_pid_31 : i32 loc(#loc658)
    %0 = arith.cmpi slt, %xcd_30, %tall_xcds_28 : i32 loc(#loc330)
    %1 = scf.if %0 -> (i32) {
      %pid_33 = arith.extsi %xcd_30 : i32 to i64 loc(#loc659)
      %pid_34 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc659)
      %pid_35 = arith.muli %pid_33, %pid_34 : i64 loc(#loc659)
      %pid_36 = arith.constant 2147483647 : i64 loc(#loc659)
      %pid_37 = arith.constant -2147483648 : i64 loc(#loc659)
      %pid_38 = arith.cmpi sle, %pid_35, %pid_36 : i64 loc(#loc659)
      %pid_39 = arith.cmpi sge, %pid_35, %pid_37 : i64 loc(#loc659)
      %pid_40 = arith.andi %pid_38, %pid_39 : i1 loc(#loc659)
      %pid_41 = arith.muli %xcd_30, %pids_per_xcd_23 : i32 loc(#loc659)
      %pid_42 = arith.extsi %pid_41 : i32 to i64 loc(#loc660)
      %pid_43 = arith.extsi %local_pid_32 : i32 to i64 loc(#loc660)
      %pid_44 = arith.addi %pid_42, %pid_43 : i64 loc(#loc660)
      %pid_45 = arith.constant 2147483647 : i64 loc(#loc660)
      %pid_46 = arith.constant -2147483648 : i64 loc(#loc660)
      %pid_47 = arith.cmpi sle, %pid_44, %pid_45 : i64 loc(#loc660)
      %pid_48 = arith.cmpi sge, %pid_44, %pid_46 : i64 loc(#loc660)
      %pid_49 = arith.andi %pid_47, %pid_48 : i1 loc(#loc660)
      %pid_50 = arith.addi %pid_41, %local_pid_32 : i32 loc(#loc675)
      scf.yield %pid_50 : i32 loc(#loc675)
    } else {
      %pid_33 = arith.extsi %tall_xcds_28 : i32 to i64 loc(#loc661)
      %pid_34 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc661)
      %pid_35 = arith.muli %pid_33, %pid_34 : i64 loc(#loc661)
      %pid_36 = arith.constant 2147483647 : i64 loc(#loc661)
      %pid_37 = arith.constant -2147483648 : i64 loc(#loc661)
      %pid_38 = arith.cmpi sle, %pid_35, %pid_36 : i64 loc(#loc661)
      %pid_39 = arith.cmpi sge, %pid_35, %pid_37 : i64 loc(#loc661)
      %pid_40 = arith.andi %pid_38, %pid_39 : i1 loc(#loc661)
      %pid_41 = arith.muli %tall_xcds_28, %pids_per_xcd_23 : i32 loc(#loc661)
      %pid_42 = arith.extsi %xcd_30 : i32 to i64 loc(#loc662)
      %pid_43 = arith.extsi %tall_xcds_28 : i32 to i64 loc(#loc662)
      %pid_44 = arith.subi %pid_42, %pid_43 : i64 loc(#loc662)
      %pid_45 = arith.constant 2147483647 : i64 loc(#loc662)
      %pid_46 = arith.constant -2147483648 : i64 loc(#loc662)
      %pid_47 = arith.cmpi sle, %pid_44, %pid_45 : i64 loc(#loc662)
      %pid_48 = arith.cmpi sge, %pid_44, %pid_46 : i64 loc(#loc662)
      %pid_49 = arith.andi %pid_47, %pid_48 : i1 loc(#loc662)
      %pid_50 = arith.subi %xcd_30, %tall_xcds_28 : i32 loc(#loc662)
      %pid_51 = arith.constant 1 : i32 loc(#loc663)
      %pid_52 = arith.constant 1 : i32 loc(#loc663)
      %pid_53 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc663)
      %pid_54 = arith.extsi %pid_52 : i32 to i64 loc(#loc663)
      %pid_55 = arith.subi %pid_53, %pid_54 : i64 loc(#loc663)
      %pid_56 = arith.constant 2147483647 : i64 loc(#loc663)
      %pid_57 = arith.constant -2147483648 : i64 loc(#loc663)
      %pid_58 = arith.cmpi sle, %pid_55, %pid_56 : i64 loc(#loc663)
      %pid_59 = arith.cmpi sge, %pid_55, %pid_57 : i64 loc(#loc663)
      %pid_60 = arith.andi %pid_58, %pid_59 : i1 loc(#loc663)
      %pid_61 = arith.subi %pids_per_xcd_23, %pid_52 : i32 loc(#loc663)
      %pid_62 = arith.extsi %pid_50 : i32 to i64 loc(#loc664)
      %pid_63 = arith.extsi %pid_61 : i32 to i64 loc(#loc664)
      %pid_64 = arith.muli %pid_62, %pid_63 : i64 loc(#loc664)
      %pid_65 = arith.constant 2147483647 : i64 loc(#loc664)
      %pid_66 = arith.constant -2147483648 : i64 loc(#loc664)
      %pid_67 = arith.cmpi sle, %pid_64, %pid_65 : i64 loc(#loc664)
      %pid_68 = arith.cmpi sge, %pid_64, %pid_66 : i64 loc(#loc664)
      %pid_69 = arith.andi %pid_67, %pid_68 : i1 loc(#loc664)
      %pid_70 = arith.muli %pid_50, %pid_61 : i32 loc(#loc664)
      %pid_71 = arith.extsi %pid_41 : i32 to i64 loc(#loc665)
      %pid_72 = arith.extsi %pid_70 : i32 to i64 loc(#loc665)
      %pid_73 = arith.addi %pid_71, %pid_72 : i64 loc(#loc665)
      %pid_74 = arith.constant 2147483647 : i64 loc(#loc665)
      %pid_75 = arith.constant -2147483648 : i64 loc(#loc665)
      %pid_76 = arith.cmpi sle, %pid_73, %pid_74 : i64 loc(#loc665)
      %pid_77 = arith.cmpi sge, %pid_73, %pid_75 : i64 loc(#loc665)
      %pid_78 = arith.andi %pid_76, %pid_77 : i1 loc(#loc665)
      %pid_79 = arith.addi %pid_41, %pid_70 : i32 loc(#loc665)
      %pid_80 = arith.extsi %pid_79 : i32 to i64 loc(#loc666)
      %pid_81 = arith.extsi %local_pid_32 : i32 to i64 loc(#loc666)
      %pid_82 = arith.addi %pid_80, %pid_81 : i64 loc(#loc666)
      %pid_83 = arith.constant 2147483647 : i64 loc(#loc666)
      %pid_84 = arith.constant -2147483648 : i64 loc(#loc666)
      %pid_85 = arith.cmpi sle, %pid_82, %pid_83 : i64 loc(#loc666)
      %pid_86 = arith.cmpi sge, %pid_82, %pid_84 : i64 loc(#loc666)
      %pid_87 = arith.andi %pid_85, %pid_86 : i1 loc(#loc666)
      %pid_88 = arith.addi %pid_79, %local_pid_32 : i32 loc(#loc676)
      scf.yield %pid_88 : i32 loc(#loc666)
    } loc(#loc331)
    tt.return %1 : i32 loc(#loc340)
  ^bb1:  // no predecessors
    %2 = ub.poison : i32 loc(#loc341)
    tt.return %2 : i32 loc(#loc341)
  } loc(#loc320)
  tt.func private @"triton.language.standard.cdiv__i32__(1,)cconstexpr_64_"(%x: i32 loc("x"(#loc317))) -> i32 attributes {noinline = false} {
    %c64_i32 = arith.constant 64 : i32 loc(#loc342)
    %c64_i32_0 = arith.constant 64 : i32 loc(#loc342)
    %0 = arith.extsi %x : i32 to i64 loc(#loc342)
    %1 = arith.extsi %c64_i32_0 : i32 to i64 loc(#loc342)
    %2 = arith.addi %0, %1 : i64 loc(#loc342)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc342)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc342)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc342)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc342)
    %5 = arith.andi %3, %4 : i1 loc(#loc342)
    %6 = arith.addi %x, %c64_i32_0 : i32 loc(#loc342)
    %c1_i32 = arith.constant 1 : i32 loc(#loc343)
    %c1_i32_1 = arith.constant 1 : i32 loc(#loc343)
    %7 = arith.extsi %6 : i32 to i64 loc(#loc343)
    %8 = arith.extsi %c1_i32_1 : i32 to i64 loc(#loc343)
    %9 = arith.subi %7, %8 : i64 loc(#loc343)
    %c2147483647_i64_2 = arith.constant 2147483647 : i64 loc(#loc343)
    %c-2147483648_i64_3 = arith.constant -2147483648 : i64 loc(#loc343)
    %10 = arith.cmpi sle, %9, %c2147483647_i64_2 : i64 loc(#loc343)
    %11 = arith.cmpi sge, %9, %c-2147483648_i64_3 : i64 loc(#loc343)
    %12 = arith.andi %10, %11 : i1 loc(#loc343)
    %13 = arith.subi %6, %c1_i32_1 : i32 loc(#loc343)
    %c64_i32_4 = arith.constant 64 : i32 loc(#loc344)
    %c64_i32_5 = arith.constant 64 : i32 loc(#loc344)
    %14 = arith.divsi %13, %c64_i32_5 : i32 loc(#loc344)
    tt.return %14 : i32 loc(#loc318)
  ^bb1:  // no predecessors
    %15 = ub.poison : i32 loc(#loc319)
    tt.return %15 : i32 loc(#loc319)
  } loc(#loc317)
  tt.func private @"triton.language.standard.cdiv__i32__(1,)cconstexpr_8_"(%x: i32 loc("x"(#loc317))) -> i32 attributes {noinline = false} {
    %c8_i32 = arith.constant 8 : i32 loc(#loc342)
    %c8_i32_0 = arith.constant 8 : i32 loc(#loc342)
    %0 = arith.extsi %x : i32 to i64 loc(#loc342)
    %1 = arith.extsi %c8_i32_0 : i32 to i64 loc(#loc342)
    %2 = arith.addi %0, %1 : i64 loc(#loc342)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc342)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc342)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc342)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc342)
    %5 = arith.andi %3, %4 : i1 loc(#loc342)
    %6 = arith.addi %x, %c8_i32_0 : i32 loc(#loc342)
    %c1_i32 = arith.constant 1 : i32 loc(#loc343)
    %c1_i32_1 = arith.constant 1 : i32 loc(#loc343)
    %7 = arith.extsi %6 : i32 to i64 loc(#loc343)
    %8 = arith.extsi %c1_i32_1 : i32 to i64 loc(#loc343)
    %9 = arith.subi %7, %8 : i64 loc(#loc343)
    %c2147483647_i64_2 = arith.constant 2147483647 : i64 loc(#loc343)
    %c-2147483648_i64_3 = arith.constant -2147483648 : i64 loc(#loc343)
    %10 = arith.cmpi sle, %9, %c2147483647_i64_2 : i64 loc(#loc343)
    %11 = arith.cmpi sge, %9, %c-2147483648_i64_3 : i64 loc(#loc343)
    %12 = arith.andi %10, %11 : i1 loc(#loc343)
    %13 = arith.subi %6, %c1_i32_1 : i32 loc(#loc343)
    %c8_i32_4 = arith.constant 8 : i32 loc(#loc344)
    %c8_i32_5 = arith.constant 8 : i32 loc(#loc344)
    %14 = arith.divsi %13, %c8_i32_5 : i32 loc(#loc344)
    tt.return %14 : i32 loc(#loc318)
  ^bb1:  // no predecessors
    %15 = ub.poison : i32 loc(#loc319)
    tt.return %15 : i32 loc(#loc319)
  } loc(#loc317)
  tt.func private @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() -> tensor<16x256xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc346)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<16x256xf32, #mma> loc(#loc346)
    tt.return %cst_0 : tensor<16x256xf32, #mma> loc(#loc347)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<16x256xf32, #mma> loc(#loc348)
    tt.return %0 : tensor<16x256xf32, #mma> loc(#loc348)
  } loc(#loc345)
  tt.func private @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_64__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() -> tensor<16x64xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc346)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<16x64xf32, #mma> loc(#loc346)
    tt.return %cst_0 : tensor<16x64xf32, #mma> loc(#loc347)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<16x64xf32, #mma> loc(#loc348)
    tt.return %0 : tensor<16x64xf32, #mma> loc(#loc348)
  } loc(#loc345)
  tt.func private @"triton.language.standard.max__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%input: tensor<16x64xf32, #mma> loc("input"(#loc349))) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._elementwise_max__fp32_fp32__(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc350)
      tt.reduce.return %2 : f32 loc(#loc350)
    }) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc350)
    tt.return %0 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc351)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc352)
    tt.return %1 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc352)
  } loc(#loc349)
  tt.func private @triton.language.standard._elementwise_max__fp32_fp32__(%a: f32 loc("a"(#loc353)), %b: f32 loc("b"(#loc353))) -> f32 attributes {noinline = false} {
    %0 = arith.maxnumf %a, %b : f32 loc(#loc354)
    tt.return %0 : f32 loc(#loc355)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc356)
    tt.return %1 : f32 loc(#loc356)
  } loc(#loc353)
  tt.func private @"triton.language.standard.sum__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%input: tensor<16x64xf32, #mma> loc("input"(#loc357))) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._sum_combine__fp32_fp32__(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc358)
      tt.reduce.return %2 : f32 loc(#loc358)
    }) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc358)
    tt.return %0 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc359)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc360)
    tt.return %1 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc360)
  } loc(#loc357)
  tt.func private @triton.language.standard._sum_combine__fp32_fp32__(%a: f32 loc("a"(#loc361)), %b: f32 loc("b"(#loc361))) -> f32 attributes {noinline = false} {
    %0 = arith.addf %a, %b : f32 loc(#loc362)
    tt.return %0 : f32 loc(#loc363)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc364)
    tt.return %1 : f32 loc(#loc364)
  } loc(#loc361)
} loc(#loc)
#loc2 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":75:24)
#loc3 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":76:41)
#loc4 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":78:48)
#loc5 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":78:31)
#loc6 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":79:71)
#loc7 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":79:54)
#loc8 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":81:38)
#loc9 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":82:40)
#loc10 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":82:58)
#loc11 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":86:42)
#loc12 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":86:25)
#loc13 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":86:60)
#loc14 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":89:49)
#loc15 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":89:37)
#loc16 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":90:47)
#loc17 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":90:62)
#loc18 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":90:35)
#loc19 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":136:27)
#loc20 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":139:27)
#loc21 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":142:27)
#loc22 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":146:27)
#loc23 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":175:29)
#loc24 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":176:11)
#loc25 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":175:45)
#loc26 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":178:39)
#loc27 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":178:44)
#loc28 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":178:24)
#loc29 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":179:34)
#loc30 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":179:23)
#loc31 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":182:11)
#loc32 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":186:11)
#loc33 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":190:11)
#loc34 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":192:30)
#loc35 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":193:43)
#loc36 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":193:29)
#loc37 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":196:11)
#loc38 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":200:11)
#loc39 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":202:24)
#loc40 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":203:35)
#loc41 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":203:25)
#loc42 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":205:11)
#loc43 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":207:24)
#loc44 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":211:8)
#loc45 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":219:11)
#loc46 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":223:8)
#loc47 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":227:47)
#loc48 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":228:54)
#loc49 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":231:20)
#loc50 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":231:44)
#loc51 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":231:55)
#loc52 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":231:32)
#loc53 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":231:77)
#loc54 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":231:67)
#loc55 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":233:25)
#loc56 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":233:46)
#loc57 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":233:57)
#loc58 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":233:37)
#loc59 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":233:76)
#loc60 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":233:69)
#loc61 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":235:22)
#loc62 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":236:26)
#loc63 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":237:29)
#loc64 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":238:27)
#loc65 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":240:53)
#loc66 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":241:40)
#loc67 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":247:24)
#loc68 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":247:42)
#loc69 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":248:8)
#loc70 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":250:47)
#loc71 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":250:65)
#loc72 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":255:21)
#loc73 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":255:41)
#loc74 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":255:34)
#loc75 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":255:8)
#loc76 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":260:24)
#loc77 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":260:47)
#loc78 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":260:37)
#loc79 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":260:8)
#loc80 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":263:21)
#loc81 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":263:50)
#loc82 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":263:38)
#loc83 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":263:8)
#loc84 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":269:22)
#loc85 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":270:22)
#loc86 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":271:22)
#loc87 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":273:23)
#loc88 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":274:23)
#loc89 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":275:27)
#loc90 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":276:27)
#loc91 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":278:22)
#loc92 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":279:28)
#loc93 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":281:4)
#loc94 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":282:4)
#loc95 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":283:4)
#loc96 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":289:34)
#loc97 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":292:20)
#loc98 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":295:20)
#loc99 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":300:8)
#loc100 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":302:20)
#loc101 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":302:38)
#loc102 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":303:33)
#loc103 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":303:51)
#loc104 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":304:25)
#loc105 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":305:24)
#loc106 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":305:36)
#loc107 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":305:61)
#loc108 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":305:52)
#loc109 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":313:20)
#loc110 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":313:40)
#loc111 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":313:31)
#loc112 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":313:8)
#loc113 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":318:30)
#loc114 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":319:20)
#loc115 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":319:40)
#loc116 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":319:31)
#loc117 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":319:8)
#loc118 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":326:34)
#loc119 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":329:34)
#loc120 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":332:31)
#loc121 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":334:19)
#loc122 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":335:19)
#loc123 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":337:23)
#loc124 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":337:41)
#loc125 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:28)
#loc126 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:39)
#loc127 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:64)
#loc128 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:55)
#loc129 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":339:33)
#loc130 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":339:51)
#loc131 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":340:28)
#loc132 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":348:23)
#loc133 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":348:43)
#loc134 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":348:34)
#loc135 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":348:8)
#loc136 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":354:25)
#loc137 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":354:81)
#loc138 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":354:95)
#loc139 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":355:20)
#loc140 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":360:27)
#loc141 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":361:27)
#loc142 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":363:31)
#loc143 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":365:34)
#loc144 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":366:29)
#loc145 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":367:31)
#loc146 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":369:19)
#loc147 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":371:34)
#loc148 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":372:29)
#loc149 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":373:31)
#loc150 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":375:19)
#loc151 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":377:22)
#loc152 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":378:31)
#loc153 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":379:22)
#loc154 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":381:38)
#loc155 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":386:41)
#loc156 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":388:25)
#loc157 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":388:47)
#loc158 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":388:35)
#loc159 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":388:12)
#loc160 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":391:36)
#loc161 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":393:35)
#loc162 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":394:24)
#loc163 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":394:42)
#loc164 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":395:27)
#loc165 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":395:38)
#loc166 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":395:63)
#loc167 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":395:54)
#loc168 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":396:30)
#loc169 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":396:48)
#loc170 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":397:29)
#loc171 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":398:35)
#loc172 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":400:43)
#loc173 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":404:24)
#loc174 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":404:44)
#loc175 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":404:35)
#loc176 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":404:12)
#loc177 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":407:35)
#loc178 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":409:43)
#loc179 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":412:34)
#loc180 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":413:24)
#loc181 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":413:44)
#loc182 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":413:35)
#loc183 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":413:12)
#loc184 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":419:31)
#loc185 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":420:31)
#loc186 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":422:47)
#loc187 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":424:14)
#loc188 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":435:27)
#loc189 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":435:45)
#loc190 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":436:32)
#loc191 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":436:43)
#loc192 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":436:68)
#loc193 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":436:59)
#loc194 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":437:30)
#loc195 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":437:48)
#loc196 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":438:32)
#loc197 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":440:35)
#loc198 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:27)
#loc199 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:47)
#loc200 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:38)
#loc201 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:12)
#loc202 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":451:47)
#loc203 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":451:51)
#loc204 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":452:38)
#loc205 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":454:41)
#loc206 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":454:52)
#loc207 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":454:32)
#loc208 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":455:39)
#loc209 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":455:31)
#loc210 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":455:51)
#loc211 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":455:25)
#loc212 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":456:26)
#loc213 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":456:21)
#loc214 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":457:35)
#loc215 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":459:28)
#loc216 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":461:38)
#loc217 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":463:38)
#loc218 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":465:23)
#loc219 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":466:31)
#loc220 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":466:22)
#loc221 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":467:48)
#loc222 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":468:24)
#loc223 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":468:45)
#loc224 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":468:35)
#loc225 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":470:23)
#loc226 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":471:31)
#loc227 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":471:22)
#loc228 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":472:48)
#loc229 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":473:26)
#loc230 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":476:31)
#loc231 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":477:33)
#loc232 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":478:35)
#loc233 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":480:38)
#loc234 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":482:23)
#loc235 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:31)
#loc236 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":485:33)
#loc237 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":486:35)
#loc238 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":488:38)
#loc239 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":489:23)
#loc240 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":489:8)
#loc241 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":501:39)
#loc242 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":502:39)
#loc243 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":504:32)
#loc244 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":506:43)
#loc245 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":511:27)
#loc246 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":512:27)
#loc247 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":514:10)
#loc248 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":517:32)
#loc249 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":517:37)
#loc250 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":517:77)
#loc251 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":517:55)
#loc252 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":520:19)
#loc253 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":520:30)
#loc254 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":520:62)
#loc255 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":520:74)
#loc256 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":520:52)
#loc257 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":520:82)
#loc258 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":525:43)
#loc259 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":525:47)
#loc260 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":527:34)
#loc261 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":528:37)
#loc262 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":528:48)
#loc263 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":528:28)
#loc264 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":529:35)
#loc265 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":529:27)
#loc266 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":529:47)
#loc267 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":529:21)
#loc268 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":534:22)
#loc269 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":534:17)
#loc270 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":536:27)
#loc271 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":536:18)
#loc272 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":537:27)
#loc273 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":537:18)
#loc274 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":538:20)
#loc275 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":538:41)
#loc276 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":538:31)
#loc277 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":539:31)
#loc278 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":540:24)
#loc279 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":543:44)
#loc280 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":544:44)
#loc281 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":546:4)
#loc282 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":547:4)
#loc283 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":549:24)
#loc284 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":550:27)
#loc285 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":551:26)
#loc286 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":552:33)
#loc287 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":558:33)
#loc288 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":561:16)
#loc289 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":562:29)
#loc290 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":562:23)
#loc291 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":562:17)
#loc292 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":564:24)
#loc293 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":567:20)
#loc294 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":568:19)
#loc295 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":568:30)
#loc296 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":568:10)
#loc297 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":569:24)
#loc298 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":569:10)
#loc299 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":570:17)
#loc300 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":570:10)
#loc301 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":583:21)
#loc302 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":583:41)
#loc303 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":583:34)
#loc304 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":583:8)
#loc305 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":587:20)
#loc306 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":588:20)
#loc307 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":588:10)
#loc308 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":589:24)
#loc309 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":589:10)
#loc310 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":592:40)
#loc311 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":592:45)
#loc312 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":592:25)
#loc313 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":594:36)
#loc314 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":594:29)
#loc315 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":597:8)
#loc316 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":593:4)
#loc318 = loc("/workspace/triton/python/triton/language/standard.py":41:11)
#loc319 = loc("/workspace/triton/python/triton/language/standard.py":41:4)
#loc321 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:30)
#loc322 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:41)
#loc323 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:47)
#loc324 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":36:26)
#loc325 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:41)
#loc326 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:28)
#loc327 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:16)
#loc328 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":39:16)
#loc329 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":40:23)
#loc330 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":45:13)
#loc331 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":45:7)
#loc332 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":46:20)
#loc333 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":46:35)
#loc334 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":49:24)
#loc335 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:21)
#loc336 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:50)
#loc337 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:35)
#loc338 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:14)
#loc339 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":51:14)
#loc340 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":54:11)
#loc341 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":54:4)
#loc342 = loc("/workspace/triton/python/triton/language/standard.py":41:16)
#loc343 = loc("/workspace/triton/python/triton/language/standard.py":41:22)
#loc344 = loc("/workspace/triton/python/triton/language/standard.py":41:28)
#loc345 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":28:0)
#loc346 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:38)
#loc347 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:11)
#loc348 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:4)
#loc350 = loc("/workspace/triton/python/triton/language/standard.py":189:40)
#loc351 = loc("/workspace/triton/python/triton/language/standard.py":189:15)
#loc352 = loc("/workspace/triton/python/triton/language/standard.py":177:4)
#loc354 = loc("/workspace/triton/python/triton/language/standard.py":168:27)
#loc355 = loc("/workspace/triton/python/triton/language/standard.py":168:11)
#loc356 = loc("/workspace/triton/python/triton/language/standard.py":168:4)
#loc358 = loc("/workspace/triton/python/triton/language/standard.py":291:36)
#loc359 = loc("/workspace/triton/python/triton/language/standard.py":291:11)
#loc360 = loc("/workspace/triton/python/triton/language/standard.py":291:4)
#loc362 = loc("/workspace/triton/python/triton/language/standard.py":261:15)
#loc363 = loc("/workspace/triton/python/triton/language/standard.py":261:11)
#loc364 = loc("/workspace/triton/python/triton/language/standard.py":261:4)
#loc384 = loc("pid"(#loc2))
#loc385 = loc("num_q_head_blk"(#loc3))
#loc386 = loc("pid_head_kv_split"(#loc4))
#loc387 = loc("pid_head_kv_split"(#loc5))
#loc388 = loc("pid_head_kv_split"(#loc6))
#loc389 = loc("pid_head_kv_split"(#loc7))
#loc390 = loc("cur_head_id"(#loc8))
#loc391 = loc("split_kv_id"(#loc9))
#loc392 = loc("split_kv_id"(#loc10))
#loc393 = loc("cur_batch"(#loc11))
#loc394 = loc("cur_batch"(#loc12))
#loc395 = loc("cur_batch"(#loc13))
#loc396 = loc("cur_batch_kv_start_idx"(#loc14))
#loc397 = loc("cur_batch_kv_start_idx"(#loc15))
#loc398 = loc("cur_batch_kv_end_idx"(#loc16))
#loc399 = loc("cur_batch_kv_end_idx"(#loc17))
#loc400 = loc("cur_batch_kv_end_idx"(#loc18))
#loc401 = loc("smem_q0_nope"(#loc19))
#loc402 = loc("smem_q1_nope"(#loc20))
#loc403 = loc("smem_q_rope"(#loc21))
#loc404 = loc("smem_p"(#loc22))
#loc405 = loc("cur_head"(#loc23))
#loc406 = loc("cur_head"(#loc24))
#loc407 = loc("cur_head"(#loc25))
#loc408 = loc("mask_h"(#loc26))
#loc409 = loc("mask_h"(#loc27))
#loc410 = loc("mask_h"(#loc28))
#loc411 = loc("mask_h"(#loc29))
#loc412 = loc("mask_h"(#loc30))
#loc413 = loc("cur_N"(#loc31))
#loc414 = loc("cur_N_pe"(#loc32))
#loc415 = loc("cur_head_pe"(#loc33))
#loc416 = loc("mask_h_pe"(#loc34))
#loc417 = loc("mask_h_pe"(#loc35))
#loc418 = loc("mask_h_pe"(#loc36))
#loc419 = loc("offs_c"(#loc37))
#loc420 = loc("offs_om"(#loc38))
#loc421 = loc("mask_om"(#loc39))
#loc422 = loc("mask_om"(#loc40))
#loc423 = loc("mask_om"(#loc41))
#loc424 = loc("offs_on"(#loc42))
#loc425 = loc("mask_on"(#loc43))
#loc426 = loc("offs_qk_r"(#loc44))
#loc427 = loc("offs_k_c"(#loc45))
#loc428 = loc("offs_k_r"(#loc46))
#loc429 = loc("cur_batch_seq_len"(#loc47))
#loc430 = loc("cur_batch_block_nums"(#loc48))
#loc431 = loc("off_q_pe"(#loc49))
#loc432 = loc("off_q_pe"(#loc50))
#loc433 = loc("off_q_pe"(#loc51))
#loc434 = loc("off_q_pe"(#loc52))
#loc435 = loc("off_q_pe"(#loc53))
#loc436 = loc("off_q_pe"(#loc54))
#loc437 = loc("offs_q"(#loc55))
#loc438 = loc("offs_q"(#loc56))
#loc439 = loc("offs_q"(#loc57))
#loc440 = loc("offs_q"(#loc58))
#loc441 = loc("offs_q"(#loc59))
#loc442 = loc("offs_q"(#loc60))
#loc443 = loc("mask_c"(#loc61))
#loc444 = loc("mask_k_c"(#loc62))
#loc445 = loc("mask_qk_r"(#loc63))
#loc446 = loc("mask_k_r"(#loc64))
#loc447 = loc("blocks_per_split"(#loc65))
#loc448 = loc("split_kv_start"(#loc66))
#loc449 = loc("split_kv_end"(#loc70))
#loc450 = loc("split_kv_end"(#loc71))
#loc451 = loc("q"(#loc72))
#loc452 = loc("q"(#loc73))
#loc453 = loc("q"(#loc74))
#loc454 = loc("q"(#loc75))
#loc455 = loc("q_pe"(#loc76))
#loc456 = loc("q_pe"(#loc77))
#loc457 = loc("q_pe"(#loc78))
#loc458 = loc("q_pe"(#loc79))
#loc459 = loc("kv_loc"(#loc80))
#loc460 = loc("kv_loc"(#loc81))
#loc461 = loc("kv_loc"(#loc82))
#loc462 = loc("kv_loc"(#loc83))
#loc463 = loc("q"(#loc84))
#loc464 = loc("q"(#loc85))
#loc465 = loc("q0"(#loc89))
#loc466 = loc("q1"(#loc90))
#loc467 = loc("q_pe"(#loc92))
#loc468 = loc("smem_k_rope"(#loc96))
#loc469 = loc("acc1"(#loc97))
#loc470 = loc("acc2"(#loc98))
#loc471 = loc("zeros"(#loc99))
#loc472 = loc("k_id"(#loc100))
#loc473 = loc("k_id"(#loc101))
#loc474 = loc("mask_k_id"(#loc102))
#loc475 = loc("mask_k_id"(#loc103))
#loc476 = loc("mask_k"(#loc104))
#loc477 = loc("offs_buf_kv"(#loc105))
#loc478 = loc("offs_buf_kv"(#loc106))
#loc479 = loc("offs_buf_kv"(#loc107))
#loc480 = loc("offs_buf_kv"(#loc108))
#loc481 = loc("kv1"(#loc109))
#loc482 = loc("kv1"(#loc110))
#loc483 = loc("kv1"(#loc111))
#loc484 = loc("kv1"(#loc112))
#loc485 = loc("kv2"(#loc113))
#loc486 = loc("kv2"(#loc114))
#loc487 = loc("kv2"(#loc115))
#loc488 = loc("kv2"(#loc116))
#loc489 = loc("kv2"(#loc117))
#loc490 = loc("smem_kv1"(#loc118))
#loc491 = loc("smem_kv2"(#loc119))
#loc492 = loc("k_id_pe"(#loc123))
#loc493 = loc("k_id_pe"(#loc124))
#loc494 = loc("offs_buf_k_pe"(#loc125))
#loc495 = loc("offs_buf_k_pe"(#loc126))
#loc496 = loc("offs_buf_k_pe"(#loc127))
#loc497 = loc("offs_buf_k_pe"(#loc128))
#loc498 = loc("mask_k_id"(#loc129))
#loc499 = loc("mask_k_id"(#loc130))
#loc500 = loc("mask_k_pe"(#loc131))
#loc501 = loc("k_pe"(#loc132))
#loc502 = loc("k_pe"(#loc133))
#loc503 = loc("k_pe"(#loc134))
#loc504 = loc("k_pe"(#loc135))
#loc505 = loc("e_sum"(#loc136))
#loc506 = loc("e_sum"(#loc137))
#loc507 = loc("e_sum"(#loc138))
#loc508 = loc("e_max"(#loc139))
#loc509 = loc("cur_k1"(#loc140))
#loc510 = loc("cur_k2"(#loc141))
#loc511 = loc("smem_kv1"(#loc143))
#loc512 = loc("kv1_transpose"(#loc144))
#loc513 = loc("smem_kv2"(#loc147))
#loc514 = loc("kv2_transpose"(#loc148))
#loc515 = loc("split_kv_start"(#loc153))
#loc516 = loc("mask_qk_h"(#loc154))
#loc517 = loc("kv_loc"(#loc155))
#loc518 = loc("kv_loc"(#loc156))
#loc519 = loc("kv_loc"(#loc157))
#loc520 = loc("kv_loc"(#loc158))
#loc521 = loc("kv_loc"(#loc159))
#loc522 = loc("cur_k_pe"(#loc160))
#loc523 = loc("k_id"(#loc162))
#loc524 = loc("k_id"(#loc163))
#loc525 = loc("offs_buf_kv"(#loc164))
#loc526 = loc("offs_buf_kv"(#loc165))
#loc527 = loc("offs_buf_kv"(#loc166))
#loc528 = loc("offs_buf_kv"(#loc167))
#loc529 = loc("mask_k_id"(#loc168))
#loc530 = loc("mask_k_id"(#loc169))
#loc531 = loc("mask_k"(#loc170))
#loc532 = loc("qk"(#loc172))
#loc533 = loc("kv1"(#loc173))
#loc534 = loc("kv1"(#loc174))
#loc535 = loc("kv1"(#loc175))
#loc536 = loc("kv1"(#loc176))
#loc537 = loc("qk"(#loc178))
#loc538 = loc("kv2"(#loc179))
#loc539 = loc("kv2"(#loc180))
#loc540 = loc("kv2"(#loc181))
#loc541 = loc("kv2"(#loc182))
#loc542 = loc("kv2"(#loc183))
#loc543 = loc("cur_k1"(#loc184))
#loc544 = loc("cur_k2"(#loc185))
#loc545 = loc("qk"(#loc186))
#loc546 = loc("qk"(#loc187))
#loc547 = loc("k_id_pe"(#loc188))
#loc548 = loc("k_id_pe"(#loc189))
#loc549 = loc("offs_buf_k_pe"(#loc190))
#loc550 = loc("offs_buf_k_pe"(#loc191))
#loc551 = loc("offs_buf_k_pe"(#loc192))
#loc552 = loc("offs_buf_k_pe"(#loc193))
#loc553 = loc("mask_k_id"(#loc194))
#loc554 = loc("mask_k_id"(#loc195))
#loc555 = loc("mask_k_pe"(#loc196))
#loc556 = loc("k_pe"(#loc198))
#loc557 = loc("k_pe"(#loc199))
#loc558 = loc("k_pe"(#loc200))
#loc559 = loc("k_pe"(#loc201))
#loc560 = loc("n_e_max"(#loc202))
#loc561 = loc("n_e_max"(#loc203))
#loc562 = loc("n_e_max"(#loc204))
#loc563 = loc("re_scale"(#loc205))
#loc564 = loc("re_scale"(#loc206))
#loc565 = loc("re_scale"(#loc207))
#loc566 = loc("p"(#loc208))
#loc567 = loc("p"(#loc209))
#loc568 = loc("p"(#loc210))
#loc569 = loc("p"(#loc211))
#loc570 = loc("cur_p"(#loc215))
#loc571 = loc("smem_kv1"(#loc216))
#loc572 = loc("smem_kv2"(#loc217))
#loc573 = loc("acc1"(#loc219))
#loc574 = loc("acc1"(#loc220))
#loc575 = loc("acc1"(#loc221))
#loc576 = loc("e_sum"(#loc222))
#loc577 = loc("e_sum"(#loc223))
#loc578 = loc("e_sum"(#loc224))
#loc579 = loc("acc2"(#loc226))
#loc580 = loc("acc2"(#loc227))
#loc581 = loc("acc2"(#loc228))
#loc582 = loc("cur_k1"(#loc230))
#loc583 = loc("kv1_transpose"(#loc231))
#loc584 = loc("smem_kv1"(#loc233))
#loc585 = loc("cur_k2"(#loc235))
#loc586 = loc("kv2_transpose"(#loc236))
#loc587 = loc("smem_kv2"(#loc238))
#loc588 = loc("qk"(#loc241))
#loc589 = loc("qk"(#loc242))
#loc590 = loc("cur_k_pe"(#loc243))
#loc591 = loc("qk"(#loc244))
#loc592 = loc("cur_k1"(#loc245))
#loc593 = loc("cur_k2"(#loc246))
#loc594 = loc("qk"(#loc247))
#loc595 = loc("mask_qk_n"(#loc248))
#loc596 = loc("mask_qk_n"(#loc249))
#loc597 = loc("mask_qk_n"(#loc250))
#loc598 = loc("mask_qk_n"(#loc251))
#loc599 = loc("qk"(#loc252))
#loc600 = loc("qk"(#loc253))
#loc601 = loc("qk"(#loc254))
#loc602 = loc("qk"(#loc255))
#loc603 = loc("qk"(#loc256))
#loc604 = loc("qk"(#loc257))
#loc605 = loc("n_e_max"(#loc258))
#loc606 = loc("n_e_max"(#loc259))
#loc607 = loc("n_e_max"(#loc260))
#loc608 = loc("re_scale"(#loc261))
#loc609 = loc("re_scale"(#loc262))
#loc610 = loc("re_scale"(#loc263))
#loc611 = loc("p"(#loc264))
#loc612 = loc("p"(#loc265))
#loc613 = loc("p"(#loc266))
#loc614 = loc("p"(#loc267))
#loc615 = loc("acc1"(#loc270))
#loc616 = loc("acc1"(#loc271))
#loc617 = loc("acc2"(#loc272))
#loc618 = loc("acc2"(#loc273))
#loc619 = loc("e_sum"(#loc274))
#loc620 = loc("e_sum"(#loc275))
#loc621 = loc("e_sum"(#loc276))
#loc622 = loc("cur_p"(#loc278))
#loc623 = loc("acc1"(#loc279))
#loc624 = loc("acc2"(#loc280))
#loc625 = loc("acc"(#loc283))
#loc626 = loc("acc"(#loc284))
#loc627 = loc("acc"(#loc285))
#loc628 = loc("acc"(#loc286))
#loc629 = loc("smem_o"(#loc287))
#loc630 = loc("e_sum"(#loc288))
#loc631 = loc("cur_o"(#loc292))
#loc632 = loc("offs_mid_o"(#loc293))
#loc633 = loc("offs_mid_o"(#loc294))
#loc634 = loc("offs_mid_o"(#loc295))
#loc635 = loc("offs_mid_o"(#loc296))
#loc636 = loc("offs_mid_o"(#loc297))
#loc637 = loc("offs_mid_o"(#loc298))
#loc638 = loc("offs_mid_o"(#loc299))
#loc639 = loc("offs_mid_o"(#loc300))
#loc640 = loc("offs_mid_lse"(#loc305))
#loc641 = loc("offs_mid_lse"(#loc306))
#loc642 = loc("offs_mid_lse"(#loc307))
#loc643 = loc("offs_mid_lse"(#loc308))
#loc644 = loc("offs_mid_lse"(#loc309))
#loc645 = loc("mask_lse"(#loc310))
#loc646 = loc("mask_lse"(#loc311))
#loc647 = loc("mask_lse"(#loc312))
#loc650 = loc("pids_per_xcd"(#loc321))
#loc651 = loc("pids_per_xcd"(#loc322))
#loc652 = loc("pids_per_xcd"(#loc323))
#loc653 = loc("tall_xcds"(#loc324))
#loc654 = loc("tall_xcds"(#loc325))
#loc655 = loc("tall_xcds"(#loc326))
#loc656 = loc("tall_xcds"(#loc327))
#loc657 = loc("xcd"(#loc328))
#loc658 = loc("local_pid"(#loc329))
#loc659 = loc("pid"(#loc332))
#loc660 = loc("pid"(#loc333))
#loc661 = loc("pid"(#loc334))
#loc662 = loc("pid"(#loc335))
#loc663 = loc("pid"(#loc336))
#loc664 = loc("pid"(#loc337))
#loc665 = loc("pid"(#loc338))
#loc666 = loc("pid"(#loc339))
#loc674 = loc("acc1"(#loc517))
#loc675 = loc("pid"(#loc660))
#loc676 = loc("pid"(#loc666))
#loc677 = loc("acc2"(#loc674))
#loc678 = loc("k_id"(#loc677))
#loc679 = loc("mask_k_id"(#loc678))
#loc680 = loc("mask_k"(#loc679))
#loc681 = loc("offs_buf_kv"(#loc680))
#loc682 = loc("kv1"(#loc681))
#loc683 = loc("kv2"(#loc682))
#loc684 = loc("smem_kv1"(#loc683))
#loc685 = loc("smem_kv2"(#loc684))
#loc686 = loc("k_id_pe"(#loc685))
#loc687 = loc("offs_buf_k_pe"(#loc686))
#loc688 = loc("mask_k_pe"(#loc687))
#loc689 = loc("k_pe"(#loc688))
#loc690 = loc("e_sum"(#loc689))
#loc691 = loc("e_max"(#loc690))
#loc692 = loc("cur_k1"(#loc691))
#loc693 = loc("cur_k2"(#loc692))
#loc694 = loc("kv1_transpose"(#loc693))
#loc695 = loc("kv2_transpose"(#loc694))

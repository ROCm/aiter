#blocked = #ttg.blocked<{sizePerThread = [1, 16], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [4, 16], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1, 16], threadsPerWarp = [64, 1], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked3 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked4 = #ttg.blocked<{sizePerThread = [1, 1, 16], threadsPerWarp = [16, 1, 4], warpsPerCTA = [1, 1, 4], order = [2, 1, 0]}>
#blocked5 = #ttg.blocked<{sizePerThread = [1, 16, 1], threadsPerWarp = [16, 4, 1], warpsPerCTA = [1, 4, 1], order = [1, 2, 0]}>
#blocked6 = #ttg.blocked<{sizePerThread = [16, 4], threadsPerWarp = [4, 16], warpsPerCTA = [4, 1], order = [0, 1]}>
#blocked7 = #ttg.blocked<{sizePerThread = [16, 1], threadsPerWarp = [1, 64], warpsPerCTA = [4, 1], order = [0, 1]}>
#linear = #ttg.linear<{register = [[0, 0, 1], [0, 1, 0], [0, 2, 0], [0, 64, 0], [0, 128, 0]], lane = [[1, 0, 0], [2, 0, 0], [4, 0, 0], [8, 0, 0], [0, 4, 0], [0, 8, 0]], warp = [[0, 16, 0], [0, 32, 0]], block = []}>
#linear1 = #ttg.linear<{register = [[0, 1, 0], [0, 0, 1], [0, 0, 2], [0, 0, 64], [0, 0, 128]], lane = [[1, 0, 0], [2, 0, 0], [4, 0, 0], [8, 0, 0], [0, 0, 4], [0, 0, 8]], warp = [[0, 0, 16], [0, 0, 32]], block = []}>
#linear2 = #ttg.linear<{register = [[0, 256], [0, 1], [0, 2], [0, 64], [0, 128]], lane = [[1, 0], [2, 0], [4, 0], [8, 0], [0, 4], [0, 8]], warp = [[0, 16], [0, 32]], block = []}>
#loc = loc(unknown)
#loc1 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":40:0)
#loc309 = loc("/workspace/triton/python/triton/language/standard.py":32:0)
#loc312 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":28:0)
#loc341 = loc("/workspace/triton/python/triton/language/standard.py":175:0)
#loc345 = loc("/workspace/triton/python/triton/language/standard.py":167:0)
#loc349 = loc("/workspace/triton/python/triton/language/standard.py":285:0)
#loc353 = loc("/workspace/triton/python/triton/language/standard.py":260:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [1, 4], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 8, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared2 = #ttg.swizzled_shared<{vec = 16, perPhase = 1, maxPhase = 16, order = [0, 1]}>
#smem = #ttg.shared_memory
#loc357 = loc("Q"(#loc1))
#loc358 = loc("K_Buffer"(#loc1))
#loc359 = loc("V_buffer"(#loc1))
#loc360 = loc("sm_scale"(#loc1))
#loc361 = loc("kv_indptr"(#loc1))
#loc362 = loc("kv_indices"(#loc1))
#loc363 = loc("Att_Out"(#loc1))
#loc364 = loc("Att_Lse"(#loc1))
#loc365 = loc("stride_qb"(#loc1))
#loc366 = loc("stride_qh"(#loc1))
#loc367 = loc("stride_buf_kbs"(#loc1))
#loc368 = loc("stride_buf_kh"(#loc1))
#loc369 = loc("stride_mid_ob"(#loc1))
#loc370 = loc("stride_mid_oh"(#loc1))
#loc371 = loc("stride_mid_os"(#loc1))
#loc372 = loc("stride_mid_lse_b"(#loc1))
#loc373 = loc("stride_mid_lse_h"(#loc1))
#loc374 = loc("stride_mid_lse_s"(#loc1))
#loc375 = loc("stride_b_block_table"(#loc1))
#loc632 = loc("pid"(#loc312))
#loc633 = loc("GRID_MN"(#loc312))
#loc651 = loc("x"(#loc309))
#loc652 = loc("input"(#loc341))
#loc653 = loc("a"(#loc345))
#loc654 = loc("b"(#loc345))
#loc655 = loc("input"(#loc349))
#loc656 = loc("a"(#loc353))
#loc657 = loc("b"(#loc353))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 4 : i32, ttg.target = "hip:gfx950", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @_fwd_grouped_kernel_stage1_n16x4_prefetch_k_paged_64(%Q: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Q"(#loc1)), %K_Buffer: !tt.ptr<bf16> {tt.divisibility = 16 : i32} loc("K_Buffer"(#loc1)), %V_buffer: !tt.ptr<bf16> {tt.divisibility = 16 : i32} loc("V_buffer"(#loc1)), %sm_scale: f32 {tt.divisibility = 16 : i32} loc("sm_scale"(#loc1)), %kv_indptr: !tt.ptr<i32> {tt.divisibility = 16 : i32} loc("kv_indptr"(#loc1)), %kv_indices: !tt.ptr<i32> {tt.divisibility = 16 : i32} loc("kv_indices"(#loc1)), %Att_Out: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("Att_Out"(#loc1)), %Att_Lse: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("Att_Lse"(#loc1)), %stride_qb: i32 {tt.divisibility = 16 : i32} loc("stride_qb"(#loc1)), %stride_qh: i32 {tt.divisibility = 16 : i32} loc("stride_qh"(#loc1)), %stride_buf_kbs: i32 {tt.divisibility = 16 : i32} loc("stride_buf_kbs"(#loc1)), %stride_buf_kh: i32 {tt.divisibility = 16 : i32} loc("stride_buf_kh"(#loc1)), %stride_mid_ob: i32 {tt.divisibility = 16 : i32} loc("stride_mid_ob"(#loc1)), %stride_mid_oh: i32 {tt.divisibility = 16 : i32} loc("stride_mid_oh"(#loc1)), %stride_mid_os: i32 {tt.divisibility = 16 : i32} loc("stride_mid_os"(#loc1)), %stride_mid_lse_b: i32 loc("stride_mid_lse_b"(#loc1)), %stride_mid_lse_h: i32 loc("stride_mid_lse_h"(#loc1)), %stride_mid_lse_s: i32 loc("stride_mid_lse_s"(#loc1)), %stride_b_block_table: i32 loc("stride_b_block_table"(#loc1))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc376)
    %num_q_head_blk = tt.call @"triton.language.standard.cdiv____(0,)cconstexpr_8__(1,)cconstexpr_16_"() : () -> i32 loc(#loc377)
    %pid_head_kv_split = arith.constant 8 : i32 loc(#loc378)
    %pid_head_kv_split_0 = arith.constant 8 : i32 loc(#loc378)
    %pid_head_kv_split_1 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc378)
    %pid_head_kv_split_2 = arith.extsi %pid_head_kv_split_0 : i32 to i64 loc(#loc378)
    %pid_head_kv_split_3 = arith.muli %pid_head_kv_split_1, %pid_head_kv_split_2 : i64 loc(#loc378)
    %pid_head_kv_split_4 = arith.constant 2147483647 : i64 loc(#loc378)
    %pid_head_kv_split_5 = arith.constant -2147483648 : i64 loc(#loc378)
    %pid_head_kv_split_6 = arith.cmpi sle, %pid_head_kv_split_3, %pid_head_kv_split_4 : i64 loc(#loc378)
    %pid_head_kv_split_7 = arith.cmpi sge, %pid_head_kv_split_3, %pid_head_kv_split_5 : i64 loc(#loc378)
    %pid_head_kv_split_8 = arith.andi %pid_head_kv_split_6, %pid_head_kv_split_7 : i1 loc(#loc378)
    %pid_head_kv_split_9 = arith.muli %num_q_head_blk, %pid_head_kv_split_0 : i32 loc(#loc378)
    %pid_head_kv_split_10 = arith.remsi %pid, %pid_head_kv_split_9 : i32 loc(#loc379)
    %pid_head_kv_split_11 = arith.constant 8 : i32 loc(#loc380)
    %pid_head_kv_split_12 = arith.constant 8 : i32 loc(#loc380)
    %pid_head_kv_split_13 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc380)
    %pid_head_kv_split_14 = arith.extsi %pid_head_kv_split_12 : i32 to i64 loc(#loc380)
    %pid_head_kv_split_15 = arith.muli %pid_head_kv_split_13, %pid_head_kv_split_14 : i64 loc(#loc380)
    %pid_head_kv_split_16 = arith.constant 2147483647 : i64 loc(#loc380)
    %pid_head_kv_split_17 = arith.constant -2147483648 : i64 loc(#loc380)
    %pid_head_kv_split_18 = arith.cmpi sle, %pid_head_kv_split_15, %pid_head_kv_split_16 : i64 loc(#loc380)
    %pid_head_kv_split_19 = arith.cmpi sge, %pid_head_kv_split_15, %pid_head_kv_split_17 : i64 loc(#loc380)
    %pid_head_kv_split_20 = arith.andi %pid_head_kv_split_18, %pid_head_kv_split_19 : i1 loc(#loc380)
    %pid_head_kv_split_21 = arith.muli %num_q_head_blk, %pid_head_kv_split_12 : i32 loc(#loc380)
    %pid_head_kv_split_22 = tt.call @"aiter.ops.triton.utils._triton.pid_preprocessing.remap_xcd__i32_i32__(2,)cconstexpr_8_"(%pid_head_kv_split_10, %pid_head_kv_split_21) : (i32, i32) -> i32 loc(#loc381)
    %cur_head_id = arith.remsi %pid_head_kv_split_22, %num_q_head_blk : i32 loc(#loc382)
    %split_kv_id = arith.divsi %pid_head_kv_split_22, %num_q_head_blk : i32 loc(#loc383)
    %split_kv_id_23 = arith.constant 8 : i32 loc(#loc384)
    %split_kv_id_24 = arith.constant 8 : i32 loc(#loc384)
    %split_kv_id_25 = arith.remsi %split_kv_id, %split_kv_id_24 : i32 loc(#loc384)
    %cur_batch = arith.constant 8 : i32 loc(#loc385)
    %cur_batch_26 = arith.constant 8 : i32 loc(#loc385)
    %cur_batch_27 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc385)
    %cur_batch_28 = arith.extsi %cur_batch_26 : i32 to i64 loc(#loc385)
    %cur_batch_29 = arith.muli %cur_batch_27, %cur_batch_28 : i64 loc(#loc385)
    %cur_batch_30 = arith.constant 2147483647 : i64 loc(#loc385)
    %cur_batch_31 = arith.constant -2147483648 : i64 loc(#loc385)
    %cur_batch_32 = arith.cmpi sle, %cur_batch_29, %cur_batch_30 : i64 loc(#loc385)
    %cur_batch_33 = arith.cmpi sge, %cur_batch_29, %cur_batch_31 : i64 loc(#loc385)
    %cur_batch_34 = arith.andi %cur_batch_32, %cur_batch_33 : i1 loc(#loc385)
    %cur_batch_35 = arith.muli %num_q_head_blk, %cur_batch_26 : i32 loc(#loc385)
    %cur_batch_36 = arith.divsi %pid, %cur_batch_35 : i32 loc(#loc386)
    %cur_batch_37 = arith.constant 512 : i32 loc(#loc387)
    %cur_batch_38 = arith.constant 512 : i32 loc(#loc387)
    %cur_batch_39 = arith.remsi %cur_batch_36, %cur_batch_38 : i32 loc(#loc387)
    %kv_indptr_base = tt.addptr %kv_indptr, %cur_batch_39 : !tt.ptr<i32>, i32 loc(#loc388)
    %cur_batch_kv_start_idx = tt.load %kv_indptr_base : !tt.ptr<i32> loc(#loc389)
    %cur_batch_kv_end_idx = arith.constant 1 : i32 loc(#loc390)
    %cur_batch_kv_end_idx_40 = tt.addptr %kv_indptr_base, %cur_batch_kv_end_idx : !tt.ptr<i32>, i32 loc(#loc390)
    %cur_batch_kv_end_idx_41 = tt.load %cur_batch_kv_end_idx_40 : !tt.ptr<i32> loc(#loc391)
    %smem_q0_nope = ttg.local_alloc : () -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc392)
    %smem_q1_nope = ttg.local_alloc : () -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc393)
    %smem_q_rope = ttg.local_alloc : () -> !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc394)
    %smem_p = ttg.local_alloc : () -> !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> loc(#loc395)
    %cur_head = arith.constant 8 : i32 loc(#loc396)
    %cur_head_42 = arith.constant 8 : i32 loc(#loc396)
    %cur_head_43 = arith.extsi %cur_head_id : i32 to i64 loc(#loc396)
    %cur_head_44 = arith.extsi %cur_head_42 : i32 to i64 loc(#loc396)
    %cur_head_45 = arith.muli %cur_head_43, %cur_head_44 : i64 loc(#loc396)
    %cur_head_46 = arith.constant 2147483647 : i64 loc(#loc396)
    %cur_head_47 = arith.constant -2147483648 : i64 loc(#loc396)
    %cur_head_48 = arith.cmpi sle, %cur_head_45, %cur_head_46 : i64 loc(#loc396)
    %cur_head_49 = arith.cmpi sge, %cur_head_45, %cur_head_47 : i64 loc(#loc396)
    %cur_head_50 = arith.andi %cur_head_48, %cur_head_49 : i1 loc(#loc396)
    %cur_head_51 = arith.muli %cur_head_id, %cur_head_42 : i32 loc(#loc396)
    %cur_head_52 = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc397)
    %cur_head_53 = tt.splat %cur_head_51 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_54 = arith.extsi %cur_head_53 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_55 = arith.extsi %cur_head_52 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_56 = arith.addi %cur_head_54, %cur_head_55 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_57 = arith.constant 2147483647 : i64 loc(#loc398)
    %cur_head_58 = arith.constant -2147483648 : i64 loc(#loc398)
    %cur_head_59 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_60 = arith.cmpi sle, %cur_head_56, %cur_head_59 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_61 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_62 = arith.cmpi sge, %cur_head_56, %cur_head_61 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_63 = arith.andi %cur_head_60, %cur_head_62 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %cur_head_64 = arith.addi %cur_head_53, %cur_head_52 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc398)
    %mask_h = arith.constant 1 : i32 loc(#loc399)
    %mask_h_65 = arith.constant 1 : i32 loc(#loc399)
    %mask_h_66 = arith.extsi %cur_head_id : i32 to i64 loc(#loc399)
    %mask_h_67 = arith.extsi %mask_h_65 : i32 to i64 loc(#loc399)
    %mask_h_68 = arith.addi %mask_h_66, %mask_h_67 : i64 loc(#loc399)
    %mask_h_69 = arith.constant 2147483647 : i64 loc(#loc399)
    %mask_h_70 = arith.constant -2147483648 : i64 loc(#loc399)
    %mask_h_71 = arith.cmpi sle, %mask_h_68, %mask_h_69 : i64 loc(#loc399)
    %mask_h_72 = arith.cmpi sge, %mask_h_68, %mask_h_70 : i64 loc(#loc399)
    %mask_h_73 = arith.andi %mask_h_71, %mask_h_72 : i1 loc(#loc399)
    %mask_h_74 = arith.addi %cur_head_id, %mask_h_65 : i32 loc(#loc399)
    %mask_h_75 = arith.constant 8 : i32 loc(#loc400)
    %mask_h_76 = arith.constant 8 : i32 loc(#loc400)
    %mask_h_77 = arith.extsi %mask_h_74 : i32 to i64 loc(#loc400)
    %mask_h_78 = arith.extsi %mask_h_76 : i32 to i64 loc(#loc400)
    %mask_h_79 = arith.muli %mask_h_77, %mask_h_78 : i64 loc(#loc400)
    %mask_h_80 = arith.constant 2147483647 : i64 loc(#loc400)
    %mask_h_81 = arith.constant -2147483648 : i64 loc(#loc400)
    %mask_h_82 = arith.cmpi sle, %mask_h_79, %mask_h_80 : i64 loc(#loc400)
    %mask_h_83 = arith.cmpi sge, %mask_h_79, %mask_h_81 : i64 loc(#loc400)
    %mask_h_84 = arith.andi %mask_h_82, %mask_h_83 : i1 loc(#loc400)
    %mask_h_85 = arith.muli %mask_h_74, %mask_h_76 : i32 loc(#loc400)
    %mask_h_86 = tt.splat %mask_h_85 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc401)
    %mask_h_87 = arith.cmpi slt, %cur_head_64, %mask_h_86 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc401)
    %mask_h_88 = arith.constant 8 : i32 loc(#loc402)
    %mask_h_89 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc402)
    %mask_h_90 = arith.cmpi slt, %cur_head_64, %mask_h_89 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc402)
    %mask_h_91 = arith.andi %mask_h_87, %mask_h_90 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc403)
    %cur_N = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc404)
    %cur_N_pe = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc405)
    %cur_head_pe = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc406)
    %mask_h_pe = arith.constant 8 : i32 loc(#loc407)
    %mask_h_pe_92 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc407)
    %mask_h_pe_93 = arith.cmpi slt, %cur_head_pe, %mask_h_pe_92 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc407)
    %mask_h_pe_94 = arith.constant 8 : i32 loc(#loc408)
    %mask_h_pe_95 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc408)
    %mask_h_pe_96 = arith.cmpi slt, %cur_head_pe, %mask_h_pe_95 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc408)
    %mask_h_pe_97 = arith.andi %mask_h_pe_93, %mask_h_pe_96 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc409)
    %offs_c = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc410)
    %offs_om = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc411)
    %mask_om = arith.constant 8 : i32 loc(#loc412)
    %mask_om_98 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc412)
    %mask_om_99 = arith.cmpi slt, %offs_om, %mask_om_98 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc412)
    %mask_om_100 = arith.constant 8 : i32 loc(#loc413)
    %mask_om_101 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc413)
    %mask_om_102 = arith.cmpi slt, %offs_om, %mask_om_101 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc413)
    %mask_om_103 = arith.andi %mask_om_99, %mask_om_102 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc414)
    %offs_on = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc415)
    %mask_on = arith.constant 512 : i32 loc(#loc416)
    %mask_on_104 = arith.constant dense<512> : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc416)
    %mask_on_105 = arith.cmpi slt, %offs_on, %mask_on_104 : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc416)
    %offs_qk_r = tt.make_range {end = 576 : i32, start = 512 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc417)
    %offs_k_c = tt.make_range {end = 256 : i32, start = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc418)
    %offs_k_r = tt.make_range {end = 576 : i32, start = 512 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc419)
    %cur_batch_seq_len = arith.extsi %cur_batch_kv_end_idx_41 : i32 to i64 loc(#loc420)
    %cur_batch_seq_len_106 = arith.extsi %cur_batch_kv_start_idx : i32 to i64 loc(#loc420)
    %cur_batch_seq_len_107 = arith.subi %cur_batch_seq_len, %cur_batch_seq_len_106 : i64 loc(#loc420)
    %cur_batch_seq_len_108 = arith.constant 2147483647 : i64 loc(#loc420)
    %cur_batch_seq_len_109 = arith.constant -2147483648 : i64 loc(#loc420)
    %cur_batch_seq_len_110 = arith.cmpi sle, %cur_batch_seq_len_107, %cur_batch_seq_len_108 : i64 loc(#loc420)
    %cur_batch_seq_len_111 = arith.cmpi sge, %cur_batch_seq_len_107, %cur_batch_seq_len_109 : i64 loc(#loc420)
    %cur_batch_seq_len_112 = arith.andi %cur_batch_seq_len_110, %cur_batch_seq_len_111 : i1 loc(#loc420)
    %cur_batch_seq_len_113 = arith.subi %cur_batch_kv_end_idx_41, %cur_batch_kv_start_idx : i32 loc(#loc420)
    %cur_batch_block_nums = tt.call @"triton.language.standard.cdiv__i32__(1,)cconstexpr_64_"(%cur_batch_seq_len_113) : (i32) -> i32 loc(#loc421)
    %cur_batch_offset = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc422)
    %cur_batch_offset_114 = arith.extsi %stride_qb : i32 to i64 loc(#loc422)
    %cur_batch_offset_115 = arith.muli %cur_batch_offset, %cur_batch_offset_114 : i64 loc(#loc422)
    %cur_batch_offset_116 = arith.constant 2147483647 : i64 loc(#loc422)
    %cur_batch_offset_117 = arith.constant -2147483648 : i64 loc(#loc422)
    %cur_batch_offset_118 = arith.cmpi sle, %cur_batch_offset_115, %cur_batch_offset_116 : i64 loc(#loc422)
    %cur_batch_offset_119 = arith.cmpi sge, %cur_batch_offset_115, %cur_batch_offset_117 : i64 loc(#loc422)
    %cur_batch_offset_120 = arith.andi %cur_batch_offset_118, %cur_batch_offset_119 : i1 loc(#loc422)
    %cur_batch_offset_121 = arith.muli %cur_batch_39, %stride_qb : i32 loc(#loc422)
    %off_q_pe = tt.expand_dims %cur_head_pe {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<16x1xi32, #blocked3> loc(#loc423)
    %off_q_pe_122 = tt.splat %stride_qh : i32 -> tensor<16x1xi32, #blocked3> loc(#loc424)
    %off_q_pe_123 = arith.extsi %off_q_pe : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_124 = arith.extsi %off_q_pe_122 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_125 = arith.muli %off_q_pe_123, %off_q_pe_124 : tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_126 = arith.constant 2147483647 : i64 loc(#loc424)
    %off_q_pe_127 = arith.constant -2147483648 : i64 loc(#loc424)
    %off_q_pe_128 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_129 = arith.cmpi sle, %off_q_pe_125, %off_q_pe_128 : tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_130 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_131 = arith.cmpi sge, %off_q_pe_125, %off_q_pe_130 : tensor<16x1xi64, #blocked3> loc(#loc424)
    %off_q_pe_132 = arith.andi %off_q_pe_129, %off_q_pe_131 : tensor<16x1xi1, #blocked3> loc(#loc424)
    %off_q_pe_133 = arith.muli %off_q_pe, %off_q_pe_122 : tensor<16x1xi32, #blocked3> loc(#loc424)
    %off_q_pe_134 = tt.splat %cur_batch_offset_121 : i32 -> tensor<16x1xi32, #blocked3> loc(#loc425)
    %off_q_pe_135 = arith.extsi %off_q_pe_134 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_136 = arith.extsi %off_q_pe_133 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_137 = arith.addi %off_q_pe_135, %off_q_pe_136 : tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_138 = arith.constant 2147483647 : i64 loc(#loc425)
    %off_q_pe_139 = arith.constant -2147483648 : i64 loc(#loc425)
    %off_q_pe_140 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_141 = arith.cmpi sle, %off_q_pe_137, %off_q_pe_140 : tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_142 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_143 = arith.cmpi sge, %off_q_pe_137, %off_q_pe_142 : tensor<16x1xi64, #blocked3> loc(#loc425)
    %off_q_pe_144 = arith.andi %off_q_pe_141, %off_q_pe_143 : tensor<16x1xi1, #blocked3> loc(#loc425)
    %off_q_pe_145 = arith.addi %off_q_pe_134, %off_q_pe_133 : tensor<16x1xi32, #blocked3> loc(#loc425)
    %off_q_pe_146 = tt.expand_dims %offs_qk_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> -> tensor<1x64xi32, #blocked3> loc(#loc426)
    %off_q_pe_147 = tt.broadcast %off_q_pe_145 : tensor<16x1xi32, #blocked3> -> tensor<16x64xi32, #blocked3> loc(#loc427)
    %off_q_pe_148 = tt.broadcast %off_q_pe_146 : tensor<1x64xi32, #blocked3> -> tensor<16x64xi32, #blocked3> loc(#loc427)
    %off_q_pe_149 = arith.extsi %off_q_pe_147 : tensor<16x64xi32, #blocked3> to tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_150 = arith.extsi %off_q_pe_148 : tensor<16x64xi32, #blocked3> to tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_151 = arith.addi %off_q_pe_149, %off_q_pe_150 : tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_152 = arith.constant 2147483647 : i64 loc(#loc427)
    %off_q_pe_153 = arith.constant -2147483648 : i64 loc(#loc427)
    %off_q_pe_154 = arith.constant dense<2147483647> : tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_155 = arith.cmpi sle, %off_q_pe_151, %off_q_pe_154 : tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_156 = arith.constant dense<-2147483648> : tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_157 = arith.cmpi sge, %off_q_pe_151, %off_q_pe_156 : tensor<16x64xi64, #blocked3> loc(#loc427)
    %off_q_pe_158 = arith.andi %off_q_pe_155, %off_q_pe_157 : tensor<16x64xi1, #blocked3> loc(#loc427)
    %off_q_pe_159 = arith.addi %off_q_pe_147, %off_q_pe_148 : tensor<16x64xi32, #blocked3> loc(#loc427)
    %offs_q = tt.expand_dims %cur_head_64 {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi32, #blocked> loc(#loc428)
    %offs_q_160 = tt.splat %stride_qh : i32 -> tensor<16x1xi32, #blocked> loc(#loc429)
    %offs_q_161 = arith.extsi %offs_q : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_162 = arith.extsi %offs_q_160 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_163 = arith.muli %offs_q_161, %offs_q_162 : tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_164 = arith.constant 2147483647 : i64 loc(#loc429)
    %offs_q_165 = arith.constant -2147483648 : i64 loc(#loc429)
    %offs_q_166 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_167 = arith.cmpi sle, %offs_q_163, %offs_q_166 : tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_168 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_169 = arith.cmpi sge, %offs_q_163, %offs_q_168 : tensor<16x1xi64, #blocked> loc(#loc429)
    %offs_q_170 = arith.andi %offs_q_167, %offs_q_169 : tensor<16x1xi1, #blocked> loc(#loc429)
    %offs_q_171 = arith.muli %offs_q, %offs_q_160 : tensor<16x1xi32, #blocked> loc(#loc429)
    %offs_q_172 = tt.splat %cur_batch_offset_121 : i32 -> tensor<16x1xi32, #blocked> loc(#loc430)
    %offs_q_173 = arith.extsi %offs_q_172 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_174 = arith.extsi %offs_q_171 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_175 = arith.addi %offs_q_173, %offs_q_174 : tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_176 = arith.constant 2147483647 : i64 loc(#loc430)
    %offs_q_177 = arith.constant -2147483648 : i64 loc(#loc430)
    %offs_q_178 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_179 = arith.cmpi sle, %offs_q_175, %offs_q_178 : tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_180 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_181 = arith.cmpi sge, %offs_q_175, %offs_q_180 : tensor<16x1xi64, #blocked> loc(#loc430)
    %offs_q_182 = arith.andi %offs_q_179, %offs_q_181 : tensor<16x1xi1, #blocked> loc(#loc430)
    %offs_q_183 = arith.addi %offs_q_172, %offs_q_171 : tensor<16x1xi32, #blocked> loc(#loc430)
    %offs_q_184 = tt.expand_dims %offs_c {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc431)
    %offs_q_185 = tt.broadcast %offs_q_183 : tensor<16x1xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc432)
    %offs_q_186 = tt.broadcast %offs_q_184 : tensor<1x512xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc432)
    %offs_q_187 = arith.extsi %offs_q_185 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_188 = arith.extsi %offs_q_186 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_189 = arith.addi %offs_q_187, %offs_q_188 : tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_190 = arith.constant 2147483647 : i64 loc(#loc432)
    %offs_q_191 = arith.constant -2147483648 : i64 loc(#loc432)
    %offs_q_192 = arith.constant dense<2147483647> : tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_193 = arith.cmpi sle, %offs_q_189, %offs_q_192 : tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_194 = arith.constant dense<-2147483648> : tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_195 = arith.cmpi sge, %offs_q_189, %offs_q_194 : tensor<16x512xi64, #blocked> loc(#loc432)
    %offs_q_196 = arith.andi %offs_q_193, %offs_q_195 : tensor<16x512xi1, #blocked> loc(#loc432)
    %offs_q_197 = arith.addi %offs_q_185, %offs_q_186 : tensor<16x512xi32, #blocked> loc(#loc432)
    %mask_c = arith.constant 512 : i32 loc(#loc433)
    %mask_c_198 = arith.constant dense<512> : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc433)
    %mask_c_199 = arith.cmpi slt, %offs_c, %mask_c_198 : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc433)
    %mask_k_c = arith.constant 512 : i32 loc(#loc434)
    %mask_k_c_200 = arith.constant dense<512> : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc434)
    %mask_k_c_201 = arith.cmpi slt, %offs_k_c, %mask_k_c_200 : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc434)
    %mask_qk_r = arith.constant 576 : i32 loc(#loc435)
    %mask_qk_r_202 = arith.constant dense<576> : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc435)
    %mask_qk_r_203 = arith.cmpi slt, %offs_qk_r, %mask_qk_r_202 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc435)
    %mask_k_r = arith.constant 576 : i32 loc(#loc436)
    %mask_k_r_204 = arith.constant dense<576> : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc436)
    %mask_k_r_205 = arith.cmpi slt, %offs_k_r, %mask_k_r_204 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc436)
    %blocks_per_split = tt.call @"triton.language.standard.cdiv__i32__(1,)cconstexpr_8_"(%cur_batch_block_nums) : (i32) -> i32 loc(#loc437)
    %split_kv_start = arith.extsi %blocks_per_split : i32 to i64 loc(#loc438)
    %split_kv_start_206 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc438)
    %split_kv_start_207 = arith.muli %split_kv_start, %split_kv_start_206 : i64 loc(#loc438)
    %split_kv_start_208 = arith.constant 2147483647 : i64 loc(#loc438)
    %split_kv_start_209 = arith.constant -2147483648 : i64 loc(#loc438)
    %split_kv_start_210 = arith.cmpi sle, %split_kv_start_207, %split_kv_start_208 : i64 loc(#loc438)
    %split_kv_start_211 = arith.cmpi sge, %split_kv_start_207, %split_kv_start_209 : i64 loc(#loc438)
    %split_kv_start_212 = arith.andi %split_kv_start_210, %split_kv_start_211 : i1 loc(#loc438)
    %split_kv_start_213 = arith.muli %blocks_per_split, %split_kv_id_25 : i32 loc(#loc438)
    %c64_i32 = arith.constant 64 : i32 loc(#loc65)
    %c64_i32_214 = arith.constant 64 : i32 loc(#loc65)
    %0 = arith.extsi %split_kv_start_213 : i32 to i64 loc(#loc65)
    %1 = arith.extsi %c64_i32_214 : i32 to i64 loc(#loc65)
    %2 = arith.muli %0, %1 : i64 loc(#loc65)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc65)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc65)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc65)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc65)
    %5 = arith.andi %3, %4 : i1 loc(#loc65)
    %6 = arith.muli %split_kv_start_213, %c64_i32_214 : i32 loc(#loc65)
    %7 = arith.cmpi sgt, %6, %cur_batch_seq_len_113 : i32 loc(#loc66)
    cf.cond_br %7, ^bb1, ^bb2 loc(#loc66)
  ^bb1:  // pred: ^bb0
    tt.return loc(#loc67)
  ^bb2:  // pred: ^bb0
    cf.br ^bb4 loc(#loc)
  ^bb3:  // no predecessors
    cf.br ^bb4 loc(#loc)
  ^bb4:  // 2 preds: ^bb2, ^bb3
    %split_kv_end = arith.extsi %split_kv_start_213 : i32 to i64 loc(#loc439)
    %split_kv_end_215 = arith.extsi %blocks_per_split : i32 to i64 loc(#loc439)
    %split_kv_end_216 = arith.addi %split_kv_end, %split_kv_end_215 : i64 loc(#loc439)
    %split_kv_end_217 = arith.constant 2147483647 : i64 loc(#loc439)
    %split_kv_end_218 = arith.constant -2147483648 : i64 loc(#loc439)
    %split_kv_end_219 = arith.cmpi sle, %split_kv_end_216, %split_kv_end_217 : i64 loc(#loc439)
    %split_kv_end_220 = arith.cmpi sge, %split_kv_end_216, %split_kv_end_218 : i64 loc(#loc439)
    %split_kv_end_221 = arith.andi %split_kv_end_219, %split_kv_end_220 : i1 loc(#loc439)
    %split_kv_end_222 = arith.addi %split_kv_start_213, %blocks_per_split : i32 loc(#loc439)
    %split_kv_end_223 = arith.minsi %split_kv_end_222, %cur_batch_block_nums : i32 loc(#loc440)
    %kv_indices_base = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc441)
    %kv_indices_base_224 = arith.extsi %stride_b_block_table : i32 to i64 loc(#loc441)
    %kv_indices_base_225 = arith.muli %kv_indices_base, %kv_indices_base_224 : i64 loc(#loc441)
    %kv_indices_base_226 = arith.constant 2147483647 : i64 loc(#loc441)
    %kv_indices_base_227 = arith.constant -2147483648 : i64 loc(#loc441)
    %kv_indices_base_228 = arith.cmpi sle, %kv_indices_base_225, %kv_indices_base_226 : i64 loc(#loc441)
    %kv_indices_base_229 = arith.cmpi sge, %kv_indices_base_225, %kv_indices_base_227 : i64 loc(#loc441)
    %kv_indices_base_230 = arith.andi %kv_indices_base_228, %kv_indices_base_229 : i1 loc(#loc441)
    %kv_indices_base_231 = arith.muli %cur_batch_39, %stride_b_block_table : i32 loc(#loc441)
    %kv_indices_base_232 = tt.addptr %kv_indices, %kv_indices_base_231 : !tt.ptr<i32>, i32 loc(#loc442)
    %kv_indices_base_233 = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc443)
    %kv_indices_base_234 = arith.extsi %stride_b_block_table : i32 to i64 loc(#loc443)
    %kv_indices_base_235 = arith.muli %kv_indices_base_233, %kv_indices_base_234 : i64 loc(#loc443)
    %kv_indices_base_236 = arith.constant 2147483647 : i64 loc(#loc443)
    %kv_indices_base_237 = arith.constant -2147483648 : i64 loc(#loc443)
    %kv_indices_base_238 = arith.cmpi sle, %kv_indices_base_235, %kv_indices_base_236 : i64 loc(#loc443)
    %kv_indices_base_239 = arith.cmpi sge, %kv_indices_base_235, %kv_indices_base_237 : i64 loc(#loc443)
    %kv_indices_base_240 = arith.andi %kv_indices_base_238, %kv_indices_base_239 : i1 loc(#loc443)
    %kv_indices_base_241 = arith.muli %cur_batch_39, %stride_b_block_table : i32 loc(#loc443)
    %kv_indices_base_242 = tt.addptr %kv_indices, %kv_indices_base_241 : !tt.ptr<i32>, i32 loc(#loc444)
    %q = tt.expand_dims %mask_h_91 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi1, #blocked> loc(#loc445)
    %q_243 = tt.expand_dims %mask_c_199 {axis = 0 : i32} : tensor<512xi1, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi1, #blocked> loc(#loc446)
    %q_244 = tt.broadcast %q : tensor<16x1xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc447)
    %q_245 = tt.broadcast %q_243 : tensor<1x512xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc447)
    %q_246 = arith.andi %q_244, %q_245 : tensor<16x512xi1, #blocked> loc(#loc447)
    %q_247 = amdgpu.buffer_load %Q[%offs_q_197], %q_246 : tensor<16x512xbf16, #blocked> loc(#loc448)
    %q_pe = tt.expand_dims %mask_h_pe_97 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<16x1xi1, #blocked3> loc(#loc449)
    %q_pe_248 = tt.expand_dims %mask_qk_r_203 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked3}>> -> tensor<1x64xi1, #blocked3> loc(#loc450)
    %q_pe_249 = tt.broadcast %q_pe : tensor<16x1xi1, #blocked3> -> tensor<16x64xi1, #blocked3> loc(#loc451)
    %q_pe_250 = tt.broadcast %q_pe_248 : tensor<1x64xi1, #blocked3> -> tensor<16x64xi1, #blocked3> loc(#loc451)
    %q_pe_251 = arith.andi %q_pe_249, %q_pe_250 : tensor<16x64xi1, #blocked3> loc(#loc451)
    %q_pe_252 = amdgpu.buffer_load %Q[%off_q_pe_159], %q_pe_251 : tensor<16x64xbf16, #blocked3> loc(#loc452)
    %kv_loc = tt.addptr %kv_indices_base_242, %split_kv_start_213 : !tt.ptr<i32>, i32 loc(#loc453)
    %kv_loc_253 = tt.load %kv_loc : !tt.ptr<i32> loc(#loc454)
    %q_254 = tt.reshape %q_247 : tensor<16x512xbf16, #blocked> -> tensor<16x2x256xbf16, #blocked4> loc(#loc455)
    %q_255 = tt.trans %q_254 {order = array<i32: 0, 2, 1>} : tensor<16x2x256xbf16, #blocked4> -> tensor<16x256x2xbf16, #blocked5> loc(#loc456)
    %outLHS, %outRHS = tt.split %q_255 : tensor<16x256x2xbf16, #blocked5> -> tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> loc(#loc86)
    ttg.local_store %outLHS, %smem_q0_nope : tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc87)
    ttg.local_store %outRHS, %smem_q1_nope : tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc88)
    %q0 = ttg.local_load %smem_q0_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> -> tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc457)
    %q1 = ttg.local_load %smem_q1_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> -> tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc458)
    ttg.local_store %q_pe_252, %smem_q_rope : tensor<16x64xbf16, #blocked3> -> !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc91)
    %q_pe_256 = ttg.local_load %smem_q_rope : !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc459)
    ttg.local_dealloc %smem_q0_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc93)
    ttg.local_dealloc %smem_q1_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc94)
    ttg.local_dealloc %smem_q_rope : !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc95)
    %smem_k_rope = ttg.local_alloc : () -> !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> loc(#loc460)
    %acc1 = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x256xf32, #mma> loc(#loc461)
    %acc2 = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x256xf32, #mma> loc(#loc462)
    %zeros = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_64__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x64xf32, #mma> loc(#loc463)
    %k_id = arith.constant 64 : i32 loc(#loc464)
    %k_id_257 = arith.constant 64 : i32 loc(#loc464)
    %k_id_258 = arith.extsi %kv_loc_253 : i32 to i64 loc(#loc464)
    %k_id_259 = arith.extsi %k_id_257 : i32 to i64 loc(#loc464)
    %k_id_260 = arith.muli %k_id_258, %k_id_259 : i64 loc(#loc464)
    %k_id_261 = arith.constant 2147483647 : i64 loc(#loc464)
    %k_id_262 = arith.constant -2147483648 : i64 loc(#loc464)
    %k_id_263 = arith.cmpi sle, %k_id_260, %k_id_261 : i64 loc(#loc464)
    %k_id_264 = arith.cmpi sge, %k_id_260, %k_id_262 : i64 loc(#loc464)
    %k_id_265 = arith.andi %k_id_263, %k_id_264 : i1 loc(#loc464)
    %k_id_266 = arith.muli %kv_loc_253, %k_id_257 : i32 loc(#loc464)
    %k_id_267 = tt.splat %k_id_266 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_268 = arith.extsi %k_id_267 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_269 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_270 = arith.addi %k_id_268, %k_id_269 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_271 = arith.constant 2147483647 : i64 loc(#loc465)
    %k_id_272 = arith.constant -2147483648 : i64 loc(#loc465)
    %k_id_273 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_274 = arith.cmpi sle, %k_id_270, %k_id_273 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_275 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_276 = arith.cmpi sge, %k_id_270, %k_id_275 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_277 = arith.andi %k_id_274, %k_id_276 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %k_id_278 = arith.addi %k_id_267, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc465)
    %mask_k_id = arith.constant 64 : i32 loc(#loc466)
    %mask_k_id_279 = arith.constant 64 : i32 loc(#loc466)
    %mask_k_id_280 = arith.extsi %split_kv_start_213 : i32 to i64 loc(#loc466)
    %mask_k_id_281 = arith.extsi %mask_k_id_279 : i32 to i64 loc(#loc466)
    %mask_k_id_282 = arith.muli %mask_k_id_280, %mask_k_id_281 : i64 loc(#loc466)
    %mask_k_id_283 = arith.constant 2147483647 : i64 loc(#loc466)
    %mask_k_id_284 = arith.constant -2147483648 : i64 loc(#loc466)
    %mask_k_id_285 = arith.cmpi sle, %mask_k_id_282, %mask_k_id_283 : i64 loc(#loc466)
    %mask_k_id_286 = arith.cmpi sge, %mask_k_id_282, %mask_k_id_284 : i64 loc(#loc466)
    %mask_k_id_287 = arith.andi %mask_k_id_285, %mask_k_id_286 : i1 loc(#loc466)
    %mask_k_id_288 = arith.muli %split_kv_start_213, %mask_k_id_279 : i32 loc(#loc466)
    %mask_k_id_289 = tt.splat %mask_k_id_288 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_290 = arith.extsi %mask_k_id_289 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_291 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_292 = arith.addi %mask_k_id_290, %mask_k_id_291 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_293 = arith.constant 2147483647 : i64 loc(#loc467)
    %mask_k_id_294 = arith.constant -2147483648 : i64 loc(#loc467)
    %mask_k_id_295 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_296 = arith.cmpi sle, %mask_k_id_292, %mask_k_id_295 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_297 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_298 = arith.cmpi sge, %mask_k_id_292, %mask_k_id_297 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_299 = arith.andi %mask_k_id_296, %mask_k_id_298 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k_id_300 = arith.addi %mask_k_id_289, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc467)
    %mask_k = tt.splat %cur_batch_seq_len_113 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc468)
    %mask_k_301 = arith.cmpi slt, %mask_k_id_300, %mask_k : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc468)
    %offs_buf_kv = tt.expand_dims %k_id_278 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc469)
    %offs_buf_kv_302 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked1> loc(#loc470)
    %offs_buf_kv_303 = arith.extsi %offs_buf_kv : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_304 = arith.extsi %offs_buf_kv_302 : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_305 = arith.muli %offs_buf_kv_303, %offs_buf_kv_304 : tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_306 = arith.constant 2147483647 : i64 loc(#loc470)
    %offs_buf_kv_307 = arith.constant -2147483648 : i64 loc(#loc470)
    %offs_buf_kv_308 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_309 = arith.cmpi sle, %offs_buf_kv_305, %offs_buf_kv_308 : tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_310 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_311 = arith.cmpi sge, %offs_buf_kv_305, %offs_buf_kv_310 : tensor<64x1xi64, #blocked1> loc(#loc470)
    %offs_buf_kv_312 = arith.andi %offs_buf_kv_309, %offs_buf_kv_311 : tensor<64x1xi1, #blocked1> loc(#loc470)
    %offs_buf_kv_313 = arith.muli %offs_buf_kv, %offs_buf_kv_302 : tensor<64x1xi32, #blocked1> loc(#loc470)
    %offs_buf_kv_314 = tt.expand_dims %offs_k_c {axis = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi32, #blocked1> loc(#loc471)
    %offs_buf_kv_315 = tt.broadcast %offs_buf_kv_313 : tensor<64x1xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc472)
    %offs_buf_kv_316 = tt.broadcast %offs_buf_kv_314 : tensor<1x256xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc472)
    %offs_buf_kv_317 = arith.extsi %offs_buf_kv_315 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_318 = arith.extsi %offs_buf_kv_316 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_319 = arith.addi %offs_buf_kv_317, %offs_buf_kv_318 : tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_320 = arith.constant 2147483647 : i64 loc(#loc472)
    %offs_buf_kv_321 = arith.constant -2147483648 : i64 loc(#loc472)
    %offs_buf_kv_322 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_323 = arith.cmpi sle, %offs_buf_kv_319, %offs_buf_kv_322 : tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_324 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_325 = arith.cmpi sge, %offs_buf_kv_319, %offs_buf_kv_324 : tensor<64x256xi64, #blocked1> loc(#loc472)
    %offs_buf_kv_326 = arith.andi %offs_buf_kv_323, %offs_buf_kv_325 : tensor<64x256xi1, #blocked1> loc(#loc472)
    %offs_buf_kv_327 = arith.addi %offs_buf_kv_315, %offs_buf_kv_316 : tensor<64x256xi32, #blocked1> loc(#loc472)
    %mask_k_c_combined = tt.expand_dims %mask_k_301 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi1, #blocked1> loc(#loc473)
    %mask_k_c_combined_328 = tt.expand_dims %mask_k_c_201 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc474)
    %mask_k_c_combined_329 = tt.broadcast %mask_k_c_combined : tensor<64x1xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc475)
    %mask_k_c_combined_330 = tt.broadcast %mask_k_c_combined_328 : tensor<1x256xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc475)
    %mask_k_c_combined_331 = arith.andi %mask_k_c_combined_329, %mask_k_c_combined_330 : tensor<64x256xi1, #blocked1> loc(#loc475)
    %kv1 = amdgpu.buffer_load %K_Buffer[%offs_buf_kv_327], %mask_k_c_combined_331 : tensor<64x256xbf16, #blocked1> loc(#loc476)
    %kv2 = arith.constant 256 : i32 loc(#loc477)
    %kv2_332 = arith.constant 256 : i32 loc(#loc477)
    %kv2_333 = arith.constant dense<256> : tensor<64x256xi32, #blocked1> loc(#loc477)
    %kv2_334 = arith.extsi %offs_buf_kv_327 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_335 = arith.extsi %kv2_333 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_336 = arith.addi %kv2_334, %kv2_335 : tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_337 = arith.constant 2147483647 : i64 loc(#loc477)
    %kv2_338 = arith.constant -2147483648 : i64 loc(#loc477)
    %kv2_339 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_340 = arith.cmpi sle, %kv2_336, %kv2_339 : tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_341 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_342 = arith.cmpi sge, %kv2_336, %kv2_341 : tensor<64x256xi64, #blocked1> loc(#loc477)
    %kv2_343 = arith.andi %kv2_340, %kv2_342 : tensor<64x256xi1, #blocked1> loc(#loc477)
    %kv2_344 = arith.addi %offs_buf_kv_327, %kv2_333 : tensor<64x256xi32, #blocked1> loc(#loc477)
    %kv2_345 = amdgpu.buffer_load %K_Buffer[%kv2_344], %mask_k_c_combined_331 : tensor<64x256xbf16, #blocked1> loc(#loc478)
    %smem_kv1 = ttg.local_alloc : () -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc479)
    %smem_kv2 = ttg.local_alloc : () -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc480)
    rocdl.sched.barrier 0 loc(#loc117)
    %8 = tt.trans %kv1 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc118)
    ttg.local_store %8, %smem_kv1 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc118)
    %9 = tt.trans %kv2_345 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc119)
    ttg.local_store %9, %smem_kv2 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc119)
    %k_id_pe = arith.constant 64 : i32 loc(#loc481)
    %k_id_pe_346 = arith.constant 64 : i32 loc(#loc481)
    %k_id_pe_347 = arith.extsi %kv_loc_253 : i32 to i64 loc(#loc481)
    %k_id_pe_348 = arith.extsi %k_id_pe_346 : i32 to i64 loc(#loc481)
    %k_id_pe_349 = arith.muli %k_id_pe_347, %k_id_pe_348 : i64 loc(#loc481)
    %k_id_pe_350 = arith.constant 2147483647 : i64 loc(#loc481)
    %k_id_pe_351 = arith.constant -2147483648 : i64 loc(#loc481)
    %k_id_pe_352 = arith.cmpi sle, %k_id_pe_349, %k_id_pe_350 : i64 loc(#loc481)
    %k_id_pe_353 = arith.cmpi sge, %k_id_pe_349, %k_id_pe_351 : i64 loc(#loc481)
    %k_id_pe_354 = arith.andi %k_id_pe_352, %k_id_pe_353 : i1 loc(#loc481)
    %k_id_pe_355 = arith.muli %kv_loc_253, %k_id_pe_346 : i32 loc(#loc481)
    %k_id_pe_356 = tt.splat %k_id_pe_355 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_357 = arith.extsi %k_id_pe_356 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_358 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_359 = arith.addi %k_id_pe_357, %k_id_pe_358 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_360 = arith.constant 2147483647 : i64 loc(#loc482)
    %k_id_pe_361 = arith.constant -2147483648 : i64 loc(#loc482)
    %k_id_pe_362 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_363 = arith.cmpi sle, %k_id_pe_359, %k_id_pe_362 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_364 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_365 = arith.cmpi sge, %k_id_pe_359, %k_id_pe_364 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_366 = arith.andi %k_id_pe_363, %k_id_pe_365 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %k_id_pe_367 = arith.addi %k_id_pe_356, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc482)
    %offs_buf_k_pe = tt.expand_dims %k_id_pe_367 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc483)
    %offs_buf_k_pe_368 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked2> loc(#loc484)
    %offs_buf_k_pe_369 = arith.extsi %offs_buf_k_pe : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_370 = arith.extsi %offs_buf_k_pe_368 : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_371 = arith.muli %offs_buf_k_pe_369, %offs_buf_k_pe_370 : tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_372 = arith.constant 2147483647 : i64 loc(#loc484)
    %offs_buf_k_pe_373 = arith.constant -2147483648 : i64 loc(#loc484)
    %offs_buf_k_pe_374 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_375 = arith.cmpi sle, %offs_buf_k_pe_371, %offs_buf_k_pe_374 : tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_376 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_377 = arith.cmpi sge, %offs_buf_k_pe_371, %offs_buf_k_pe_376 : tensor<64x1xi64, #blocked2> loc(#loc484)
    %offs_buf_k_pe_378 = arith.andi %offs_buf_k_pe_375, %offs_buf_k_pe_377 : tensor<64x1xi1, #blocked2> loc(#loc484)
    %offs_buf_k_pe_379 = arith.muli %offs_buf_k_pe, %offs_buf_k_pe_368 : tensor<64x1xi32, #blocked2> loc(#loc484)
    %offs_buf_k_pe_380 = tt.expand_dims %offs_k_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc485)
    %offs_buf_k_pe_381 = tt.broadcast %offs_buf_k_pe_379 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc486)
    %offs_buf_k_pe_382 = tt.broadcast %offs_buf_k_pe_380 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc486)
    %offs_buf_k_pe_383 = arith.extsi %offs_buf_k_pe_381 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_384 = arith.extsi %offs_buf_k_pe_382 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_385 = arith.addi %offs_buf_k_pe_383, %offs_buf_k_pe_384 : tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_386 = arith.constant 2147483647 : i64 loc(#loc486)
    %offs_buf_k_pe_387 = arith.constant -2147483648 : i64 loc(#loc486)
    %offs_buf_k_pe_388 = arith.constant dense<2147483647> : tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_389 = arith.cmpi sle, %offs_buf_k_pe_385, %offs_buf_k_pe_388 : tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_390 = arith.constant dense<-2147483648> : tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_391 = arith.cmpi sge, %offs_buf_k_pe_385, %offs_buf_k_pe_390 : tensor<64x64xi64, #blocked2> loc(#loc486)
    %offs_buf_k_pe_392 = arith.andi %offs_buf_k_pe_389, %offs_buf_k_pe_391 : tensor<64x64xi1, #blocked2> loc(#loc486)
    %offs_buf_k_pe_393 = arith.addi %offs_buf_k_pe_381, %offs_buf_k_pe_382 : tensor<64x64xi32, #blocked2> loc(#loc486)
    %mask_k_id_394 = arith.constant 64 : i32 loc(#loc487)
    %mask_k_id_395 = arith.constant 64 : i32 loc(#loc487)
    %mask_k_id_396 = arith.extsi %split_kv_start_213 : i32 to i64 loc(#loc487)
    %mask_k_id_397 = arith.extsi %mask_k_id_395 : i32 to i64 loc(#loc487)
    %mask_k_id_398 = arith.muli %mask_k_id_396, %mask_k_id_397 : i64 loc(#loc487)
    %mask_k_id_399 = arith.constant 2147483647 : i64 loc(#loc487)
    %mask_k_id_400 = arith.constant -2147483648 : i64 loc(#loc487)
    %mask_k_id_401 = arith.cmpi sle, %mask_k_id_398, %mask_k_id_399 : i64 loc(#loc487)
    %mask_k_id_402 = arith.cmpi sge, %mask_k_id_398, %mask_k_id_400 : i64 loc(#loc487)
    %mask_k_id_403 = arith.andi %mask_k_id_401, %mask_k_id_402 : i1 loc(#loc487)
    %mask_k_id_404 = arith.muli %split_kv_start_213, %mask_k_id_395 : i32 loc(#loc487)
    %mask_k_id_405 = tt.splat %mask_k_id_404 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_406 = arith.extsi %mask_k_id_405 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_407 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_408 = arith.addi %mask_k_id_406, %mask_k_id_407 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_409 = arith.constant 2147483647 : i64 loc(#loc488)
    %mask_k_id_410 = arith.constant -2147483648 : i64 loc(#loc488)
    %mask_k_id_411 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_412 = arith.cmpi sle, %mask_k_id_408, %mask_k_id_411 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_413 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_414 = arith.cmpi sge, %mask_k_id_408, %mask_k_id_413 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_415 = arith.andi %mask_k_id_412, %mask_k_id_414 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_id_416 = arith.addi %mask_k_id_405, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc488)
    %mask_k_pe = tt.splat %cur_batch_seq_len_113 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc489)
    %mask_k_pe_417 = arith.cmpi slt, %mask_k_id_416, %mask_k_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc489)
    %mask_k_r_combined = tt.expand_dims %mask_k_pe_417 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi1, #blocked2> loc(#loc490)
    %mask_k_r_combined_418 = tt.expand_dims %mask_k_r_205 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi1, #blocked2> loc(#loc491)
    %mask_k_r_combined_419 = tt.broadcast %mask_k_r_combined : tensor<64x1xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc492)
    %mask_k_r_combined_420 = tt.broadcast %mask_k_r_combined_418 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc492)
    %mask_k_r_combined_421 = arith.andi %mask_k_r_combined_419, %mask_k_r_combined_420 : tensor<64x64xi1, #blocked2> loc(#loc492)
    %k_pe = amdgpu.buffer_load %K_Buffer[%offs_buf_k_pe_393], %mask_k_r_combined_421 : tensor<64x64xbf16, #blocked2> loc(#loc493)
    %e_sum = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc494)
    %e_sum_422 = arith.sitofp %e_sum : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc495)
    %e_sum_423 = arith.constant 0.000000e+00 : f32 loc(#loc496)
    %e_sum_424 = arith.constant 0.000000e+00 : f32 loc(#loc496)
    %e_sum_425 = arith.constant dense<0.000000e+00> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc496)
    %e_sum_426 = arith.mulf %e_sum_422, %e_sum_425 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc496)
    %e_max = arith.constant 0x7F800000 : f32 loc(#loc497)
    %e_max_427 = arith.constant 0x7F800000 : f32 loc(#loc497)
    %e_max_428 = arith.constant dense<0x7F800000> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc497)
    %e_max_429 = arith.subf %e_sum_426, %e_max_428 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc497)
    %cur_k1 = ttg.local_load %smem_kv1 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc498)
    %cur_k2 = ttg.local_load %smem_kv2 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc499)
    rocdl.sched.barrier 0 loc(#loc139)
    %smem_kv1_430 = ttg.memdesc_reinterpret %smem_kv1 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc500)
    %kv1_transpose = tt.trans %kv1 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc501)
    rocdl.sched.barrier 0 loc(#loc142)
    %10 = tt.trans %kv1_transpose {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc143)
    ttg.local_store %10, %smem_kv1_430 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc143)
    %smem_kv2_431 = ttg.memdesc_reinterpret %smem_kv2 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc502)
    %kv2_transpose = tt.trans %kv2_345 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc503)
    rocdl.sched.barrier 0 loc(#loc146)
    %11 = tt.trans %kv2_transpose {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc147)
    ttg.local_store %11, %smem_kv2_431 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc147)
    %12 = tt.trans %k_pe {order = array<i32: 1, 0>} : tensor<64x64xbf16, #blocked2> -> tensor<64x64xbf16, #blocked7> loc(#loc148)
    ttg.local_store %12, %smem_k_rope : tensor<64x64xbf16, #blocked7> -> !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> loc(#loc148)
    rocdl.sched.barrier 0 loc(#loc149)
    %split_kv_start_432 = arith.constant 1 : i32 loc(#loc504)
    %split_kv_start_433 = arith.constant 1 : i32 loc(#loc504)
    %split_kv_start_434 = arith.extsi %split_kv_start_213 : i32 to i64 loc(#loc504)
    %split_kv_start_435 = arith.extsi %split_kv_start_433 : i32 to i64 loc(#loc504)
    %split_kv_start_436 = arith.addi %split_kv_start_434, %split_kv_start_435 : i64 loc(#loc504)
    %split_kv_start_437 = arith.constant 2147483647 : i64 loc(#loc504)
    %split_kv_start_438 = arith.constant -2147483648 : i64 loc(#loc504)
    %split_kv_start_439 = arith.cmpi sle, %split_kv_start_436, %split_kv_start_437 : i64 loc(#loc504)
    %split_kv_start_440 = arith.cmpi sge, %split_kv_start_436, %split_kv_start_438 : i64 loc(#loc504)
    %split_kv_start_441 = arith.andi %split_kv_start_439, %split_kv_start_440 : i1 loc(#loc504)
    %split_kv_start_442 = arith.addi %split_kv_start_213, %split_kv_start_433 : i32 loc(#loc504)
    %mask_qk_h = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc505)
    %c1_i32 = arith.constant 1 : i32 loc(#loc152)
    %13 = arith.bitcast %split_kv_start_442 : i32 to i32 loc(#loc152)
    %14 = arith.bitcast %split_kv_end_223 : i32 to i32 loc(#loc152)
    %15 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc152)
    %16 = ub.poison : i32 loc(#loc152)
    %kv2_transpose_443:21 = scf.for %start_n = %13 to %14 step %15 iter_args(%kv_loc_675 = %kv_loc_253, %acc1_676 = %acc1, %acc2_677 = %acc2, %k_id_678 = %k_id_278, %mask_k_id_679 = %mask_k_id_416, %mask_k_680 = %mask_k_301, %offs_buf_kv_681 = %offs_buf_kv_327, %kv1_682 = %kv1, %kv2_683 = %kv2_345, %smem_kv1_684 = %smem_kv1_430, %smem_kv2_685 = %smem_kv2_431, %k_id_pe_686 = %k_id_pe_367, %offs_buf_k_pe_687 = %offs_buf_k_pe_393, %mask_k_pe_688 = %mask_k_pe_417, %k_pe_689 = %k_pe, %e_sum_690 = %e_sum_426, %e_max_691 = %e_max_429, %cur_k1_692 = %cur_k1, %cur_k2_693 = %cur_k2, %kv1_transpose_694 = %kv1_transpose, %kv2_transpose_695 = %kv2_transpose) -> (i32, tensor<16x256xf32, #mma>, tensor<16x256xf32, #mma>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64x256xi32, #blocked1>, tensor<64x256xbf16, #blocked1>, tensor<64x256xbf16, #blocked1>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xi32, #blocked2>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xbf16, #blocked2>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #blocked6>, tensor<256x64xbf16, #blocked6>)  : i32 {
      %kv_loc_696 = tt.addptr %kv_indices_base_242, %start_n : !tt.ptr<i32>, i32 loc(#loc507)
      %kv_loc_697 = tt.load %kv_loc_696 : !tt.ptr<i32> loc(#loc508)
      %cur_k_pe_698 = ttg.local_load %smem_k_rope : !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> -> tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc509)
      rocdl.sched.barrier 0 loc(#loc156)
      %k_id_699 = arith.constant 64 : i32 loc(#loc510)
      %k_id_700 = arith.constant 64 : i32 loc(#loc510)
      %k_id_701 = arith.extsi %kv_loc_697 : i32 to i64 loc(#loc510)
      %k_id_702 = arith.extsi %k_id_700 : i32 to i64 loc(#loc510)
      %k_id_703 = arith.muli %k_id_701, %k_id_702 : i64 loc(#loc510)
      %k_id_704 = arith.constant 2147483647 : i64 loc(#loc510)
      %k_id_705 = arith.constant -2147483648 : i64 loc(#loc510)
      %k_id_706 = arith.cmpi sle, %k_id_703, %k_id_704 : i64 loc(#loc510)
      %k_id_707 = arith.cmpi sge, %k_id_703, %k_id_705 : i64 loc(#loc510)
      %k_id_708 = arith.andi %k_id_706, %k_id_707 : i1 loc(#loc510)
      %k_id_709 = arith.muli %kv_loc_697, %k_id_700 : i32 loc(#loc510)
      %k_id_710 = tt.splat %k_id_709 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_711 = arith.extsi %k_id_710 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_712 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_713 = arith.addi %k_id_711, %k_id_712 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_714 = arith.constant 2147483647 : i64 loc(#loc511)
      %k_id_715 = arith.constant -2147483648 : i64 loc(#loc511)
      %k_id_716 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_717 = arith.cmpi sle, %k_id_713, %k_id_716 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_718 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_719 = arith.cmpi sge, %k_id_713, %k_id_718 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_720 = arith.andi %k_id_717, %k_id_719 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %k_id_721 = arith.addi %k_id_710, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc511)
      %offs_buf_kv_722 = tt.expand_dims %k_id_721 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc512)
      %offs_buf_kv_723 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked1> loc(#loc513)
      %offs_buf_kv_724 = arith.extsi %offs_buf_kv_722 : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_725 = arith.extsi %offs_buf_kv_723 : tensor<64x1xi32, #blocked1> to tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_726 = arith.muli %offs_buf_kv_724, %offs_buf_kv_725 : tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_727 = arith.constant 2147483647 : i64 loc(#loc513)
      %offs_buf_kv_728 = arith.constant -2147483648 : i64 loc(#loc513)
      %offs_buf_kv_729 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_730 = arith.cmpi sle, %offs_buf_kv_726, %offs_buf_kv_729 : tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_731 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_732 = arith.cmpi sge, %offs_buf_kv_726, %offs_buf_kv_731 : tensor<64x1xi64, #blocked1> loc(#loc513)
      %offs_buf_kv_733 = arith.andi %offs_buf_kv_730, %offs_buf_kv_732 : tensor<64x1xi1, #blocked1> loc(#loc513)
      %offs_buf_kv_734 = arith.muli %offs_buf_kv_722, %offs_buf_kv_723 : tensor<64x1xi32, #blocked1> loc(#loc513)
      %offs_buf_kv_735 = tt.expand_dims %offs_k_c {axis = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi32, #blocked1> loc(#loc514)
      %offs_buf_kv_736 = tt.broadcast %offs_buf_kv_734 : tensor<64x1xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc515)
      %offs_buf_kv_737 = tt.broadcast %offs_buf_kv_735 : tensor<1x256xi32, #blocked1> -> tensor<64x256xi32, #blocked1> loc(#loc515)
      %offs_buf_kv_738 = arith.extsi %offs_buf_kv_736 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_739 = arith.extsi %offs_buf_kv_737 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_740 = arith.addi %offs_buf_kv_738, %offs_buf_kv_739 : tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_741 = arith.constant 2147483647 : i64 loc(#loc515)
      %offs_buf_kv_742 = arith.constant -2147483648 : i64 loc(#loc515)
      %offs_buf_kv_743 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_744 = arith.cmpi sle, %offs_buf_kv_740, %offs_buf_kv_743 : tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_745 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_746 = arith.cmpi sge, %offs_buf_kv_740, %offs_buf_kv_745 : tensor<64x256xi64, #blocked1> loc(#loc515)
      %offs_buf_kv_747 = arith.andi %offs_buf_kv_744, %offs_buf_kv_746 : tensor<64x256xi1, #blocked1> loc(#loc515)
      %offs_buf_kv_748 = arith.addi %offs_buf_kv_736, %offs_buf_kv_737 : tensor<64x256xi32, #blocked1> loc(#loc515)
      %mask_k_id_749 = arith.constant 64 : i32 loc(#loc516)
      %mask_k_id_750 = arith.constant 64 : i32 loc(#loc516)
      %mask_k_id_751 = arith.extsi %start_n : i32 to i64 loc(#loc516)
      %mask_k_id_752 = arith.extsi %mask_k_id_750 : i32 to i64 loc(#loc516)
      %mask_k_id_753 = arith.muli %mask_k_id_751, %mask_k_id_752 : i64 loc(#loc516)
      %mask_k_id_754 = arith.constant 2147483647 : i64 loc(#loc516)
      %mask_k_id_755 = arith.constant -2147483648 : i64 loc(#loc516)
      %mask_k_id_756 = arith.cmpi sle, %mask_k_id_753, %mask_k_id_754 : i64 loc(#loc516)
      %mask_k_id_757 = arith.cmpi sge, %mask_k_id_753, %mask_k_id_755 : i64 loc(#loc516)
      %mask_k_id_758 = arith.andi %mask_k_id_756, %mask_k_id_757 : i1 loc(#loc516)
      %mask_k_id_759 = arith.muli %start_n, %mask_k_id_750 : i32 loc(#loc516)
      %mask_k_id_760 = tt.splat %mask_k_id_759 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_761 = arith.extsi %mask_k_id_760 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_762 = arith.extsi %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_763 = arith.addi %mask_k_id_761, %mask_k_id_762 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_764 = arith.constant 2147483647 : i64 loc(#loc517)
      %mask_k_id_765 = arith.constant -2147483648 : i64 loc(#loc517)
      %mask_k_id_766 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_767 = arith.cmpi sle, %mask_k_id_763, %mask_k_id_766 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_768 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_769 = arith.cmpi sge, %mask_k_id_763, %mask_k_id_768 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_770 = arith.andi %mask_k_id_767, %mask_k_id_769 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_id_771 = arith.addi %mask_k_id_760, %cur_N : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc517)
      %mask_k_772 = tt.splat %cur_batch_seq_len_113 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc518)
      %mask_k_773 = arith.cmpi slt, %mask_k_id_771, %mask_k_772 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc518)
      %mask_k_combined = tt.expand_dims %mask_k_773 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi1, #blocked1> loc(#loc519)
      %mask_k_combined_774 = tt.expand_dims %mask_k_c_201 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc520)
      %mask_k_combined_775 = tt.broadcast %mask_k_combined : tensor<64x1xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc521)
      %mask_k_combined_776 = tt.broadcast %mask_k_combined_774 : tensor<1x256xi1, #blocked1> -> tensor<64x256xi1, #blocked1> loc(#loc521)
      %mask_k_combined_777 = arith.andi %mask_k_combined_775, %mask_k_combined_776 : tensor<64x256xi1, #blocked1> loc(#loc521)
      rocdl.sched.barrier 0 loc(#loc169)
      %qk_778 = arith.constant 0.000000e+00 : f32 loc(#loc522)
      %qk_779 = tt.dot %q0, %cur_k1_692, %zeros : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc522)
      %kv1_780 = amdgpu.buffer_load %K_Buffer[%offs_buf_kv_748], %mask_k_combined_777 : tensor<64x256xbf16, #blocked1> loc(#loc523)
      rocdl.sched.barrier 0 loc(#loc172)
      %qk_781 = arith.constant 0.000000e+00 : f32 loc(#loc524)
      %qk_782 = tt.dot %q1, %cur_k2_693, %qk_779 : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc524)
      %kv2_783 = arith.constant 256 : i32 loc(#loc525)
      %kv2_784 = arith.constant 256 : i32 loc(#loc525)
      %kv2_785 = arith.constant dense<256> : tensor<64x256xi32, #blocked1> loc(#loc525)
      %kv2_786 = arith.extsi %offs_buf_kv_748 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_787 = arith.extsi %kv2_785 : tensor<64x256xi32, #blocked1> to tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_788 = arith.addi %kv2_786, %kv2_787 : tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_789 = arith.constant 2147483647 : i64 loc(#loc525)
      %kv2_790 = arith.constant -2147483648 : i64 loc(#loc525)
      %kv2_791 = arith.constant dense<2147483647> : tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_792 = arith.cmpi sle, %kv2_788, %kv2_791 : tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_793 = arith.constant dense<-2147483648> : tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_794 = arith.cmpi sge, %kv2_788, %kv2_793 : tensor<64x256xi64, #blocked1> loc(#loc525)
      %kv2_795 = arith.andi %kv2_792, %kv2_794 : tensor<64x256xi1, #blocked1> loc(#loc525)
      %kv2_796 = arith.addi %offs_buf_kv_748, %kv2_785 : tensor<64x256xi32, #blocked1> loc(#loc525)
      %kv2_797 = amdgpu.buffer_load %K_Buffer[%kv2_796], %mask_k_combined_777 : tensor<64x256xbf16, #blocked1> loc(#loc526)
      %cur_k1_798 = ttg.local_load %smem_kv1_684 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc527)
      %cur_k2_799 = ttg.local_load %smem_kv2_685 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc528)
      %qk_800 = arith.constant 0.000000e+00 : f32 loc(#loc529)
      %qk_801 = tt.dot %q_pe_256, %cur_k_pe_698, %qk_782 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc529)
      %qk_802 = tt.splat %sm_scale : f32 -> tensor<16x64xf32, #mma> loc(#loc530)
      %qk_803 = arith.mulf %qk_801, %qk_802 : tensor<16x64xf32, #mma> loc(#loc530)
      %k_id_pe_804 = arith.constant 64 : i32 loc(#loc531)
      %k_id_pe_805 = arith.constant 64 : i32 loc(#loc531)
      %k_id_pe_806 = arith.extsi %kv_loc_697 : i32 to i64 loc(#loc531)
      %k_id_pe_807 = arith.extsi %k_id_pe_805 : i32 to i64 loc(#loc531)
      %k_id_pe_808 = arith.muli %k_id_pe_806, %k_id_pe_807 : i64 loc(#loc531)
      %k_id_pe_809 = arith.constant 2147483647 : i64 loc(#loc531)
      %k_id_pe_810 = arith.constant -2147483648 : i64 loc(#loc531)
      %k_id_pe_811 = arith.cmpi sle, %k_id_pe_808, %k_id_pe_809 : i64 loc(#loc531)
      %k_id_pe_812 = arith.cmpi sge, %k_id_pe_808, %k_id_pe_810 : i64 loc(#loc531)
      %k_id_pe_813 = arith.andi %k_id_pe_811, %k_id_pe_812 : i1 loc(#loc531)
      %k_id_pe_814 = arith.muli %kv_loc_697, %k_id_pe_805 : i32 loc(#loc531)
      %k_id_pe_815 = tt.splat %k_id_pe_814 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_816 = arith.extsi %k_id_pe_815 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_817 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_818 = arith.addi %k_id_pe_816, %k_id_pe_817 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_819 = arith.constant 2147483647 : i64 loc(#loc532)
      %k_id_pe_820 = arith.constant -2147483648 : i64 loc(#loc532)
      %k_id_pe_821 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_822 = arith.cmpi sle, %k_id_pe_818, %k_id_pe_821 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_823 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_824 = arith.cmpi sge, %k_id_pe_818, %k_id_pe_823 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_825 = arith.andi %k_id_pe_822, %k_id_pe_824 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %k_id_pe_826 = arith.addi %k_id_pe_815, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc532)
      %offs_buf_k_pe_827 = tt.expand_dims %k_id_pe_826 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc533)
      %offs_buf_k_pe_828 = tt.splat %stride_buf_kh : i32 -> tensor<64x1xi32, #blocked2> loc(#loc534)
      %offs_buf_k_pe_829 = arith.extsi %offs_buf_k_pe_827 : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_830 = arith.extsi %offs_buf_k_pe_828 : tensor<64x1xi32, #blocked2> to tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_831 = arith.muli %offs_buf_k_pe_829, %offs_buf_k_pe_830 : tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_832 = arith.constant 2147483647 : i64 loc(#loc534)
      %offs_buf_k_pe_833 = arith.constant -2147483648 : i64 loc(#loc534)
      %offs_buf_k_pe_834 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_835 = arith.cmpi sle, %offs_buf_k_pe_831, %offs_buf_k_pe_834 : tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_836 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_837 = arith.cmpi sge, %offs_buf_k_pe_831, %offs_buf_k_pe_836 : tensor<64x1xi64, #blocked2> loc(#loc534)
      %offs_buf_k_pe_838 = arith.andi %offs_buf_k_pe_835, %offs_buf_k_pe_837 : tensor<64x1xi1, #blocked2> loc(#loc534)
      %offs_buf_k_pe_839 = arith.muli %offs_buf_k_pe_827, %offs_buf_k_pe_828 : tensor<64x1xi32, #blocked2> loc(#loc534)
      %offs_buf_k_pe_840 = tt.expand_dims %offs_k_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc535)
      %offs_buf_k_pe_841 = tt.broadcast %offs_buf_k_pe_839 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc536)
      %offs_buf_k_pe_842 = tt.broadcast %offs_buf_k_pe_840 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc536)
      %offs_buf_k_pe_843 = arith.extsi %offs_buf_k_pe_841 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_844 = arith.extsi %offs_buf_k_pe_842 : tensor<64x64xi32, #blocked2> to tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_845 = arith.addi %offs_buf_k_pe_843, %offs_buf_k_pe_844 : tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_846 = arith.constant 2147483647 : i64 loc(#loc536)
      %offs_buf_k_pe_847 = arith.constant -2147483648 : i64 loc(#loc536)
      %offs_buf_k_pe_848 = arith.constant dense<2147483647> : tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_849 = arith.cmpi sle, %offs_buf_k_pe_845, %offs_buf_k_pe_848 : tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_850 = arith.constant dense<-2147483648> : tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_851 = arith.cmpi sge, %offs_buf_k_pe_845, %offs_buf_k_pe_850 : tensor<64x64xi64, #blocked2> loc(#loc536)
      %offs_buf_k_pe_852 = arith.andi %offs_buf_k_pe_849, %offs_buf_k_pe_851 : tensor<64x64xi1, #blocked2> loc(#loc536)
      %offs_buf_k_pe_853 = arith.addi %offs_buf_k_pe_841, %offs_buf_k_pe_842 : tensor<64x64xi32, #blocked2> loc(#loc536)
      %mask_k_id_854 = arith.constant 64 : i32 loc(#loc537)
      %mask_k_id_855 = arith.constant 64 : i32 loc(#loc537)
      %mask_k_id_856 = arith.extsi %start_n : i32 to i64 loc(#loc537)
      %mask_k_id_857 = arith.extsi %mask_k_id_855 : i32 to i64 loc(#loc537)
      %mask_k_id_858 = arith.muli %mask_k_id_856, %mask_k_id_857 : i64 loc(#loc537)
      %mask_k_id_859 = arith.constant 2147483647 : i64 loc(#loc537)
      %mask_k_id_860 = arith.constant -2147483648 : i64 loc(#loc537)
      %mask_k_id_861 = arith.cmpi sle, %mask_k_id_858, %mask_k_id_859 : i64 loc(#loc537)
      %mask_k_id_862 = arith.cmpi sge, %mask_k_id_858, %mask_k_id_860 : i64 loc(#loc537)
      %mask_k_id_863 = arith.andi %mask_k_id_861, %mask_k_id_862 : i1 loc(#loc537)
      %mask_k_id_864 = arith.muli %start_n, %mask_k_id_855 : i32 loc(#loc537)
      %mask_k_id_865 = tt.splat %mask_k_id_864 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_866 = arith.extsi %mask_k_id_865 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_867 = arith.extsi %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_868 = arith.addi %mask_k_id_866, %mask_k_id_867 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_869 = arith.constant 2147483647 : i64 loc(#loc538)
      %mask_k_id_870 = arith.constant -2147483648 : i64 loc(#loc538)
      %mask_k_id_871 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_872 = arith.cmpi sle, %mask_k_id_868, %mask_k_id_871 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_873 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_874 = arith.cmpi sge, %mask_k_id_868, %mask_k_id_873 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_875 = arith.andi %mask_k_id_872, %mask_k_id_874 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_id_876 = arith.addi %mask_k_id_865, %cur_N_pe : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc538)
      %mask_k_pe_877 = tt.splat %cur_batch_seq_len_113 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc539)
      %mask_k_pe_878 = arith.cmpi slt, %mask_k_id_876, %mask_k_pe_877 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc539)
      %mask_k_pe_combined = tt.expand_dims %mask_k_pe_878 {axis = 1 : i32} : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi1, #blocked2> loc(#loc540)
      %mask_k_pe_combined_879 = tt.expand_dims %mask_k_r_205 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi1, #blocked2> loc(#loc541)
      %mask_k_pe_combined_880 = tt.broadcast %mask_k_pe_combined : tensor<64x1xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc542)
      %mask_k_pe_combined_881 = tt.broadcast %mask_k_pe_combined_879 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc542)
      %mask_k_pe_combined_882 = arith.andi %mask_k_pe_combined_880, %mask_k_pe_combined_881 : tensor<64x64xi1, #blocked2> loc(#loc542)
      rocdl.sched.barrier 0 loc(#loc192)
      %k_pe_883 = amdgpu.buffer_load %K_Buffer[%offs_buf_k_pe_853], %mask_k_pe_combined_882 : tensor<64x64xbf16, #blocked2> loc(#loc543)
      %n_e_max_884 = tt.call @"triton.language.standard.max__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%qk_803) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc544)
      %n_e_max_885 = ttg.convert_layout %n_e_max_884 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc545)
      %n_e_max_886 = arith.maxnumf %n_e_max_885, %e_max_691 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc546)
      %re_scale_887 = arith.subf %e_max_691, %n_e_max_886 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc547)
      %re_scale_888 = arith.constant 1.44269502 : f32 loc(#loc548)
      %re_scale_889 = arith.constant 1.44269502 : f32 loc(#loc548)
      %re_scale_890 = arith.constant dense<1.44269502> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc548)
      %re_scale_891 = arith.mulf %re_scale_887, %re_scale_890 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc548)
      %re_scale_892 = math.exp2 %re_scale_891 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc549)
      %p_893 = tt.expand_dims %n_e_max_886 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc550)
      %p_894 = tt.broadcast %p_893 : tensor<16x1xf32, #mma> -> tensor<16x64xf32, #mma> loc(#loc551)
      %p_895 = arith.subf %qk_803, %p_894 : tensor<16x64xf32, #mma> loc(#loc551)
      %p_896 = arith.constant 1.44269502 : f32 loc(#loc552)
      %p_897 = arith.constant 1.44269502 : f32 loc(#loc552)
      %p_898 = arith.constant dense<1.44269502> : tensor<16x64xf32, #mma> loc(#loc552)
      %p_899 = arith.mulf %p_895, %p_898 : tensor<16x64xf32, #mma> loc(#loc552)
      %p_900 = math.exp2 %p_899 : tensor<16x64xf32, #mma> loc(#loc553)
      %28 = arith.truncf %p_900 : tensor<16x64xf32, #mma> to tensor<16x64xbf16, #mma> loc(#loc204)
      ttg.local_store %28, %smem_p : tensor<16x64xbf16, #mma> -> !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> loc(#loc205)
      rocdl.sched.barrier 0 loc(#loc206)
      %cur_p_901 = ttg.local_load %smem_p : !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc554)
      %smem_kv1_902 = ttg.memdesc_reinterpret %smem_kv1_684 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc555)
      %smem_kv2_903 = ttg.memdesc_reinterpret %smem_kv2_685 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc556)
      %29 = tt.trans %kv1_780 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc210)
      ttg.local_store %29, %smem_kv1_902 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc210)
      %acc1_904 = tt.expand_dims %re_scale_892 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc557)
      %acc1_905 = tt.broadcast %acc1_904 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc558)
      %acc1_906 = arith.mulf %acc1_676, %acc1_905 : tensor<16x256xf32, #mma> loc(#loc558)
      %acc1_907 = arith.constant 0.000000e+00 : f32 loc(#loc559)
      %acc1_908 = tt.dot %cur_p_901, %cur_k1_798, %acc1_906 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc559)
      %e_sum_909 = arith.mulf %e_sum_690, %re_scale_892 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc560)
      %e_sum_910 = tt.call @"triton.language.standard.sum__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%p_900) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc561)
      %e_sum_911 = arith.addf %e_sum_909, %e_sum_910 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc562)
      %30 = tt.trans %kv2_797 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc217)
      ttg.local_store %30, %smem_kv2_903 : tensor<256x64xbf16, #blocked6> -> !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> loc(#loc217)
      %acc2_912 = tt.expand_dims %re_scale_892 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc563)
      %acc2_913 = tt.broadcast %acc2_912 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc564)
      %acc2_914 = arith.mulf %acc2_677, %acc2_913 : tensor<16x256xf32, #mma> loc(#loc564)
      %acc2_915 = arith.constant 0.000000e+00 : f32 loc(#loc565)
      %acc2_916 = tt.dot %cur_p_901, %cur_k2_799, %acc2_914 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc565)
      %31 = tt.trans %k_pe_883 {order = array<i32: 1, 0>} : tensor<64x64xbf16, #blocked2> -> tensor<64x64xbf16, #blocked7> loc(#loc221)
      ttg.local_store %31, %smem_k_rope : tensor<64x64xbf16, #blocked7> -> !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> loc(#loc221)
      %cur_k1_917 = ttg.local_load %smem_kv1_902 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc566)
      %kv1_transpose_918 = tt.trans %kv1_780 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc567)
      rocdl.sched.barrier 0 loc(#loc224)
      %smem_kv1_919 = ttg.memdesc_reinterpret %smem_kv1_902 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc568)
      %32 = tt.trans %kv1_transpose_918 {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc226)
      ttg.local_store %32, %smem_kv1_919 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc226)
      %cur_k2_920 = ttg.local_load %smem_kv2_903 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc569)
      %kv2_transpose_921 = tt.trans %kv2_797 {order = array<i32: 1, 0>} : tensor<64x256xbf16, #blocked1> -> tensor<256x64xbf16, #blocked6> loc(#loc570)
      rocdl.sched.barrier 0 loc(#loc229)
      %smem_kv2_922 = ttg.memdesc_reinterpret %smem_kv2_903 : !ttg.memdesc<256x64xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc571)
      %33 = tt.trans %kv2_transpose_921 {order = array<i32: 1, 0>} : tensor<256x64xbf16, #blocked6> -> tensor<64x256xbf16, #blocked1> loc(#loc231)
      ttg.local_store %33, %smem_kv2_922 : tensor<64x256xbf16, #blocked1> -> !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc231)
      scf.yield %kv_loc_697, %acc1_908, %acc2_916, %k_id_721, %mask_k_id_876, %mask_k_773, %offs_buf_kv_748, %kv1_780, %kv2_797, %smem_kv1_919, %smem_kv2_922, %k_id_pe_826, %offs_buf_k_pe_853, %mask_k_pe_878, %k_pe_883, %e_sum_911, %n_e_max_886, %cur_k1_917, %cur_k2_920, %kv1_transpose_918, %kv2_transpose_921 : i32, tensor<16x256xf32, #mma>, tensor<16x256xf32, #mma>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<64x256xi32, #blocked1>, tensor<64x256xbf16, #blocked1>, tensor<64x256xbf16, #blocked1>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xi32, #blocked2>, tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<64x64xbf16, #blocked2>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x64xbf16, #blocked6>, tensor<256x64xbf16, #blocked6> loc(#loc232)
    } loc(#loc679)
    %qk = arith.constant 0.000000e+00 : f32 loc(#loc572)
    %qk_444 = tt.dot %q0, %kv2_transpose_443#17, %zeros : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc572)
    %qk_445 = arith.constant 0.000000e+00 : f32 loc(#loc573)
    %qk_446 = tt.dot %q1, %kv2_transpose_443#18, %qk_444 : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc573)
    %cur_k_pe = ttg.local_load %smem_k_rope : !ttg.memdesc<64x64xbf16, #shared2, #smem, mutable> -> tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc574)
    %qk_447 = arith.constant 0.000000e+00 : f32 loc(#loc575)
    %qk_448 = tt.dot %q_pe_256, %cur_k_pe, %qk_446 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x64xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x64xf32, #mma> loc(#loc575)
    %cur_k1_449 = ttg.local_load %kv2_transpose_443#9 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc576)
    %cur_k2_450 = ttg.local_load %kv2_transpose_443#10 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> -> tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc577)
    %qk_451 = tt.splat %sm_scale : f32 -> tensor<16x64xf32, #mma> loc(#loc578)
    %qk_452 = arith.mulf %qk_448, %qk_451 : tensor<16x64xf32, #mma> loc(#loc578)
    %mask_qk_n = arith.constant 1 : i32 loc(#loc579)
    %mask_qk_n_453 = arith.constant 1 : i32 loc(#loc579)
    %mask_qk_n_454 = arith.extsi %split_kv_end_223 : i32 to i64 loc(#loc579)
    %mask_qk_n_455 = arith.extsi %mask_qk_n_453 : i32 to i64 loc(#loc579)
    %mask_qk_n_456 = arith.subi %mask_qk_n_454, %mask_qk_n_455 : i64 loc(#loc579)
    %mask_qk_n_457 = arith.constant 2147483647 : i64 loc(#loc579)
    %mask_qk_n_458 = arith.constant -2147483648 : i64 loc(#loc579)
    %mask_qk_n_459 = arith.cmpi sle, %mask_qk_n_456, %mask_qk_n_457 : i64 loc(#loc579)
    %mask_qk_n_460 = arith.cmpi sge, %mask_qk_n_456, %mask_qk_n_458 : i64 loc(#loc579)
    %mask_qk_n_461 = arith.andi %mask_qk_n_459, %mask_qk_n_460 : i1 loc(#loc579)
    %mask_qk_n_462 = arith.subi %split_kv_end_223, %mask_qk_n_453 : i32 loc(#loc579)
    %mask_qk_n_463 = arith.constant 64 : i32 loc(#loc580)
    %mask_qk_n_464 = arith.constant 64 : i32 loc(#loc580)
    %mask_qk_n_465 = arith.extsi %mask_qk_n_462 : i32 to i64 loc(#loc580)
    %mask_qk_n_466 = arith.extsi %mask_qk_n_464 : i32 to i64 loc(#loc580)
    %mask_qk_n_467 = arith.muli %mask_qk_n_465, %mask_qk_n_466 : i64 loc(#loc580)
    %mask_qk_n_468 = arith.constant 2147483647 : i64 loc(#loc580)
    %mask_qk_n_469 = arith.constant -2147483648 : i64 loc(#loc580)
    %mask_qk_n_470 = arith.cmpi sle, %mask_qk_n_467, %mask_qk_n_468 : i64 loc(#loc580)
    %mask_qk_n_471 = arith.cmpi sge, %mask_qk_n_467, %mask_qk_n_469 : i64 loc(#loc580)
    %mask_qk_n_472 = arith.andi %mask_qk_n_470, %mask_qk_n_471 : i1 loc(#loc580)
    %mask_qk_n_473 = arith.muli %mask_qk_n_462, %mask_qk_n_464 : i32 loc(#loc580)
    %mask_qk_n_474 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc581)
    %mask_qk_n_475 = tt.splat %mask_qk_n_473 : i32 -> tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_476 = arith.extsi %mask_qk_n_475 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_477 = arith.extsi %mask_qk_n_474 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_478 = arith.addi %mask_qk_n_476, %mask_qk_n_477 : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_479 = arith.constant 2147483647 : i64 loc(#loc582)
    %mask_qk_n_480 = arith.constant -2147483648 : i64 loc(#loc582)
    %mask_qk_n_481 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_482 = arith.cmpi sle, %mask_qk_n_478, %mask_qk_n_481 : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_483 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_484 = arith.cmpi sge, %mask_qk_n_478, %mask_qk_n_483 : tensor<64xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_485 = arith.andi %mask_qk_n_482, %mask_qk_n_484 : tensor<64xi1, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %mask_qk_n_486 = arith.addi %mask_qk_n_475, %mask_qk_n_474 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc582)
    %qk_487 = tt.expand_dims %mask_qk_n_486 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x64xi32, #mma> loc(#loc583)
    %qk_488 = tt.splat %cur_batch_seq_len_113 : i32 -> tensor<1x64xi32, #mma> loc(#loc584)
    %qk_489 = arith.cmpi slt, %qk_487, %qk_488 : tensor<1x64xi32, #mma> loc(#loc584)
    %qk_490 = tt.expand_dims %mask_qk_h {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xi32, #mma> loc(#loc585)
    %qk_491 = arith.constant 0 : i32 loc(#loc586)
    %qk_492 = arith.constant dense<0> : tensor<16x1xi32, #mma> loc(#loc586)
    %qk_493 = arith.cmpi sge, %qk_490, %qk_492 : tensor<16x1xi32, #mma> loc(#loc586)
    %qk_494 = tt.broadcast %qk_489 : tensor<1x64xi1, #mma> -> tensor<16x64xi1, #mma> loc(#loc587)
    %qk_495 = tt.broadcast %qk_493 : tensor<16x1xi1, #mma> -> tensor<16x64xi1, #mma> loc(#loc587)
    %qk_496 = arith.andi %qk_494, %qk_495 : tensor<16x64xi1, #mma> loc(#loc587)
    %qk_497 = arith.constant 0xFF800000 : f32 loc(#loc588)
    %qk_498 = arith.constant 0xFF800000 : f32 loc(#loc588)
    %qk_499 = arith.constant dense<0xFF800000> : tensor<16x64xf32, #mma> loc(#loc588)
    %qk_500 = arith.select %qk_496, %qk_452, %qk_499 : tensor<16x64xi1, #mma>, tensor<16x64xf32, #mma> loc(#loc588)
    %n_e_max = tt.call @"triton.language.standard.max__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%qk_500) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc589)
    %n_e_max_501 = ttg.convert_layout %n_e_max : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc590)
    %n_e_max_502 = arith.maxnumf %n_e_max_501, %kv2_transpose_443#16 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc591)
    %re_scale = arith.subf %kv2_transpose_443#16, %n_e_max_502 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc592)
    %re_scale_503 = arith.constant 1.44269502 : f32 loc(#loc593)
    %re_scale_504 = arith.constant 1.44269502 : f32 loc(#loc593)
    %re_scale_505 = arith.constant dense<1.44269502> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc593)
    %re_scale_506 = arith.mulf %re_scale, %re_scale_505 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc593)
    %re_scale_507 = math.exp2 %re_scale_506 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc594)
    %p = tt.expand_dims %n_e_max_502 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc595)
    %p_508 = tt.broadcast %p : tensor<16x1xf32, #mma> -> tensor<16x64xf32, #mma> loc(#loc596)
    %p_509 = arith.subf %qk_500, %p_508 : tensor<16x64xf32, #mma> loc(#loc596)
    %p_510 = arith.constant 1.44269502 : f32 loc(#loc597)
    %p_511 = arith.constant 1.44269502 : f32 loc(#loc597)
    %p_512 = arith.constant dense<1.44269502> : tensor<16x64xf32, #mma> loc(#loc597)
    %p_513 = arith.mulf %p_509, %p_512 : tensor<16x64xf32, #mma> loc(#loc597)
    %p_514 = math.exp2 %p_513 : tensor<16x64xf32, #mma> loc(#loc598)
    %17 = arith.truncf %p_514 : tensor<16x64xf32, #mma> to tensor<16x64xbf16, #mma> loc(#loc260)
    ttg.local_store %17, %smem_p : tensor<16x64xbf16, #mma> -> !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> loc(#loc261)
    %acc1_515 = tt.expand_dims %re_scale_507 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc599)
    %acc1_516 = tt.broadcast %acc1_515 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc600)
    %acc1_517 = arith.mulf %kv2_transpose_443#1, %acc1_516 : tensor<16x256xf32, #mma> loc(#loc600)
    %acc2_518 = tt.expand_dims %re_scale_507 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc601)
    %acc2_519 = tt.broadcast %acc2_518 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc602)
    %acc2_520 = arith.mulf %kv2_transpose_443#2, %acc2_519 : tensor<16x256xf32, #mma> loc(#loc602)
    %e_sum_521 = arith.mulf %kv2_transpose_443#15, %re_scale_507 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc603)
    %e_sum_522 = tt.call @"triton.language.standard.sum__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%p_514) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc604)
    %e_sum_523 = arith.addf %e_sum_521, %e_sum_522 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc605)
    rocdl.sched.barrier 0 loc(#loc269)
    %cur_p = ttg.local_load %smem_p : !ttg.memdesc<16x64xbf16, #shared1, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc606)
    %acc1_524 = arith.constant 0.000000e+00 : f32 loc(#loc607)
    %acc1_525 = tt.dot %cur_p, %cur_k1_449, %acc1_517 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc607)
    %acc2_526 = arith.constant 0.000000e+00 : f32 loc(#loc608)
    %acc2_527 = tt.dot %cur_p, %cur_k2_450, %acc2_520 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x256xf32, #mma> loc(#loc608)
    ttg.local_dealloc %kv2_transpose_443#9 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc273)
    ttg.local_dealloc %kv2_transpose_443#10 : !ttg.memdesc<64x256xbf16, #shared2, #smem, mutable> loc(#loc274)
    %acc = tt.join %acc1_525, %acc2_527 : tensor<16x256xf32, #mma> -> tensor<16x256x2xf32, #linear> loc(#loc609)
    %acc_528 = tt.trans %acc {order = array<i32: 0, 2, 1>} : tensor<16x256x2xf32, #linear> -> tensor<16x2x256xf32, #linear1> loc(#loc610)
    %acc_529 = tt.reshape %acc_528 : tensor<16x2x256xf32, #linear1> -> tensor<16x512xf32, #linear2> loc(#loc611)
    %acc_530 = ttg.convert_layout %acc_529 : tensor<16x512xf32, #linear2> -> tensor<16x512xf32, #mma> loc(#loc612)
    %smem_o = ttg.local_alloc : () -> !ttg.memdesc<16x512xf32, #shared, #smem, mutable> loc(#loc613)
    %e_sum_531 = arith.constant 1 : i32 loc(#loc614)
    %e_sum_532 = arith.constant 1.000000e+00 : f32 loc(#loc614)
    %e_sum_533 = arith.constant dense<1.000000e+00> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc614)
    %e_sum_534 = arith.divf %e_sum_533, %e_sum_523 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc614)
    %18 = tt.expand_dims %e_sum_534 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc281)
    %19 = tt.broadcast %18 : tensor<16x1xf32, #mma> -> tensor<16x512xf32, #mma> loc(#loc282)
    %20 = arith.mulf %acc_530, %19 : tensor<16x512xf32, #mma> loc(#loc282)
    ttg.local_store %20, %smem_o : tensor<16x512xf32, #mma> -> !ttg.memdesc<16x512xf32, #shared, #smem, mutable> loc(#loc283)
    %cur_o = ttg.local_load %smem_o : !ttg.memdesc<16x512xf32, #shared, #smem, mutable> -> tensor<16x512xf32, #blocked> loc(#loc615)
    %cur_batch_out_offset = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc616)
    %cur_batch_out_offset_535 = arith.extsi %stride_mid_ob : i32 to i64 loc(#loc616)
    %cur_batch_out_offset_536 = arith.muli %cur_batch_out_offset, %cur_batch_out_offset_535 : i64 loc(#loc616)
    %cur_batch_out_offset_537 = arith.constant 2147483647 : i64 loc(#loc616)
    %cur_batch_out_offset_538 = arith.constant -2147483648 : i64 loc(#loc616)
    %cur_batch_out_offset_539 = arith.cmpi sle, %cur_batch_out_offset_536, %cur_batch_out_offset_537 : i64 loc(#loc616)
    %cur_batch_out_offset_540 = arith.cmpi sge, %cur_batch_out_offset_536, %cur_batch_out_offset_538 : i64 loc(#loc616)
    %cur_batch_out_offset_541 = arith.andi %cur_batch_out_offset_539, %cur_batch_out_offset_540 : i1 loc(#loc616)
    %cur_batch_out_offset_542 = arith.muli %cur_batch_39, %stride_mid_ob : i32 loc(#loc616)
    %cur_batch_out_offset_543 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc617)
    %cur_batch_out_offset_544 = arith.extsi %stride_mid_os : i32 to i64 loc(#loc617)
    %cur_batch_out_offset_545 = arith.muli %cur_batch_out_offset_543, %cur_batch_out_offset_544 : i64 loc(#loc617)
    %cur_batch_out_offset_546 = arith.constant 2147483647 : i64 loc(#loc617)
    %cur_batch_out_offset_547 = arith.constant -2147483648 : i64 loc(#loc617)
    %cur_batch_out_offset_548 = arith.cmpi sle, %cur_batch_out_offset_545, %cur_batch_out_offset_546 : i64 loc(#loc617)
    %cur_batch_out_offset_549 = arith.cmpi sge, %cur_batch_out_offset_545, %cur_batch_out_offset_547 : i64 loc(#loc617)
    %cur_batch_out_offset_550 = arith.andi %cur_batch_out_offset_548, %cur_batch_out_offset_549 : i1 loc(#loc617)
    %cur_batch_out_offset_551 = arith.muli %split_kv_id_25, %stride_mid_os : i32 loc(#loc617)
    %cur_batch_out_offset_552 = arith.extsi %cur_batch_out_offset_542 : i32 to i64 loc(#loc618)
    %cur_batch_out_offset_553 = arith.extsi %cur_batch_out_offset_551 : i32 to i64 loc(#loc618)
    %cur_batch_out_offset_554 = arith.addi %cur_batch_out_offset_552, %cur_batch_out_offset_553 : i64 loc(#loc618)
    %cur_batch_out_offset_555 = arith.constant 2147483647 : i64 loc(#loc618)
    %cur_batch_out_offset_556 = arith.constant -2147483648 : i64 loc(#loc618)
    %cur_batch_out_offset_557 = arith.cmpi sle, %cur_batch_out_offset_554, %cur_batch_out_offset_555 : i64 loc(#loc618)
    %cur_batch_out_offset_558 = arith.cmpi sge, %cur_batch_out_offset_554, %cur_batch_out_offset_556 : i64 loc(#loc618)
    %cur_batch_out_offset_559 = arith.andi %cur_batch_out_offset_557, %cur_batch_out_offset_558 : i1 loc(#loc618)
    %cur_batch_out_offset_560 = arith.addi %cur_batch_out_offset_542, %cur_batch_out_offset_551 : i32 loc(#loc618)
    %offs_mid_o = tt.expand_dims %cur_head_64 {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi32, #blocked> loc(#loc619)
    %offs_mid_o_561 = tt.splat %stride_mid_oh : i32 -> tensor<16x1xi32, #blocked> loc(#loc620)
    %offs_mid_o_562 = arith.extsi %offs_mid_o : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_563 = arith.extsi %offs_mid_o_561 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_564 = arith.muli %offs_mid_o_562, %offs_mid_o_563 : tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_565 = arith.constant 2147483647 : i64 loc(#loc620)
    %offs_mid_o_566 = arith.constant -2147483648 : i64 loc(#loc620)
    %offs_mid_o_567 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_568 = arith.cmpi sle, %offs_mid_o_564, %offs_mid_o_567 : tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_569 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_570 = arith.cmpi sge, %offs_mid_o_564, %offs_mid_o_569 : tensor<16x1xi64, #blocked> loc(#loc620)
    %offs_mid_o_571 = arith.andi %offs_mid_o_568, %offs_mid_o_570 : tensor<16x1xi1, #blocked> loc(#loc620)
    %offs_mid_o_572 = arith.muli %offs_mid_o, %offs_mid_o_561 : tensor<16x1xi32, #blocked> loc(#loc620)
    %offs_mid_o_573 = tt.splat %cur_batch_out_offset_560 : i32 -> tensor<16x1xi32, #blocked> loc(#loc621)
    %offs_mid_o_574 = arith.extsi %offs_mid_o_573 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_575 = arith.extsi %offs_mid_o_572 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_576 = arith.addi %offs_mid_o_574, %offs_mid_o_575 : tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_577 = arith.constant 2147483647 : i64 loc(#loc621)
    %offs_mid_o_578 = arith.constant -2147483648 : i64 loc(#loc621)
    %offs_mid_o_579 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_580 = arith.cmpi sle, %offs_mid_o_576, %offs_mid_o_579 : tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_581 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_582 = arith.cmpi sge, %offs_mid_o_576, %offs_mid_o_581 : tensor<16x1xi64, #blocked> loc(#loc621)
    %offs_mid_o_583 = arith.andi %offs_mid_o_580, %offs_mid_o_582 : tensor<16x1xi1, #blocked> loc(#loc621)
    %offs_mid_o_584 = arith.addi %offs_mid_o_573, %offs_mid_o_572 : tensor<16x1xi32, #blocked> loc(#loc621)
    %offs_mid_o_585 = tt.expand_dims %offs_c {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc622)
    %offs_mid_o_586 = tt.broadcast %offs_mid_o_584 : tensor<16x1xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc623)
    %offs_mid_o_587 = tt.broadcast %offs_mid_o_585 : tensor<1x512xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc623)
    %offs_mid_o_588 = arith.extsi %offs_mid_o_586 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_589 = arith.extsi %offs_mid_o_587 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_590 = arith.addi %offs_mid_o_588, %offs_mid_o_589 : tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_591 = arith.constant 2147483647 : i64 loc(#loc623)
    %offs_mid_o_592 = arith.constant -2147483648 : i64 loc(#loc623)
    %offs_mid_o_593 = arith.constant dense<2147483647> : tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_594 = arith.cmpi sle, %offs_mid_o_590, %offs_mid_o_593 : tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_595 = arith.constant dense<-2147483648> : tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_596 = arith.cmpi sge, %offs_mid_o_590, %offs_mid_o_595 : tensor<16x512xi64, #blocked> loc(#loc623)
    %offs_mid_o_597 = arith.andi %offs_mid_o_594, %offs_mid_o_596 : tensor<16x512xi1, #blocked> loc(#loc623)
    %offs_mid_o_598 = arith.addi %offs_mid_o_586, %offs_mid_o_587 : tensor<16x512xi32, #blocked> loc(#loc623)
    %21 = tt.expand_dims %mask_h_91 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi1, #blocked> loc(#loc293)
    %22 = tt.expand_dims %mask_c_199 {axis = 0 : i32} : tensor<512xi1, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi1, #blocked> loc(#loc294)
    %23 = tt.broadcast %21 : tensor<16x1xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc295)
    %24 = tt.broadcast %22 : tensor<1x512xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc295)
    %25 = arith.andi %23, %24 : tensor<16x512xi1, #blocked> loc(#loc295)
    amdgpu.buffer_store %cur_o, %Att_Out[%offs_mid_o_598], %25 : tensor<16x512xf32, #blocked> loc(#loc296)
    %offs_mid_lse = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc624)
    %offs_mid_lse_599 = arith.extsi %stride_mid_lse_b : i32 to i64 loc(#loc624)
    %offs_mid_lse_600 = arith.muli %offs_mid_lse, %offs_mid_lse_599 : i64 loc(#loc624)
    %offs_mid_lse_601 = arith.constant 2147483647 : i64 loc(#loc624)
    %offs_mid_lse_602 = arith.constant -2147483648 : i64 loc(#loc624)
    %offs_mid_lse_603 = arith.cmpi sle, %offs_mid_lse_600, %offs_mid_lse_601 : i64 loc(#loc624)
    %offs_mid_lse_604 = arith.cmpi sge, %offs_mid_lse_600, %offs_mid_lse_602 : i64 loc(#loc624)
    %offs_mid_lse_605 = arith.andi %offs_mid_lse_603, %offs_mid_lse_604 : i1 loc(#loc624)
    %offs_mid_lse_606 = arith.muli %cur_batch_39, %stride_mid_lse_b : i32 loc(#loc624)
    %offs_mid_lse_607 = tt.splat %stride_mid_lse_h : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_608 = arith.extsi %offs_om : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_609 = arith.extsi %offs_mid_lse_607 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_610 = arith.muli %offs_mid_lse_608, %offs_mid_lse_609 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_611 = arith.constant 2147483647 : i64 loc(#loc625)
    %offs_mid_lse_612 = arith.constant -2147483648 : i64 loc(#loc625)
    %offs_mid_lse_613 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_614 = arith.cmpi sle, %offs_mid_lse_610, %offs_mid_lse_613 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_615 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_616 = arith.cmpi sge, %offs_mid_lse_610, %offs_mid_lse_615 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_617 = arith.andi %offs_mid_lse_614, %offs_mid_lse_616 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_618 = arith.muli %offs_om, %offs_mid_lse_607 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc625)
    %offs_mid_lse_619 = tt.splat %offs_mid_lse_606 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_620 = arith.extsi %offs_mid_lse_619 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_621 = arith.extsi %offs_mid_lse_618 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_622 = arith.addi %offs_mid_lse_620, %offs_mid_lse_621 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_623 = arith.constant 2147483647 : i64 loc(#loc626)
    %offs_mid_lse_624 = arith.constant -2147483648 : i64 loc(#loc626)
    %offs_mid_lse_625 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_626 = arith.cmpi sle, %offs_mid_lse_622, %offs_mid_lse_625 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_627 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_628 = arith.cmpi sge, %offs_mid_lse_622, %offs_mid_lse_627 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_629 = arith.andi %offs_mid_lse_626, %offs_mid_lse_628 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_630 = arith.addi %offs_mid_lse_619, %offs_mid_lse_618 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc626)
    %offs_mid_lse_631 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc627)
    %offs_mid_lse_632 = arith.extsi %stride_mid_lse_s : i32 to i64 loc(#loc627)
    %offs_mid_lse_633 = arith.muli %offs_mid_lse_631, %offs_mid_lse_632 : i64 loc(#loc627)
    %offs_mid_lse_634 = arith.constant 2147483647 : i64 loc(#loc627)
    %offs_mid_lse_635 = arith.constant -2147483648 : i64 loc(#loc627)
    %offs_mid_lse_636 = arith.cmpi sle, %offs_mid_lse_633, %offs_mid_lse_634 : i64 loc(#loc627)
    %offs_mid_lse_637 = arith.cmpi sge, %offs_mid_lse_633, %offs_mid_lse_635 : i64 loc(#loc627)
    %offs_mid_lse_638 = arith.andi %offs_mid_lse_636, %offs_mid_lse_637 : i1 loc(#loc627)
    %offs_mid_lse_639 = arith.muli %split_kv_id_25, %stride_mid_lse_s : i32 loc(#loc627)
    %offs_mid_lse_640 = tt.splat %offs_mid_lse_639 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_641 = arith.extsi %offs_mid_lse_630 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_642 = arith.extsi %offs_mid_lse_640 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_643 = arith.addi %offs_mid_lse_641, %offs_mid_lse_642 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_644 = arith.constant 2147483647 : i64 loc(#loc628)
    %offs_mid_lse_645 = arith.constant -2147483648 : i64 loc(#loc628)
    %offs_mid_lse_646 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_647 = arith.cmpi sle, %offs_mid_lse_643, %offs_mid_lse_646 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_648 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_649 = arith.cmpi sge, %offs_mid_lse_643, %offs_mid_lse_648 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_650 = arith.andi %offs_mid_lse_647, %offs_mid_lse_649 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %offs_mid_lse_651 = arith.addi %offs_mid_lse_630, %offs_mid_lse_640 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc628)
    %mask_lse = arith.constant 1 : i32 loc(#loc629)
    %mask_lse_652 = arith.constant 1 : i32 loc(#loc629)
    %mask_lse_653 = arith.extsi %cur_head_id : i32 to i64 loc(#loc629)
    %mask_lse_654 = arith.extsi %mask_lse_652 : i32 to i64 loc(#loc629)
    %mask_lse_655 = arith.addi %mask_lse_653, %mask_lse_654 : i64 loc(#loc629)
    %mask_lse_656 = arith.constant 2147483647 : i64 loc(#loc629)
    %mask_lse_657 = arith.constant -2147483648 : i64 loc(#loc629)
    %mask_lse_658 = arith.cmpi sle, %mask_lse_655, %mask_lse_656 : i64 loc(#loc629)
    %mask_lse_659 = arith.cmpi sge, %mask_lse_655, %mask_lse_657 : i64 loc(#loc629)
    %mask_lse_660 = arith.andi %mask_lse_658, %mask_lse_659 : i1 loc(#loc629)
    %mask_lse_661 = arith.addi %cur_head_id, %mask_lse_652 : i32 loc(#loc629)
    %mask_lse_662 = arith.constant 8 : i32 loc(#loc630)
    %mask_lse_663 = arith.constant 8 : i32 loc(#loc630)
    %mask_lse_664 = arith.extsi %mask_lse_661 : i32 to i64 loc(#loc630)
    %mask_lse_665 = arith.extsi %mask_lse_663 : i32 to i64 loc(#loc630)
    %mask_lse_666 = arith.muli %mask_lse_664, %mask_lse_665 : i64 loc(#loc630)
    %mask_lse_667 = arith.constant 2147483647 : i64 loc(#loc630)
    %mask_lse_668 = arith.constant -2147483648 : i64 loc(#loc630)
    %mask_lse_669 = arith.cmpi sle, %mask_lse_666, %mask_lse_667 : i64 loc(#loc630)
    %mask_lse_670 = arith.cmpi sge, %mask_lse_666, %mask_lse_668 : i64 loc(#loc630)
    %mask_lse_671 = arith.andi %mask_lse_669, %mask_lse_670 : i1 loc(#loc630)
    %mask_lse_672 = arith.muli %mask_lse_661, %mask_lse_663 : i32 loc(#loc630)
    %mask_lse_673 = tt.splat %mask_lse_672 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc631)
    %mask_lse_674 = arith.cmpi slt, %offs_om, %mask_lse_673 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc631)
    %26 = math.log %e_sum_534 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc305)
    %27 = arith.subf %n_e_max_502, %26 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc306)
    amdgpu.buffer_store %27, %Att_Lse[%offs_mid_lse_651], %mask_lse_674 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc307)
    tt.return loc(#loc308)
  } loc(#loc1)
  tt.func private @"triton.language.standard.cdiv____(0,)cconstexpr_8__(1,)cconstexpr_16_"() -> i32 attributes {noinline = false} {
    %c1_i32 = arith.constant 1 : i32 loc(#loc310)
    tt.return %c1_i32 : i32 loc(#loc310)
  ^bb1:  // no predecessors
    %0 = ub.poison : i32 loc(#loc311)
    tt.return %0 : i32 loc(#loc311)
  } loc(#loc309)
  tt.func private @"aiter.ops.triton.utils._triton.pid_preprocessing.remap_xcd__i32_i32__(2,)cconstexpr_8_"(%pid: i32 loc("pid"(#loc312)), %GRID_MN: i32 loc("GRID_MN"(#loc312))) -> i32 attributes {noinline = false} {
    %pids_per_xcd = arith.constant 8 : i32 loc(#loc634)
    %pids_per_xcd_0 = arith.constant 8 : i32 loc(#loc634)
    %pids_per_xcd_1 = arith.extsi %GRID_MN : i32 to i64 loc(#loc634)
    %pids_per_xcd_2 = arith.extsi %pids_per_xcd_0 : i32 to i64 loc(#loc634)
    %pids_per_xcd_3 = arith.addi %pids_per_xcd_1, %pids_per_xcd_2 : i64 loc(#loc634)
    %pids_per_xcd_4 = arith.constant 2147483647 : i64 loc(#loc634)
    %pids_per_xcd_5 = arith.constant -2147483648 : i64 loc(#loc634)
    %pids_per_xcd_6 = arith.cmpi sle, %pids_per_xcd_3, %pids_per_xcd_4 : i64 loc(#loc634)
    %pids_per_xcd_7 = arith.cmpi sge, %pids_per_xcd_3, %pids_per_xcd_5 : i64 loc(#loc634)
    %pids_per_xcd_8 = arith.andi %pids_per_xcd_6, %pids_per_xcd_7 : i1 loc(#loc634)
    %pids_per_xcd_9 = arith.addi %GRID_MN, %pids_per_xcd_0 : i32 loc(#loc634)
    %pids_per_xcd_10 = arith.constant 1 : i32 loc(#loc635)
    %pids_per_xcd_11 = arith.constant 1 : i32 loc(#loc635)
    %pids_per_xcd_12 = arith.extsi %pids_per_xcd_9 : i32 to i64 loc(#loc635)
    %pids_per_xcd_13 = arith.extsi %pids_per_xcd_11 : i32 to i64 loc(#loc635)
    %pids_per_xcd_14 = arith.subi %pids_per_xcd_12, %pids_per_xcd_13 : i64 loc(#loc635)
    %pids_per_xcd_15 = arith.constant 2147483647 : i64 loc(#loc635)
    %pids_per_xcd_16 = arith.constant -2147483648 : i64 loc(#loc635)
    %pids_per_xcd_17 = arith.cmpi sle, %pids_per_xcd_14, %pids_per_xcd_15 : i64 loc(#loc635)
    %pids_per_xcd_18 = arith.cmpi sge, %pids_per_xcd_14, %pids_per_xcd_16 : i64 loc(#loc635)
    %pids_per_xcd_19 = arith.andi %pids_per_xcd_17, %pids_per_xcd_18 : i1 loc(#loc635)
    %pids_per_xcd_20 = arith.subi %pids_per_xcd_9, %pids_per_xcd_11 : i32 loc(#loc635)
    %pids_per_xcd_21 = arith.constant 8 : i32 loc(#loc636)
    %pids_per_xcd_22 = arith.constant 8 : i32 loc(#loc636)
    %pids_per_xcd_23 = arith.divsi %pids_per_xcd_20, %pids_per_xcd_22 : i32 loc(#loc636)
    %tall_xcds = arith.constant 8 : i32 loc(#loc637)
    %tall_xcds_24 = arith.constant 8 : i32 loc(#loc637)
    %tall_xcds_25 = arith.remsi %GRID_MN, %tall_xcds_24 : i32 loc(#loc637)
    %tall_xcds_26 = arith.constant 0 : i32 loc(#loc638)
    %tall_xcds_27 = arith.cmpi eq, %tall_xcds_25, %tall_xcds_26 : i32 loc(#loc638)
    %tall_xcds_28 = scf.if %tall_xcds_27 -> (i32) {
      %tall_xcds_33 = arith.constant 8 : i32 loc(#loc640)
      scf.yield %tall_xcds_33 : i32 loc(#loc640)
    } else {
      scf.yield %tall_xcds_25 : i32 loc(#loc)
    } loc(#loc639)
    %xcd = arith.constant 8 : i32 loc(#loc641)
    %xcd_29 = arith.constant 8 : i32 loc(#loc641)
    %xcd_30 = arith.remsi %pid, %xcd_29 : i32 loc(#loc641)
    %local_pid = arith.constant 8 : i32 loc(#loc642)
    %local_pid_31 = arith.constant 8 : i32 loc(#loc642)
    %local_pid_32 = arith.divsi %pid, %local_pid_31 : i32 loc(#loc642)
    %0 = arith.cmpi slt, %xcd_30, %tall_xcds_28 : i32 loc(#loc322)
    %1 = scf.if %0 -> (i32) {
      %pid_33 = arith.extsi %xcd_30 : i32 to i64 loc(#loc643)
      %pid_34 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc643)
      %pid_35 = arith.muli %pid_33, %pid_34 : i64 loc(#loc643)
      %pid_36 = arith.constant 2147483647 : i64 loc(#loc643)
      %pid_37 = arith.constant -2147483648 : i64 loc(#loc643)
      %pid_38 = arith.cmpi sle, %pid_35, %pid_36 : i64 loc(#loc643)
      %pid_39 = arith.cmpi sge, %pid_35, %pid_37 : i64 loc(#loc643)
      %pid_40 = arith.andi %pid_38, %pid_39 : i1 loc(#loc643)
      %pid_41 = arith.muli %xcd_30, %pids_per_xcd_23 : i32 loc(#loc643)
      %pid_42 = arith.extsi %pid_41 : i32 to i64 loc(#loc644)
      %pid_43 = arith.extsi %local_pid_32 : i32 to i64 loc(#loc644)
      %pid_44 = arith.addi %pid_42, %pid_43 : i64 loc(#loc644)
      %pid_45 = arith.constant 2147483647 : i64 loc(#loc644)
      %pid_46 = arith.constant -2147483648 : i64 loc(#loc644)
      %pid_47 = arith.cmpi sle, %pid_44, %pid_45 : i64 loc(#loc644)
      %pid_48 = arith.cmpi sge, %pid_44, %pid_46 : i64 loc(#loc644)
      %pid_49 = arith.andi %pid_47, %pid_48 : i1 loc(#loc644)
      %pid_50 = arith.addi %pid_41, %local_pid_32 : i32 loc(#loc659)
      scf.yield %pid_50 : i32 loc(#loc659)
    } else {
      %pid_33 = arith.extsi %tall_xcds_28 : i32 to i64 loc(#loc645)
      %pid_34 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc645)
      %pid_35 = arith.muli %pid_33, %pid_34 : i64 loc(#loc645)
      %pid_36 = arith.constant 2147483647 : i64 loc(#loc645)
      %pid_37 = arith.constant -2147483648 : i64 loc(#loc645)
      %pid_38 = arith.cmpi sle, %pid_35, %pid_36 : i64 loc(#loc645)
      %pid_39 = arith.cmpi sge, %pid_35, %pid_37 : i64 loc(#loc645)
      %pid_40 = arith.andi %pid_38, %pid_39 : i1 loc(#loc645)
      %pid_41 = arith.muli %tall_xcds_28, %pids_per_xcd_23 : i32 loc(#loc645)
      %pid_42 = arith.extsi %xcd_30 : i32 to i64 loc(#loc646)
      %pid_43 = arith.extsi %tall_xcds_28 : i32 to i64 loc(#loc646)
      %pid_44 = arith.subi %pid_42, %pid_43 : i64 loc(#loc646)
      %pid_45 = arith.constant 2147483647 : i64 loc(#loc646)
      %pid_46 = arith.constant -2147483648 : i64 loc(#loc646)
      %pid_47 = arith.cmpi sle, %pid_44, %pid_45 : i64 loc(#loc646)
      %pid_48 = arith.cmpi sge, %pid_44, %pid_46 : i64 loc(#loc646)
      %pid_49 = arith.andi %pid_47, %pid_48 : i1 loc(#loc646)
      %pid_50 = arith.subi %xcd_30, %tall_xcds_28 : i32 loc(#loc646)
      %pid_51 = arith.constant 1 : i32 loc(#loc647)
      %pid_52 = arith.constant 1 : i32 loc(#loc647)
      %pid_53 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc647)
      %pid_54 = arith.extsi %pid_52 : i32 to i64 loc(#loc647)
      %pid_55 = arith.subi %pid_53, %pid_54 : i64 loc(#loc647)
      %pid_56 = arith.constant 2147483647 : i64 loc(#loc647)
      %pid_57 = arith.constant -2147483648 : i64 loc(#loc647)
      %pid_58 = arith.cmpi sle, %pid_55, %pid_56 : i64 loc(#loc647)
      %pid_59 = arith.cmpi sge, %pid_55, %pid_57 : i64 loc(#loc647)
      %pid_60 = arith.andi %pid_58, %pid_59 : i1 loc(#loc647)
      %pid_61 = arith.subi %pids_per_xcd_23, %pid_52 : i32 loc(#loc647)
      %pid_62 = arith.extsi %pid_50 : i32 to i64 loc(#loc648)
      %pid_63 = arith.extsi %pid_61 : i32 to i64 loc(#loc648)
      %pid_64 = arith.muli %pid_62, %pid_63 : i64 loc(#loc648)
      %pid_65 = arith.constant 2147483647 : i64 loc(#loc648)
      %pid_66 = arith.constant -2147483648 : i64 loc(#loc648)
      %pid_67 = arith.cmpi sle, %pid_64, %pid_65 : i64 loc(#loc648)
      %pid_68 = arith.cmpi sge, %pid_64, %pid_66 : i64 loc(#loc648)
      %pid_69 = arith.andi %pid_67, %pid_68 : i1 loc(#loc648)
      %pid_70 = arith.muli %pid_50, %pid_61 : i32 loc(#loc648)
      %pid_71 = arith.extsi %pid_41 : i32 to i64 loc(#loc649)
      %pid_72 = arith.extsi %pid_70 : i32 to i64 loc(#loc649)
      %pid_73 = arith.addi %pid_71, %pid_72 : i64 loc(#loc649)
      %pid_74 = arith.constant 2147483647 : i64 loc(#loc649)
      %pid_75 = arith.constant -2147483648 : i64 loc(#loc649)
      %pid_76 = arith.cmpi sle, %pid_73, %pid_74 : i64 loc(#loc649)
      %pid_77 = arith.cmpi sge, %pid_73, %pid_75 : i64 loc(#loc649)
      %pid_78 = arith.andi %pid_76, %pid_77 : i1 loc(#loc649)
      %pid_79 = arith.addi %pid_41, %pid_70 : i32 loc(#loc649)
      %pid_80 = arith.extsi %pid_79 : i32 to i64 loc(#loc650)
      %pid_81 = arith.extsi %local_pid_32 : i32 to i64 loc(#loc650)
      %pid_82 = arith.addi %pid_80, %pid_81 : i64 loc(#loc650)
      %pid_83 = arith.constant 2147483647 : i64 loc(#loc650)
      %pid_84 = arith.constant -2147483648 : i64 loc(#loc650)
      %pid_85 = arith.cmpi sle, %pid_82, %pid_83 : i64 loc(#loc650)
      %pid_86 = arith.cmpi sge, %pid_82, %pid_84 : i64 loc(#loc650)
      %pid_87 = arith.andi %pid_85, %pid_86 : i1 loc(#loc650)
      %pid_88 = arith.addi %pid_79, %local_pid_32 : i32 loc(#loc660)
      scf.yield %pid_88 : i32 loc(#loc650)
    } loc(#loc323)
    tt.return %1 : i32 loc(#loc332)
  ^bb1:  // no predecessors
    %2 = ub.poison : i32 loc(#loc333)
    tt.return %2 : i32 loc(#loc333)
  } loc(#loc312)
  tt.func private @"triton.language.standard.cdiv__i32__(1,)cconstexpr_64_"(%x: i32 loc("x"(#loc309))) -> i32 attributes {noinline = false} {
    %c64_i32 = arith.constant 64 : i32 loc(#loc334)
    %c64_i32_0 = arith.constant 64 : i32 loc(#loc334)
    %0 = arith.extsi %x : i32 to i64 loc(#loc334)
    %1 = arith.extsi %c64_i32_0 : i32 to i64 loc(#loc334)
    %2 = arith.addi %0, %1 : i64 loc(#loc334)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc334)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc334)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc334)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc334)
    %5 = arith.andi %3, %4 : i1 loc(#loc334)
    %6 = arith.addi %x, %c64_i32_0 : i32 loc(#loc334)
    %c1_i32 = arith.constant 1 : i32 loc(#loc335)
    %c1_i32_1 = arith.constant 1 : i32 loc(#loc335)
    %7 = arith.extsi %6 : i32 to i64 loc(#loc335)
    %8 = arith.extsi %c1_i32_1 : i32 to i64 loc(#loc335)
    %9 = arith.subi %7, %8 : i64 loc(#loc335)
    %c2147483647_i64_2 = arith.constant 2147483647 : i64 loc(#loc335)
    %c-2147483648_i64_3 = arith.constant -2147483648 : i64 loc(#loc335)
    %10 = arith.cmpi sle, %9, %c2147483647_i64_2 : i64 loc(#loc335)
    %11 = arith.cmpi sge, %9, %c-2147483648_i64_3 : i64 loc(#loc335)
    %12 = arith.andi %10, %11 : i1 loc(#loc335)
    %13 = arith.subi %6, %c1_i32_1 : i32 loc(#loc335)
    %c64_i32_4 = arith.constant 64 : i32 loc(#loc336)
    %c64_i32_5 = arith.constant 64 : i32 loc(#loc336)
    %14 = arith.divsi %13, %c64_i32_5 : i32 loc(#loc336)
    tt.return %14 : i32 loc(#loc310)
  ^bb1:  // no predecessors
    %15 = ub.poison : i32 loc(#loc311)
    tt.return %15 : i32 loc(#loc311)
  } loc(#loc309)
  tt.func private @"triton.language.standard.cdiv__i32__(1,)cconstexpr_8_"(%x: i32 loc("x"(#loc309))) -> i32 attributes {noinline = false} {
    %c8_i32 = arith.constant 8 : i32 loc(#loc334)
    %c8_i32_0 = arith.constant 8 : i32 loc(#loc334)
    %0 = arith.extsi %x : i32 to i64 loc(#loc334)
    %1 = arith.extsi %c8_i32_0 : i32 to i64 loc(#loc334)
    %2 = arith.addi %0, %1 : i64 loc(#loc334)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc334)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc334)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc334)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc334)
    %5 = arith.andi %3, %4 : i1 loc(#loc334)
    %6 = arith.addi %x, %c8_i32_0 : i32 loc(#loc334)
    %c1_i32 = arith.constant 1 : i32 loc(#loc335)
    %c1_i32_1 = arith.constant 1 : i32 loc(#loc335)
    %7 = arith.extsi %6 : i32 to i64 loc(#loc335)
    %8 = arith.extsi %c1_i32_1 : i32 to i64 loc(#loc335)
    %9 = arith.subi %7, %8 : i64 loc(#loc335)
    %c2147483647_i64_2 = arith.constant 2147483647 : i64 loc(#loc335)
    %c-2147483648_i64_3 = arith.constant -2147483648 : i64 loc(#loc335)
    %10 = arith.cmpi sle, %9, %c2147483647_i64_2 : i64 loc(#loc335)
    %11 = arith.cmpi sge, %9, %c-2147483648_i64_3 : i64 loc(#loc335)
    %12 = arith.andi %10, %11 : i1 loc(#loc335)
    %13 = arith.subi %6, %c1_i32_1 : i32 loc(#loc335)
    %c8_i32_4 = arith.constant 8 : i32 loc(#loc336)
    %c8_i32_5 = arith.constant 8 : i32 loc(#loc336)
    %14 = arith.divsi %13, %c8_i32_5 : i32 loc(#loc336)
    tt.return %14 : i32 loc(#loc310)
  ^bb1:  // no predecessors
    %15 = ub.poison : i32 loc(#loc311)
    tt.return %15 : i32 loc(#loc311)
  } loc(#loc309)
  tt.func private @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() -> tensor<16x256xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc338)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<16x256xf32, #mma> loc(#loc338)
    tt.return %cst_0 : tensor<16x256xf32, #mma> loc(#loc339)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<16x256xf32, #mma> loc(#loc340)
    tt.return %0 : tensor<16x256xf32, #mma> loc(#loc340)
  } loc(#loc337)
  tt.func private @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_64__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16, 16, 16), transposed=True, warps_per_cta=(1, 4), element_bitwidth=32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() -> tensor<16x64xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc338)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<16x64xf32, #mma> loc(#loc338)
    tt.return %cst_0 : tensor<16x64xf32, #mma> loc(#loc339)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<16x64xf32, #mma> loc(#loc340)
    tt.return %0 : tensor<16x64xf32, #mma> loc(#loc340)
  } loc(#loc337)
  tt.func private @"triton.language.standard.max__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%input: tensor<16x64xf32, #mma> loc("input"(#loc341))) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._elementwise_max__fp32_fp32__(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc342)
      tt.reduce.return %2 : f32 loc(#loc342)
    }) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc342)
    tt.return %0 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc343)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc344)
    tt.return %1 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc344)
  } loc(#loc341)
  tt.func private @triton.language.standard._elementwise_max__fp32_fp32__(%a: f32 loc("a"(#loc345)), %b: f32 loc("b"(#loc345))) -> f32 attributes {noinline = false} {
    %0 = arith.maxnumf %a, %b : f32 loc(#loc346)
    tt.return %0 : f32 loc(#loc347)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc348)
    tt.return %1 : f32 loc(#loc348)
  } loc(#loc345)
  tt.func private @"triton.language.standard.sum__fp32S16_64SLMFMA_3_16_16_16_True_1_4_32_1_1_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%input: tensor<16x64xf32, #mma> loc("input"(#loc349))) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._sum_combine__fp32_fp32__(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc350)
      tt.reduce.return %2 : f32 loc(#loc350)
    }) : (tensor<16x64xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc350)
    tt.return %0 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc351)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc352)
    tt.return %1 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc352)
  } loc(#loc349)
  tt.func private @triton.language.standard._sum_combine__fp32_fp32__(%a: f32 loc("a"(#loc353)), %b: f32 loc("b"(#loc353))) -> f32 attributes {noinline = false} {
    %0 = arith.addf %a, %b : f32 loc(#loc354)
    tt.return %0 : f32 loc(#loc355)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc356)
    tt.return %1 : f32 loc(#loc356)
  } loc(#loc353)
} loc(#loc)
#loc2 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":74:24)
#loc3 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":75:41)
#loc4 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":77:48)
#loc5 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":77:31)
#loc6 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":78:71)
#loc7 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":78:54)
#loc8 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":80:38)
#loc9 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":81:40)
#loc10 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":81:58)
#loc11 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":85:42)
#loc12 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":85:25)
#loc13 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":85:60)
#loc14 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":89:33)
#loc15 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":90:37)
#loc16 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":91:52)
#loc17 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":91:35)
#loc18 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":137:27)
#loc19 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":140:27)
#loc20 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":143:27)
#loc21 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":147:27)
#loc22 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":176:29)
#loc23 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":177:11)
#loc24 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":176:45)
#loc25 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":179:39)
#loc26 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":179:44)
#loc27 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":179:24)
#loc28 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":180:34)
#loc29 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":180:23)
#loc30 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":183:11)
#loc31 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":187:11)
#loc32 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":191:11)
#loc33 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":193:30)
#loc34 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":194:43)
#loc35 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":194:29)
#loc36 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":197:11)
#loc37 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":201:11)
#loc38 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":203:24)
#loc39 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":204:35)
#loc40 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":204:25)
#loc41 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":206:11)
#loc42 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":208:24)
#loc43 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":212:8)
#loc44 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":220:11)
#loc45 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":224:8)
#loc46 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":228:47)
#loc47 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":229:54)
#loc48 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":232:35)
#loc49 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":234:39)
#loc50 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":234:50)
#loc51 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":234:27)
#loc52 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":234:72)
#loc53 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":234:62)
#loc54 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":236:41)
#loc55 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":236:52)
#loc56 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":236:32)
#loc57 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":236:71)
#loc58 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":236:64)
#loc59 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":238:22)
#loc60 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":239:26)
#loc61 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":240:29)
#loc62 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":241:27)
#loc63 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":243:53)
#loc64 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":244:40)
#loc65 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":247:24)
#loc66 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":247:42)
#loc67 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":248:8)
#loc68 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":250:47)
#loc69 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":250:65)
#loc70 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":253:47)
#loc71 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":253:35)
#loc72 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":256:47)
#loc73 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":256:35)
#loc74 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":261:21)
#loc75 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":261:41)
#loc76 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":261:34)
#loc77 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":261:8)
#loc78 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":266:24)
#loc79 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":266:47)
#loc80 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":266:37)
#loc81 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":266:8)
#loc82 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":269:26)
#loc83 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":269:8)
#loc84 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":272:22)
#loc85 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":273:22)
#loc86 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":274:22)
#loc87 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":276:23)
#loc88 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":277:23)
#loc89 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":278:27)
#loc90 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":279:27)
#loc91 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":281:22)
#loc92 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":282:28)
#loc93 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":284:4)
#loc94 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":285:4)
#loc95 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":286:4)
#loc96 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":290:34)
#loc97 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":293:20)
#loc98 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":296:20)
#loc99 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":301:8)
#loc100 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":304:20)
#loc101 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":304:38)
#loc102 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":305:33)
#loc103 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":305:51)
#loc104 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":306:25)
#loc105 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":307:24)
#loc106 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":307:36)
#loc107 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":307:61)
#loc108 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":307:52)
#loc109 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":308:31)
#loc110 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":308:51)
#loc111 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":308:42)
#loc112 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":313:8)
#loc113 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":318:30)
#loc114 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":319:8)
#loc115 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":323:34)
#loc116 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":326:34)
#loc117 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":329:31)
#loc118 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":331:19)
#loc119 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":332:19)
#loc120 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":334:23)
#loc121 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":334:41)
#loc122 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":335:28)
#loc123 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":335:39)
#loc124 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":335:64)
#loc125 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":335:55)
#loc126 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":336:33)
#loc127 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":336:51)
#loc128 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":337:28)
#loc129 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:34)
#loc130 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:54)
#loc131 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":338:45)
#loc132 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":343:8)
#loc133 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":346:25)
#loc134 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":346:81)
#loc135 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":346:95)
#loc136 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":347:20)
#loc137 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":350:27)
#loc138 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":351:27)
#loc139 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":353:31)
#loc140 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":355:34)
#loc141 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":356:29)
#loc142 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":357:31)
#loc143 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":359:19)
#loc144 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":361:34)
#loc145 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":362:29)
#loc146 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":363:31)
#loc147 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":365:19)
#loc148 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":367:22)
#loc149 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":368:31)
#loc150 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":369:22)
#loc151 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":372:38)
#loc152 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":374:41)
#loc153 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":376:30)
#loc154 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":376:12)
#loc155 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":379:36)
#loc156 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":381:35)
#loc157 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":382:24)
#loc158 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":382:42)
#loc159 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":383:27)
#loc160 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":383:38)
#loc161 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":383:63)
#loc162 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":383:54)
#loc163 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":384:30)
#loc164 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":384:48)
#loc165 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":385:29)
#loc166 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":387:33)
#loc167 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":387:53)
#loc168 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":387:44)
#loc169 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":388:35)
#loc170 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":390:43)
#loc171 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":394:12)
#loc172 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":397:35)
#loc173 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":399:43)
#loc174 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":402:34)
#loc175 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":403:12)
#loc176 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":406:31)
#loc177 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":407:31)
#loc178 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":409:47)
#loc179 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":411:14)
#loc180 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":413:27)
#loc181 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":413:45)
#loc182 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":414:32)
#loc183 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":414:43)
#loc184 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":414:68)
#loc185 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":414:59)
#loc186 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":415:30)
#loc187 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":415:48)
#loc188 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":416:32)
#loc189 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":418:39)
#loc190 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":418:59)
#loc191 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":418:50)
#loc192 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":420:35)
#loc193 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":424:12)
#loc194 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":427:47)
#loc195 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":427:51)
#loc196 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":428:38)
#loc197 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":430:41)
#loc198 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":430:52)
#loc199 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":430:32)
#loc200 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":431:39)
#loc201 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":431:31)
#loc202 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":431:51)
#loc203 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":431:25)
#loc204 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":432:26)
#loc205 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":432:21)
#loc206 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":433:35)
#loc207 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":435:28)
#loc208 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":437:38)
#loc209 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":439:38)
#loc210 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":441:23)
#loc211 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":442:31)
#loc212 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":442:22)
#loc213 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":443:48)
#loc214 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:24)
#loc215 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:45)
#loc216 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":444:35)
#loc217 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":446:23)
#loc218 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":447:31)
#loc219 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":447:22)
#loc220 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":448:48)
#loc221 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":449:26)
#loc222 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":452:31)
#loc223 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":453:33)
#loc224 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":454:35)
#loc225 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":456:38)
#loc226 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":458:23)
#loc227 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":459:31)
#loc228 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":461:33)
#loc229 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":462:35)
#loc230 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":464:38)
#loc231 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":465:23)
#loc232 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":465:8)
#loc233 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":468:39)
#loc234 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":469:39)
#loc235 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":471:32)
#loc236 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":473:43)
#loc237 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":475:27)
#loc238 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":476:27)
#loc239 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":478:10)
#loc240 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":480:32)
#loc241 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":480:37)
#loc242 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":480:77)
#loc243 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":480:55)
#loc244 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:19)
#loc245 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:30)
#loc246 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:62)
#loc247 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:74)
#loc248 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:52)
#loc249 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":483:82)
#loc250 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":486:43)
#loc251 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":486:47)
#loc252 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":488:34)
#loc253 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":489:37)
#loc254 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":489:48)
#loc255 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":489:28)
#loc256 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":490:35)
#loc257 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":490:27)
#loc258 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":490:47)
#loc259 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":490:21)
#loc260 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":492:22)
#loc261 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":492:17)
#loc262 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":494:27)
#loc263 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":494:18)
#loc264 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":495:27)
#loc265 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":495:18)
#loc266 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":496:20)
#loc267 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":496:41)
#loc268 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":496:31)
#loc269 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":497:31)
#loc270 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":498:24)
#loc271 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":501:44)
#loc272 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":502:44)
#loc273 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":504:4)
#loc274 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":505:4)
#loc275 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":507:24)
#loc276 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":508:26)
#loc277 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":509:26)
#loc278 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":510:33)
#loc279 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":513:33)
#loc280 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":517:16)
#loc281 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":518:29)
#loc282 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":518:23)
#loc283 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":518:17)
#loc284 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":519:24)
#loc285 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":522:39)
#loc286 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":522:69)
#loc287 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":522:55)
#loc288 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":525:19)
#loc289 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":525:30)
#loc290 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":525:10)
#loc291 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":526:17)
#loc292 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":526:10)
#loc293 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":533:21)
#loc294 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":533:41)
#loc295 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":533:34)
#loc296 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":533:8)
#loc297 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":537:20)
#loc298 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":538:20)
#loc299 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":538:10)
#loc300 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":539:24)
#loc301 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":539:10)
#loc302 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":542:40)
#loc303 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":542:45)
#loc304 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":542:25)
#loc305 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":544:36)
#loc306 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":544:29)
#loc307 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":547:8)
#loc308 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode_mi355.py":543:4)
#loc310 = loc("/workspace/triton/python/triton/language/standard.py":41:11)
#loc311 = loc("/workspace/triton/python/triton/language/standard.py":41:4)
#loc313 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:30)
#loc314 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:41)
#loc315 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:47)
#loc316 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":36:26)
#loc317 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:41)
#loc318 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:28)
#loc319 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:16)
#loc320 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":39:16)
#loc321 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":40:23)
#loc322 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":45:13)
#loc323 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":45:7)
#loc324 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":46:20)
#loc325 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":46:35)
#loc326 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":49:24)
#loc327 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:21)
#loc328 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:50)
#loc329 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:35)
#loc330 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:14)
#loc331 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":51:14)
#loc332 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":54:11)
#loc333 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":54:4)
#loc334 = loc("/workspace/triton/python/triton/language/standard.py":41:16)
#loc335 = loc("/workspace/triton/python/triton/language/standard.py":41:22)
#loc336 = loc("/workspace/triton/python/triton/language/standard.py":41:28)
#loc337 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":28:0)
#loc338 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:38)
#loc339 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:11)
#loc340 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:4)
#loc342 = loc("/workspace/triton/python/triton/language/standard.py":189:40)
#loc343 = loc("/workspace/triton/python/triton/language/standard.py":189:15)
#loc344 = loc("/workspace/triton/python/triton/language/standard.py":177:4)
#loc346 = loc("/workspace/triton/python/triton/language/standard.py":168:27)
#loc347 = loc("/workspace/triton/python/triton/language/standard.py":168:11)
#loc348 = loc("/workspace/triton/python/triton/language/standard.py":168:4)
#loc350 = loc("/workspace/triton/python/triton/language/standard.py":291:36)
#loc351 = loc("/workspace/triton/python/triton/language/standard.py":291:11)
#loc352 = loc("/workspace/triton/python/triton/language/standard.py":291:4)
#loc354 = loc("/workspace/triton/python/triton/language/standard.py":261:15)
#loc355 = loc("/workspace/triton/python/triton/language/standard.py":261:11)
#loc356 = loc("/workspace/triton/python/triton/language/standard.py":261:4)
#loc376 = loc("pid"(#loc2))
#loc377 = loc("num_q_head_blk"(#loc3))
#loc378 = loc("pid_head_kv_split"(#loc4))
#loc379 = loc("pid_head_kv_split"(#loc5))
#loc380 = loc("pid_head_kv_split"(#loc6))
#loc381 = loc("pid_head_kv_split"(#loc7))
#loc382 = loc("cur_head_id"(#loc8))
#loc383 = loc("split_kv_id"(#loc9))
#loc384 = loc("split_kv_id"(#loc10))
#loc385 = loc("cur_batch"(#loc11))
#loc386 = loc("cur_batch"(#loc12))
#loc387 = loc("cur_batch"(#loc13))
#loc388 = loc("kv_indptr_base"(#loc14))
#loc389 = loc("cur_batch_kv_start_idx"(#loc15))
#loc390 = loc("cur_batch_kv_end_idx"(#loc16))
#loc391 = loc("cur_batch_kv_end_idx"(#loc17))
#loc392 = loc("smem_q0_nope"(#loc18))
#loc393 = loc("smem_q1_nope"(#loc19))
#loc394 = loc("smem_q_rope"(#loc20))
#loc395 = loc("smem_p"(#loc21))
#loc396 = loc("cur_head"(#loc22))
#loc397 = loc("cur_head"(#loc23))
#loc398 = loc("cur_head"(#loc24))
#loc399 = loc("mask_h"(#loc25))
#loc400 = loc("mask_h"(#loc26))
#loc401 = loc("mask_h"(#loc27))
#loc402 = loc("mask_h"(#loc28))
#loc403 = loc("mask_h"(#loc29))
#loc404 = loc("cur_N"(#loc30))
#loc405 = loc("cur_N_pe"(#loc31))
#loc406 = loc("cur_head_pe"(#loc32))
#loc407 = loc("mask_h_pe"(#loc33))
#loc408 = loc("mask_h_pe"(#loc34))
#loc409 = loc("mask_h_pe"(#loc35))
#loc410 = loc("offs_c"(#loc36))
#loc411 = loc("offs_om"(#loc37))
#loc412 = loc("mask_om"(#loc38))
#loc413 = loc("mask_om"(#loc39))
#loc414 = loc("mask_om"(#loc40))
#loc415 = loc("offs_on"(#loc41))
#loc416 = loc("mask_on"(#loc42))
#loc417 = loc("offs_qk_r"(#loc43))
#loc418 = loc("offs_k_c"(#loc44))
#loc419 = loc("offs_k_r"(#loc45))
#loc420 = loc("cur_batch_seq_len"(#loc46))
#loc421 = loc("cur_batch_block_nums"(#loc47))
#loc422 = loc("cur_batch_offset"(#loc48))
#loc423 = loc("off_q_pe"(#loc49))
#loc424 = loc("off_q_pe"(#loc50))
#loc425 = loc("off_q_pe"(#loc51))
#loc426 = loc("off_q_pe"(#loc52))
#loc427 = loc("off_q_pe"(#loc53))
#loc428 = loc("offs_q"(#loc54))
#loc429 = loc("offs_q"(#loc55))
#loc430 = loc("offs_q"(#loc56))
#loc431 = loc("offs_q"(#loc57))
#loc432 = loc("offs_q"(#loc58))
#loc433 = loc("mask_c"(#loc59))
#loc434 = loc("mask_k_c"(#loc60))
#loc435 = loc("mask_qk_r"(#loc61))
#loc436 = loc("mask_k_r"(#loc62))
#loc437 = loc("blocks_per_split"(#loc63))
#loc438 = loc("split_kv_start"(#loc64))
#loc439 = loc("split_kv_end"(#loc68))
#loc440 = loc("split_kv_end"(#loc69))
#loc441 = loc("kv_indices_base"(#loc70))
#loc442 = loc("kv_indices_base"(#loc71))
#loc443 = loc("kv_indices_base"(#loc72))
#loc444 = loc("kv_indices_base"(#loc73))
#loc445 = loc("q"(#loc74))
#loc446 = loc("q"(#loc75))
#loc447 = loc("q"(#loc76))
#loc448 = loc("q"(#loc77))
#loc449 = loc("q_pe"(#loc78))
#loc450 = loc("q_pe"(#loc79))
#loc451 = loc("q_pe"(#loc80))
#loc452 = loc("q_pe"(#loc81))
#loc453 = loc("kv_loc"(#loc82))
#loc454 = loc("kv_loc"(#loc83))
#loc455 = loc("q"(#loc84))
#loc456 = loc("q"(#loc85))
#loc457 = loc("q0"(#loc89))
#loc458 = loc("q1"(#loc90))
#loc459 = loc("q_pe"(#loc92))
#loc460 = loc("smem_k_rope"(#loc96))
#loc461 = loc("acc1"(#loc97))
#loc462 = loc("acc2"(#loc98))
#loc463 = loc("zeros"(#loc99))
#loc464 = loc("k_id"(#loc100))
#loc465 = loc("k_id"(#loc101))
#loc466 = loc("mask_k_id"(#loc102))
#loc467 = loc("mask_k_id"(#loc103))
#loc468 = loc("mask_k"(#loc104))
#loc469 = loc("offs_buf_kv"(#loc105))
#loc470 = loc("offs_buf_kv"(#loc106))
#loc471 = loc("offs_buf_kv"(#loc107))
#loc472 = loc("offs_buf_kv"(#loc108))
#loc473 = loc("mask_k_c_combined"(#loc109))
#loc474 = loc("mask_k_c_combined"(#loc110))
#loc475 = loc("mask_k_c_combined"(#loc111))
#loc476 = loc("kv1"(#loc112))
#loc477 = loc("kv2"(#loc113))
#loc478 = loc("kv2"(#loc114))
#loc479 = loc("smem_kv1"(#loc115))
#loc480 = loc("smem_kv2"(#loc116))
#loc481 = loc("k_id_pe"(#loc120))
#loc482 = loc("k_id_pe"(#loc121))
#loc483 = loc("offs_buf_k_pe"(#loc122))
#loc484 = loc("offs_buf_k_pe"(#loc123))
#loc485 = loc("offs_buf_k_pe"(#loc124))
#loc486 = loc("offs_buf_k_pe"(#loc125))
#loc487 = loc("mask_k_id"(#loc126))
#loc488 = loc("mask_k_id"(#loc127))
#loc489 = loc("mask_k_pe"(#loc128))
#loc490 = loc("mask_k_r_combined"(#loc129))
#loc491 = loc("mask_k_r_combined"(#loc130))
#loc492 = loc("mask_k_r_combined"(#loc131))
#loc493 = loc("k_pe"(#loc132))
#loc494 = loc("e_sum"(#loc133))
#loc495 = loc("e_sum"(#loc134))
#loc496 = loc("e_sum"(#loc135))
#loc497 = loc("e_max"(#loc136))
#loc498 = loc("cur_k1"(#loc137))
#loc499 = loc("cur_k2"(#loc138))
#loc500 = loc("smem_kv1"(#loc140))
#loc501 = loc("kv1_transpose"(#loc141))
#loc502 = loc("smem_kv2"(#loc144))
#loc503 = loc("kv2_transpose"(#loc145))
#loc504 = loc("split_kv_start"(#loc150))
#loc505 = loc("mask_qk_h"(#loc151))
#loc506 = loc("kv_loc"(#loc152))
#loc507 = loc("kv_loc"(#loc153))
#loc508 = loc("kv_loc"(#loc154))
#loc509 = loc("cur_k_pe"(#loc155))
#loc510 = loc("k_id"(#loc157))
#loc511 = loc("k_id"(#loc158))
#loc512 = loc("offs_buf_kv"(#loc159))
#loc513 = loc("offs_buf_kv"(#loc160))
#loc514 = loc("offs_buf_kv"(#loc161))
#loc515 = loc("offs_buf_kv"(#loc162))
#loc516 = loc("mask_k_id"(#loc163))
#loc517 = loc("mask_k_id"(#loc164))
#loc518 = loc("mask_k"(#loc165))
#loc519 = loc("mask_k_combined"(#loc166))
#loc520 = loc("mask_k_combined"(#loc167))
#loc521 = loc("mask_k_combined"(#loc168))
#loc522 = loc("qk"(#loc170))
#loc523 = loc("kv1"(#loc171))
#loc524 = loc("qk"(#loc173))
#loc525 = loc("kv2"(#loc174))
#loc526 = loc("kv2"(#loc175))
#loc527 = loc("cur_k1"(#loc176))
#loc528 = loc("cur_k2"(#loc177))
#loc529 = loc("qk"(#loc178))
#loc530 = loc("qk"(#loc179))
#loc531 = loc("k_id_pe"(#loc180))
#loc532 = loc("k_id_pe"(#loc181))
#loc533 = loc("offs_buf_k_pe"(#loc182))
#loc534 = loc("offs_buf_k_pe"(#loc183))
#loc535 = loc("offs_buf_k_pe"(#loc184))
#loc536 = loc("offs_buf_k_pe"(#loc185))
#loc537 = loc("mask_k_id"(#loc186))
#loc538 = loc("mask_k_id"(#loc187))
#loc539 = loc("mask_k_pe"(#loc188))
#loc540 = loc("mask_k_pe_combined"(#loc189))
#loc541 = loc("mask_k_pe_combined"(#loc190))
#loc542 = loc("mask_k_pe_combined"(#loc191))
#loc543 = loc("k_pe"(#loc193))
#loc544 = loc("n_e_max"(#loc194))
#loc545 = loc("n_e_max"(#loc195))
#loc546 = loc("n_e_max"(#loc196))
#loc547 = loc("re_scale"(#loc197))
#loc548 = loc("re_scale"(#loc198))
#loc549 = loc("re_scale"(#loc199))
#loc550 = loc("p"(#loc200))
#loc551 = loc("p"(#loc201))
#loc552 = loc("p"(#loc202))
#loc553 = loc("p"(#loc203))
#loc554 = loc("cur_p"(#loc207))
#loc555 = loc("smem_kv1"(#loc208))
#loc556 = loc("smem_kv2"(#loc209))
#loc557 = loc("acc1"(#loc211))
#loc558 = loc("acc1"(#loc212))
#loc559 = loc("acc1"(#loc213))
#loc560 = loc("e_sum"(#loc214))
#loc561 = loc("e_sum"(#loc215))
#loc562 = loc("e_sum"(#loc216))
#loc563 = loc("acc2"(#loc218))
#loc564 = loc("acc2"(#loc219))
#loc565 = loc("acc2"(#loc220))
#loc566 = loc("cur_k1"(#loc222))
#loc567 = loc("kv1_transpose"(#loc223))
#loc568 = loc("smem_kv1"(#loc225))
#loc569 = loc("cur_k2"(#loc227))
#loc570 = loc("kv2_transpose"(#loc228))
#loc571 = loc("smem_kv2"(#loc230))
#loc572 = loc("qk"(#loc233))
#loc573 = loc("qk"(#loc234))
#loc574 = loc("cur_k_pe"(#loc235))
#loc575 = loc("qk"(#loc236))
#loc576 = loc("cur_k1"(#loc237))
#loc577 = loc("cur_k2"(#loc238))
#loc578 = loc("qk"(#loc239))
#loc579 = loc("mask_qk_n"(#loc240))
#loc580 = loc("mask_qk_n"(#loc241))
#loc581 = loc("mask_qk_n"(#loc242))
#loc582 = loc("mask_qk_n"(#loc243))
#loc583 = loc("qk"(#loc244))
#loc584 = loc("qk"(#loc245))
#loc585 = loc("qk"(#loc246))
#loc586 = loc("qk"(#loc247))
#loc587 = loc("qk"(#loc248))
#loc588 = loc("qk"(#loc249))
#loc589 = loc("n_e_max"(#loc250))
#loc590 = loc("n_e_max"(#loc251))
#loc591 = loc("n_e_max"(#loc252))
#loc592 = loc("re_scale"(#loc253))
#loc593 = loc("re_scale"(#loc254))
#loc594 = loc("re_scale"(#loc255))
#loc595 = loc("p"(#loc256))
#loc596 = loc("p"(#loc257))
#loc597 = loc("p"(#loc258))
#loc598 = loc("p"(#loc259))
#loc599 = loc("acc1"(#loc262))
#loc600 = loc("acc1"(#loc263))
#loc601 = loc("acc2"(#loc264))
#loc602 = loc("acc2"(#loc265))
#loc603 = loc("e_sum"(#loc266))
#loc604 = loc("e_sum"(#loc267))
#loc605 = loc("e_sum"(#loc268))
#loc606 = loc("cur_p"(#loc270))
#loc607 = loc("acc1"(#loc271))
#loc608 = loc("acc2"(#loc272))
#loc609 = loc("acc"(#loc275))
#loc610 = loc("acc"(#loc276))
#loc611 = loc("acc"(#loc277))
#loc612 = loc("acc"(#loc278))
#loc613 = loc("smem_o"(#loc279))
#loc614 = loc("e_sum"(#loc280))
#loc615 = loc("cur_o"(#loc284))
#loc616 = loc("cur_batch_out_offset"(#loc285))
#loc617 = loc("cur_batch_out_offset"(#loc286))
#loc618 = loc("cur_batch_out_offset"(#loc287))
#loc619 = loc("offs_mid_o"(#loc288))
#loc620 = loc("offs_mid_o"(#loc289))
#loc621 = loc("offs_mid_o"(#loc290))
#loc622 = loc("offs_mid_o"(#loc291))
#loc623 = loc("offs_mid_o"(#loc292))
#loc624 = loc("offs_mid_lse"(#loc297))
#loc625 = loc("offs_mid_lse"(#loc298))
#loc626 = loc("offs_mid_lse"(#loc299))
#loc627 = loc("offs_mid_lse"(#loc300))
#loc628 = loc("offs_mid_lse"(#loc301))
#loc629 = loc("mask_lse"(#loc302))
#loc630 = loc("mask_lse"(#loc303))
#loc631 = loc("mask_lse"(#loc304))
#loc634 = loc("pids_per_xcd"(#loc313))
#loc635 = loc("pids_per_xcd"(#loc314))
#loc636 = loc("pids_per_xcd"(#loc315))
#loc637 = loc("tall_xcds"(#loc316))
#loc638 = loc("tall_xcds"(#loc317))
#loc639 = loc("tall_xcds"(#loc318))
#loc640 = loc("tall_xcds"(#loc319))
#loc641 = loc("xcd"(#loc320))
#loc642 = loc("local_pid"(#loc321))
#loc643 = loc("pid"(#loc324))
#loc644 = loc("pid"(#loc325))
#loc645 = loc("pid"(#loc326))
#loc646 = loc("pid"(#loc327))
#loc647 = loc("pid"(#loc328))
#loc648 = loc("pid"(#loc329))
#loc649 = loc("pid"(#loc330))
#loc650 = loc("pid"(#loc331))
#loc658 = loc("acc1"(#loc506))
#loc659 = loc("pid"(#loc644))
#loc660 = loc("pid"(#loc650))
#loc661 = loc("acc2"(#loc658))
#loc662 = loc("k_id"(#loc661))
#loc663 = loc("mask_k_id"(#loc662))
#loc664 = loc("mask_k"(#loc663))
#loc665 = loc("offs_buf_kv"(#loc664))
#loc666 = loc("kv1"(#loc665))
#loc667 = loc("kv2"(#loc666))
#loc668 = loc("smem_kv1"(#loc667))
#loc669 = loc("smem_kv2"(#loc668))
#loc670 = loc("k_id_pe"(#loc669))
#loc671 = loc("offs_buf_k_pe"(#loc670))
#loc672 = loc("mask_k_pe"(#loc671))
#loc673 = loc("k_pe"(#loc672))
#loc674 = loc("e_sum"(#loc673))
#loc675 = loc("e_max"(#loc674))
#loc676 = loc("cur_k1"(#loc675))
#loc677 = loc("cur_k2"(#loc676))
#loc678 = loc("kv1_transpose"(#loc677))
#loc679 = loc("kv2_transpose"(#loc678))

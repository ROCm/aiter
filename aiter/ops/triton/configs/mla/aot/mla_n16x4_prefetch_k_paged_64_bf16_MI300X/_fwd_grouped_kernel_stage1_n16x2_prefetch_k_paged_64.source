#blocked = #ttg.blocked<{sizePerThread = [2, 8], threadsPerWarp = [8, 8], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [4, 8], threadsPerWarp = [8, 8], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [32, 2], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked3 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [16, 4], warpsPerCTA = [1, 4], order = [1, 0]}>
#blocked4 = #ttg.blocked<{sizePerThread = [2, 1, 8], threadsPerWarp = [8, 1, 8], warpsPerCTA = [1, 1, 4], order = [2, 1, 0]}>
#blocked5 = #ttg.blocked<{sizePerThread = [2, 8, 1], threadsPerWarp = [8, 8, 1], warpsPerCTA = [1, 4, 1], order = [1, 2, 0]}>
#blocked6 = #ttg.blocked<{sizePerThread = [8, 4], threadsPerWarp = [8, 8], warpsPerCTA = [4, 1], order = [0, 1]}>
#blocked7 = #ttg.blocked<{sizePerThread = [8, 1], threadsPerWarp = [2, 32], warpsPerCTA = [4, 1], order = [0, 1]}>
#linear = #ttg.linear<{register = [[0, 0, 1], [0, 1, 0], [0, 2, 0], [0, 64, 0], [0, 128, 0]], lane = [[1, 0, 0], [2, 0, 0], [4, 0, 0], [8, 0, 0], [0, 4, 0], [0, 8, 0]], warp = [[0, 16, 0], [0, 32, 0]], block = []}>
#linear1 = #ttg.linear<{register = [[0, 1, 0], [0, 0, 1], [0, 0, 2], [0, 0, 64], [0, 0, 128]], lane = [[1, 0, 0], [2, 0, 0], [4, 0, 0], [8, 0, 0], [0, 0, 4], [0, 0, 8]], warp = [[0, 0, 16], [0, 0, 32]], block = []}>
#linear2 = #ttg.linear<{register = [[0, 256], [0, 1], [0, 2], [0, 64], [0, 128]], lane = [[1, 0], [2, 0], [4, 0], [8, 0], [0, 4], [0, 8]], warp = [[0, 16], [0, 32]], block = []}>
#loc = loc(unknown)
#loc1 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":534:0)
#loc340 = loc("/workspace/triton/python/triton/language/standard.py":32:0)
#loc343 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":28:0)
#loc372 = loc("/workspace/triton/python/triton/language/standard.py":175:0)
#loc376 = loc("/workspace/triton/python/triton/language/standard.py":167:0)
#loc380 = loc("/workspace/triton/python/triton/language/standard.py":285:0)
#loc384 = loc("/workspace/triton/python/triton/language/standard.py":260:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [1, 4], instrShape = [16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 8, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared2 = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 16, order = [0, 1]}>
#shared3 = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 8, order = [0, 1]}>
#smem = #ttg.shared_memory
#loc388 = loc("Q"(#loc1))
#loc389 = loc("K_Buffer"(#loc1))
#loc390 = loc("V_buffer"(#loc1))
#loc391 = loc("sm_scale"(#loc1))
#loc392 = loc("kv_indptr"(#loc1))
#loc393 = loc("kv_indices"(#loc1))
#loc394 = loc("Att_Out"(#loc1))
#loc395 = loc("Att_Lse"(#loc1))
#loc396 = loc("stride_qb"(#loc1))
#loc397 = loc("stride_qh"(#loc1))
#loc398 = loc("stride_buf_kbs"(#loc1))
#loc399 = loc("stride_buf_kh"(#loc1))
#loc400 = loc("stride_mid_ob"(#loc1))
#loc401 = loc("stride_mid_oh"(#loc1))
#loc402 = loc("stride_mid_os"(#loc1))
#loc403 = loc("stride_mid_lse_b"(#loc1))
#loc404 = loc("stride_mid_lse_h"(#loc1))
#loc405 = loc("stride_mid_lse_s"(#loc1))
#loc406 = loc("stride_b_block_table"(#loc1))
#loc693 = loc("pid"(#loc343))
#loc694 = loc("GRID_MN"(#loc343))
#loc712 = loc("x"(#loc340))
#loc713 = loc("input"(#loc372))
#loc714 = loc("a"(#loc376))
#loc715 = loc("b"(#loc376))
#loc716 = loc("input"(#loc380))
#loc717 = loc("a"(#loc384))
#loc718 = loc("b"(#loc384))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 4 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @_fwd_grouped_kernel_stage1_n16x2_prefetch_k_paged_64(%Q: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Q"(#loc1)), %K_Buffer: !tt.ptr<bf16> {tt.divisibility = 16 : i32} loc("K_Buffer"(#loc1)), %V_buffer: !tt.ptr<bf16> {tt.divisibility = 16 : i32} loc("V_buffer"(#loc1)), %sm_scale: f32 {tt.divisibility = 16 : i32} loc("sm_scale"(#loc1)), %kv_indptr: !tt.ptr<i32> {tt.divisibility = 16 : i32} loc("kv_indptr"(#loc1)), %kv_indices: !tt.ptr<i32> {tt.divisibility = 16 : i32} loc("kv_indices"(#loc1)), %Att_Out: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("Att_Out"(#loc1)), %Att_Lse: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("Att_Lse"(#loc1)), %stride_qb: i32 {tt.divisibility = 16 : i32} loc("stride_qb"(#loc1)), %stride_qh: i32 {tt.divisibility = 16 : i32} loc("stride_qh"(#loc1)), %stride_buf_kbs: i32 {tt.divisibility = 16 : i32} loc("stride_buf_kbs"(#loc1)), %stride_buf_kh: i32 {tt.divisibility = 16 : i32} loc("stride_buf_kh"(#loc1)), %stride_mid_ob: i32 {tt.divisibility = 16 : i32} loc("stride_mid_ob"(#loc1)), %stride_mid_oh: i32 {tt.divisibility = 16 : i32} loc("stride_mid_oh"(#loc1)), %stride_mid_os: i32 {tt.divisibility = 16 : i32} loc("stride_mid_os"(#loc1)), %stride_mid_lse_b: i32 loc("stride_mid_lse_b"(#loc1)), %stride_mid_lse_h: i32 loc("stride_mid_lse_h"(#loc1)), %stride_mid_lse_s: i32 loc("stride_mid_lse_s"(#loc1)), %stride_b_block_table: i32 loc("stride_b_block_table"(#loc1))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc407)
    %num_q_head_blk = tt.call @"triton.language.standard.cdiv____(0,)cconstexpr_8__(1,)cconstexpr_16_"() : () -> i32 loc(#loc408)
    %pid_head_kv_split = arith.constant 8 : i32 loc(#loc409)
    %pid_head_kv_split_0 = arith.constant 8 : i32 loc(#loc409)
    %pid_head_kv_split_1 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc409)
    %pid_head_kv_split_2 = arith.extsi %pid_head_kv_split_0 : i32 to i64 loc(#loc409)
    %pid_head_kv_split_3 = arith.muli %pid_head_kv_split_1, %pid_head_kv_split_2 : i64 loc(#loc409)
    %pid_head_kv_split_4 = arith.constant 2147483647 : i64 loc(#loc409)
    %pid_head_kv_split_5 = arith.constant -2147483648 : i64 loc(#loc409)
    %pid_head_kv_split_6 = arith.cmpi sle, %pid_head_kv_split_3, %pid_head_kv_split_4 : i64 loc(#loc409)
    %pid_head_kv_split_7 = arith.cmpi sge, %pid_head_kv_split_3, %pid_head_kv_split_5 : i64 loc(#loc409)
    %pid_head_kv_split_8 = arith.andi %pid_head_kv_split_6, %pid_head_kv_split_7 : i1 loc(#loc409)
    %pid_head_kv_split_9 = arith.muli %num_q_head_blk, %pid_head_kv_split_0 : i32 loc(#loc409)
    %pid_head_kv_split_10 = arith.remsi %pid, %pid_head_kv_split_9 : i32 loc(#loc410)
    %pid_head_kv_split_11 = arith.constant 8 : i32 loc(#loc411)
    %pid_head_kv_split_12 = arith.constant 8 : i32 loc(#loc411)
    %pid_head_kv_split_13 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc411)
    %pid_head_kv_split_14 = arith.extsi %pid_head_kv_split_12 : i32 to i64 loc(#loc411)
    %pid_head_kv_split_15 = arith.muli %pid_head_kv_split_13, %pid_head_kv_split_14 : i64 loc(#loc411)
    %pid_head_kv_split_16 = arith.constant 2147483647 : i64 loc(#loc411)
    %pid_head_kv_split_17 = arith.constant -2147483648 : i64 loc(#loc411)
    %pid_head_kv_split_18 = arith.cmpi sle, %pid_head_kv_split_15, %pid_head_kv_split_16 : i64 loc(#loc411)
    %pid_head_kv_split_19 = arith.cmpi sge, %pid_head_kv_split_15, %pid_head_kv_split_17 : i64 loc(#loc411)
    %pid_head_kv_split_20 = arith.andi %pid_head_kv_split_18, %pid_head_kv_split_19 : i1 loc(#loc411)
    %pid_head_kv_split_21 = arith.muli %num_q_head_blk, %pid_head_kv_split_12 : i32 loc(#loc411)
    %pid_head_kv_split_22 = tt.call @"aiter.ops.triton.utils._triton.pid_preprocessing.remap_xcd__i32_i32__(2,)cconstexpr_8_"(%pid_head_kv_split_10, %pid_head_kv_split_21) : (i32, i32) -> i32 loc(#loc412)
    %cur_head_id = arith.remsi %pid_head_kv_split_22, %num_q_head_blk : i32 loc(#loc413)
    %split_kv_id = arith.divsi %pid_head_kv_split_22, %num_q_head_blk : i32 loc(#loc414)
    %split_kv_id_23 = arith.constant 8 : i32 loc(#loc415)
    %split_kv_id_24 = arith.constant 8 : i32 loc(#loc415)
    %split_kv_id_25 = arith.remsi %split_kv_id, %split_kv_id_24 : i32 loc(#loc415)
    %page_block_per_block_N = arith.constant 2 : i32 loc(#loc416)
    %cur_batch = arith.constant 8 : i32 loc(#loc417)
    %cur_batch_26 = arith.constant 8 : i32 loc(#loc417)
    %cur_batch_27 = arith.extsi %num_q_head_blk : i32 to i64 loc(#loc417)
    %cur_batch_28 = arith.extsi %cur_batch_26 : i32 to i64 loc(#loc417)
    %cur_batch_29 = arith.muli %cur_batch_27, %cur_batch_28 : i64 loc(#loc417)
    %cur_batch_30 = arith.constant 2147483647 : i64 loc(#loc417)
    %cur_batch_31 = arith.constant -2147483648 : i64 loc(#loc417)
    %cur_batch_32 = arith.cmpi sle, %cur_batch_29, %cur_batch_30 : i64 loc(#loc417)
    %cur_batch_33 = arith.cmpi sge, %cur_batch_29, %cur_batch_31 : i64 loc(#loc417)
    %cur_batch_34 = arith.andi %cur_batch_32, %cur_batch_33 : i1 loc(#loc417)
    %cur_batch_35 = arith.muli %num_q_head_blk, %cur_batch_26 : i32 loc(#loc417)
    %cur_batch_36 = arith.divsi %pid, %cur_batch_35 : i32 loc(#loc418)
    %cur_batch_37 = arith.constant 256 : i32 loc(#loc419)
    %cur_batch_38 = arith.constant 256 : i32 loc(#loc419)
    %cur_batch_39 = arith.remsi %cur_batch_36, %cur_batch_38 : i32 loc(#loc419)
    %cur_batch_kv_start_idx = tt.addptr %kv_indptr, %cur_batch_39 : !tt.ptr<i32>, i32 loc(#loc420)
    %cur_batch_kv_start_idx_40 = tt.load %cur_batch_kv_start_idx : !tt.ptr<i32> loc(#loc421)
    %cur_batch_kv_end_idx = tt.addptr %kv_indptr, %cur_batch_39 : !tt.ptr<i32>, i32 loc(#loc422)
    %cur_batch_kv_end_idx_41 = arith.constant 1 : i32 loc(#loc423)
    %cur_batch_kv_end_idx_42 = tt.addptr %cur_batch_kv_end_idx, %cur_batch_kv_end_idx_41 : !tt.ptr<i32>, i32 loc(#loc423)
    %cur_batch_kv_end_idx_43 = tt.load %cur_batch_kv_end_idx_42 : !tt.ptr<i32> loc(#loc424)
    %smem_q0_nope = ttg.local_alloc : () -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc425)
    %smem_q1_nope = ttg.local_alloc : () -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc426)
    %smem_q_rope = ttg.local_alloc : () -> !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc427)
    %smem_p = ttg.local_alloc : () -> !ttg.memdesc<16x32xbf16, #shared1, #smem, mutable> loc(#loc428)
    %cur_head = arith.constant 8 : i32 loc(#loc429)
    %cur_head_44 = arith.constant 8 : i32 loc(#loc429)
    %cur_head_45 = arith.extsi %cur_head_id : i32 to i64 loc(#loc429)
    %cur_head_46 = arith.extsi %cur_head_44 : i32 to i64 loc(#loc429)
    %cur_head_47 = arith.muli %cur_head_45, %cur_head_46 : i64 loc(#loc429)
    %cur_head_48 = arith.constant 2147483647 : i64 loc(#loc429)
    %cur_head_49 = arith.constant -2147483648 : i64 loc(#loc429)
    %cur_head_50 = arith.cmpi sle, %cur_head_47, %cur_head_48 : i64 loc(#loc429)
    %cur_head_51 = arith.cmpi sge, %cur_head_47, %cur_head_49 : i64 loc(#loc429)
    %cur_head_52 = arith.andi %cur_head_50, %cur_head_51 : i1 loc(#loc429)
    %cur_head_53 = arith.muli %cur_head_id, %cur_head_44 : i32 loc(#loc429)
    %cur_head_54 = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc430)
    %cur_head_55 = tt.splat %cur_head_53 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_56 = arith.extsi %cur_head_55 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_57 = arith.extsi %cur_head_54 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_58 = arith.addi %cur_head_56, %cur_head_57 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_59 = arith.constant 2147483647 : i64 loc(#loc431)
    %cur_head_60 = arith.constant -2147483648 : i64 loc(#loc431)
    %cur_head_61 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_62 = arith.cmpi sle, %cur_head_58, %cur_head_61 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_63 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_64 = arith.cmpi sge, %cur_head_58, %cur_head_63 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_65 = arith.andi %cur_head_62, %cur_head_64 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %cur_head_66 = arith.addi %cur_head_55, %cur_head_54 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc431)
    %mask_h = arith.constant 1 : i32 loc(#loc432)
    %mask_h_67 = arith.constant 1 : i32 loc(#loc432)
    %mask_h_68 = arith.extsi %cur_head_id : i32 to i64 loc(#loc432)
    %mask_h_69 = arith.extsi %mask_h_67 : i32 to i64 loc(#loc432)
    %mask_h_70 = arith.addi %mask_h_68, %mask_h_69 : i64 loc(#loc432)
    %mask_h_71 = arith.constant 2147483647 : i64 loc(#loc432)
    %mask_h_72 = arith.constant -2147483648 : i64 loc(#loc432)
    %mask_h_73 = arith.cmpi sle, %mask_h_70, %mask_h_71 : i64 loc(#loc432)
    %mask_h_74 = arith.cmpi sge, %mask_h_70, %mask_h_72 : i64 loc(#loc432)
    %mask_h_75 = arith.andi %mask_h_73, %mask_h_74 : i1 loc(#loc432)
    %mask_h_76 = arith.addi %cur_head_id, %mask_h_67 : i32 loc(#loc432)
    %mask_h_77 = arith.constant 8 : i32 loc(#loc433)
    %mask_h_78 = arith.constant 8 : i32 loc(#loc433)
    %mask_h_79 = arith.extsi %mask_h_76 : i32 to i64 loc(#loc433)
    %mask_h_80 = arith.extsi %mask_h_78 : i32 to i64 loc(#loc433)
    %mask_h_81 = arith.muli %mask_h_79, %mask_h_80 : i64 loc(#loc433)
    %mask_h_82 = arith.constant 2147483647 : i64 loc(#loc433)
    %mask_h_83 = arith.constant -2147483648 : i64 loc(#loc433)
    %mask_h_84 = arith.cmpi sle, %mask_h_81, %mask_h_82 : i64 loc(#loc433)
    %mask_h_85 = arith.cmpi sge, %mask_h_81, %mask_h_83 : i64 loc(#loc433)
    %mask_h_86 = arith.andi %mask_h_84, %mask_h_85 : i1 loc(#loc433)
    %mask_h_87 = arith.muli %mask_h_76, %mask_h_78 : i32 loc(#loc433)
    %mask_h_88 = tt.splat %mask_h_87 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc434)
    %mask_h_89 = arith.cmpi slt, %cur_head_66, %mask_h_88 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc434)
    %mask_h_90 = arith.constant 8 : i32 loc(#loc435)
    %mask_h_91 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc435)
    %mask_h_92 = arith.cmpi slt, %cur_head_66, %mask_h_91 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc435)
    %mask_h_93 = arith.andi %mask_h_89, %mask_h_92 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc436)
    %cur_N = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc437)
    %cur_N_pe = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc438)
    %cur_head_pe = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc439)
    %mask_h_pe = arith.constant 8 : i32 loc(#loc440)
    %mask_h_pe_94 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc440)
    %mask_h_pe_95 = arith.cmpi slt, %cur_head_pe, %mask_h_pe_94 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc440)
    %mask_h_pe_96 = arith.constant 8 : i32 loc(#loc441)
    %mask_h_pe_97 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc441)
    %mask_h_pe_98 = arith.cmpi slt, %cur_head_pe, %mask_h_pe_97 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc441)
    %mask_h_pe_99 = arith.andi %mask_h_pe_95, %mask_h_pe_98 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc442)
    %offs_c = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc443)
    %offs_om = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc444)
    %mask_om = arith.constant 8 : i32 loc(#loc445)
    %mask_om_100 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc445)
    %mask_om_101 = arith.cmpi slt, %offs_om, %mask_om_100 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc445)
    %mask_om_102 = arith.constant 8 : i32 loc(#loc446)
    %mask_om_103 = arith.constant dense<8> : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc446)
    %mask_om_104 = arith.cmpi slt, %offs_om, %mask_om_103 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc446)
    %mask_om_105 = arith.andi %mask_om_101, %mask_om_104 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc447)
    %offs_on = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc448)
    %mask_on = arith.constant 512 : i32 loc(#loc449)
    %mask_on_106 = arith.constant dense<512> : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc449)
    %mask_on_107 = arith.cmpi slt, %offs_on, %mask_on_106 : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc449)
    %offs_qk_r = tt.make_range {end = 576 : i32, start = 512 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc450)
    %offs_k_c = tt.make_range {end = 256 : i32, start = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc451)
    %offs_k_r = tt.make_range {end = 576 : i32, start = 512 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc452)
    %cur_batch_seq_len = arith.extsi %cur_batch_kv_end_idx_43 : i32 to i64 loc(#loc453)
    %cur_batch_seq_len_108 = arith.extsi %cur_batch_kv_start_idx_40 : i32 to i64 loc(#loc453)
    %cur_batch_seq_len_109 = arith.subi %cur_batch_seq_len, %cur_batch_seq_len_108 : i64 loc(#loc453)
    %cur_batch_seq_len_110 = arith.constant 2147483647 : i64 loc(#loc453)
    %cur_batch_seq_len_111 = arith.constant -2147483648 : i64 loc(#loc453)
    %cur_batch_seq_len_112 = arith.cmpi sle, %cur_batch_seq_len_109, %cur_batch_seq_len_110 : i64 loc(#loc453)
    %cur_batch_seq_len_113 = arith.cmpi sge, %cur_batch_seq_len_109, %cur_batch_seq_len_111 : i64 loc(#loc453)
    %cur_batch_seq_len_114 = arith.andi %cur_batch_seq_len_112, %cur_batch_seq_len_113 : i1 loc(#loc453)
    %cur_batch_seq_len_115 = arith.subi %cur_batch_kv_end_idx_43, %cur_batch_kv_start_idx_40 : i32 loc(#loc453)
    %cur_batch_block_nums = tt.call @"triton.language.standard.cdiv__i32__(1,)cconstexpr_64_"(%cur_batch_seq_len_115) : (i32) -> i32 loc(#loc454)
    %off_q_pe = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc455)
    %off_q_pe_116 = arith.extsi %stride_qb : i32 to i64 loc(#loc455)
    %off_q_pe_117 = arith.muli %off_q_pe, %off_q_pe_116 : i64 loc(#loc455)
    %off_q_pe_118 = arith.constant 2147483647 : i64 loc(#loc455)
    %off_q_pe_119 = arith.constant -2147483648 : i64 loc(#loc455)
    %off_q_pe_120 = arith.cmpi sle, %off_q_pe_117, %off_q_pe_118 : i64 loc(#loc455)
    %off_q_pe_121 = arith.cmpi sge, %off_q_pe_117, %off_q_pe_119 : i64 loc(#loc455)
    %off_q_pe_122 = arith.andi %off_q_pe_120, %off_q_pe_121 : i1 loc(#loc455)
    %off_q_pe_123 = arith.muli %cur_batch_39, %stride_qb : i32 loc(#loc455)
    %off_q_pe_124 = tt.expand_dims %cur_head_pe {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<16x1xi32, #blocked3> loc(#loc456)
    %off_q_pe_125 = tt.splat %stride_qh : i32 -> tensor<16x1xi32, #blocked3> loc(#loc457)
    %off_q_pe_126 = arith.extsi %off_q_pe_124 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_127 = arith.extsi %off_q_pe_125 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_128 = arith.muli %off_q_pe_126, %off_q_pe_127 : tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_129 = arith.constant 2147483647 : i64 loc(#loc457)
    %off_q_pe_130 = arith.constant -2147483648 : i64 loc(#loc457)
    %off_q_pe_131 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_132 = arith.cmpi sle, %off_q_pe_128, %off_q_pe_131 : tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_133 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_134 = arith.cmpi sge, %off_q_pe_128, %off_q_pe_133 : tensor<16x1xi64, #blocked3> loc(#loc457)
    %off_q_pe_135 = arith.andi %off_q_pe_132, %off_q_pe_134 : tensor<16x1xi1, #blocked3> loc(#loc457)
    %off_q_pe_136 = arith.muli %off_q_pe_124, %off_q_pe_125 : tensor<16x1xi32, #blocked3> loc(#loc457)
    %off_q_pe_137 = tt.splat %off_q_pe_123 : i32 -> tensor<16x1xi32, #blocked3> loc(#loc458)
    %off_q_pe_138 = arith.extsi %off_q_pe_137 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_139 = arith.extsi %off_q_pe_136 : tensor<16x1xi32, #blocked3> to tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_140 = arith.addi %off_q_pe_138, %off_q_pe_139 : tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_141 = arith.constant 2147483647 : i64 loc(#loc458)
    %off_q_pe_142 = arith.constant -2147483648 : i64 loc(#loc458)
    %off_q_pe_143 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_144 = arith.cmpi sle, %off_q_pe_140, %off_q_pe_143 : tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_145 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_146 = arith.cmpi sge, %off_q_pe_140, %off_q_pe_145 : tensor<16x1xi64, #blocked3> loc(#loc458)
    %off_q_pe_147 = arith.andi %off_q_pe_144, %off_q_pe_146 : tensor<16x1xi1, #blocked3> loc(#loc458)
    %off_q_pe_148 = arith.addi %off_q_pe_137, %off_q_pe_136 : tensor<16x1xi32, #blocked3> loc(#loc458)
    %off_q_pe_149 = tt.expand_dims %offs_qk_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> -> tensor<1x64xi32, #blocked3> loc(#loc459)
    %off_q_pe_150 = tt.broadcast %off_q_pe_148 : tensor<16x1xi32, #blocked3> -> tensor<16x64xi32, #blocked3> loc(#loc460)
    %off_q_pe_151 = tt.broadcast %off_q_pe_149 : tensor<1x64xi32, #blocked3> -> tensor<16x64xi32, #blocked3> loc(#loc460)
    %off_q_pe_152 = arith.extsi %off_q_pe_150 : tensor<16x64xi32, #blocked3> to tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_153 = arith.extsi %off_q_pe_151 : tensor<16x64xi32, #blocked3> to tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_154 = arith.addi %off_q_pe_152, %off_q_pe_153 : tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_155 = arith.constant 2147483647 : i64 loc(#loc460)
    %off_q_pe_156 = arith.constant -2147483648 : i64 loc(#loc460)
    %off_q_pe_157 = arith.constant dense<2147483647> : tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_158 = arith.cmpi sle, %off_q_pe_154, %off_q_pe_157 : tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_159 = arith.constant dense<-2147483648> : tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_160 = arith.cmpi sge, %off_q_pe_154, %off_q_pe_159 : tensor<16x64xi64, #blocked3> loc(#loc460)
    %off_q_pe_161 = arith.andi %off_q_pe_158, %off_q_pe_160 : tensor<16x64xi1, #blocked3> loc(#loc460)
    %off_q_pe_162 = arith.addi %off_q_pe_150, %off_q_pe_151 : tensor<16x64xi32, #blocked3> loc(#loc460)
    %offs_q = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc461)
    %offs_q_163 = arith.extsi %stride_qb : i32 to i64 loc(#loc461)
    %offs_q_164 = arith.muli %offs_q, %offs_q_163 : i64 loc(#loc461)
    %offs_q_165 = arith.constant 2147483647 : i64 loc(#loc461)
    %offs_q_166 = arith.constant -2147483648 : i64 loc(#loc461)
    %offs_q_167 = arith.cmpi sle, %offs_q_164, %offs_q_165 : i64 loc(#loc461)
    %offs_q_168 = arith.cmpi sge, %offs_q_164, %offs_q_166 : i64 loc(#loc461)
    %offs_q_169 = arith.andi %offs_q_167, %offs_q_168 : i1 loc(#loc461)
    %offs_q_170 = arith.muli %cur_batch_39, %stride_qb : i32 loc(#loc461)
    %offs_q_171 = tt.expand_dims %cur_head_66 {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi32, #blocked> loc(#loc462)
    %offs_q_172 = tt.splat %stride_qh : i32 -> tensor<16x1xi32, #blocked> loc(#loc463)
    %offs_q_173 = arith.extsi %offs_q_171 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_174 = arith.extsi %offs_q_172 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_175 = arith.muli %offs_q_173, %offs_q_174 : tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_176 = arith.constant 2147483647 : i64 loc(#loc463)
    %offs_q_177 = arith.constant -2147483648 : i64 loc(#loc463)
    %offs_q_178 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_179 = arith.cmpi sle, %offs_q_175, %offs_q_178 : tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_180 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_181 = arith.cmpi sge, %offs_q_175, %offs_q_180 : tensor<16x1xi64, #blocked> loc(#loc463)
    %offs_q_182 = arith.andi %offs_q_179, %offs_q_181 : tensor<16x1xi1, #blocked> loc(#loc463)
    %offs_q_183 = arith.muli %offs_q_171, %offs_q_172 : tensor<16x1xi32, #blocked> loc(#loc463)
    %offs_q_184 = tt.splat %offs_q_170 : i32 -> tensor<16x1xi32, #blocked> loc(#loc464)
    %offs_q_185 = arith.extsi %offs_q_184 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_186 = arith.extsi %offs_q_183 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_187 = arith.addi %offs_q_185, %offs_q_186 : tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_188 = arith.constant 2147483647 : i64 loc(#loc464)
    %offs_q_189 = arith.constant -2147483648 : i64 loc(#loc464)
    %offs_q_190 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_191 = arith.cmpi sle, %offs_q_187, %offs_q_190 : tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_192 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_193 = arith.cmpi sge, %offs_q_187, %offs_q_192 : tensor<16x1xi64, #blocked> loc(#loc464)
    %offs_q_194 = arith.andi %offs_q_191, %offs_q_193 : tensor<16x1xi1, #blocked> loc(#loc464)
    %offs_q_195 = arith.addi %offs_q_184, %offs_q_183 : tensor<16x1xi32, #blocked> loc(#loc464)
    %offs_q_196 = tt.expand_dims %offs_c {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc465)
    %offs_q_197 = tt.broadcast %offs_q_195 : tensor<16x1xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc466)
    %offs_q_198 = tt.broadcast %offs_q_196 : tensor<1x512xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc466)
    %offs_q_199 = arith.extsi %offs_q_197 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_200 = arith.extsi %offs_q_198 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_201 = arith.addi %offs_q_199, %offs_q_200 : tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_202 = arith.constant 2147483647 : i64 loc(#loc466)
    %offs_q_203 = arith.constant -2147483648 : i64 loc(#loc466)
    %offs_q_204 = arith.constant dense<2147483647> : tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_205 = arith.cmpi sle, %offs_q_201, %offs_q_204 : tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_206 = arith.constant dense<-2147483648> : tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_207 = arith.cmpi sge, %offs_q_201, %offs_q_206 : tensor<16x512xi64, #blocked> loc(#loc466)
    %offs_q_208 = arith.andi %offs_q_205, %offs_q_207 : tensor<16x512xi1, #blocked> loc(#loc466)
    %offs_q_209 = arith.addi %offs_q_197, %offs_q_198 : tensor<16x512xi32, #blocked> loc(#loc466)
    %mask_c = arith.constant 512 : i32 loc(#loc467)
    %mask_c_210 = arith.constant dense<512> : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc467)
    %mask_c_211 = arith.cmpi slt, %offs_c, %mask_c_210 : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc467)
    %mask_k_c = arith.constant 512 : i32 loc(#loc468)
    %mask_k_c_212 = arith.constant dense<512> : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc468)
    %mask_k_c_213 = arith.cmpi slt, %offs_k_c, %mask_k_c_212 : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc468)
    %mask_qk_r = arith.constant 576 : i32 loc(#loc469)
    %mask_qk_r_214 = arith.constant dense<576> : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc469)
    %mask_qk_r_215 = arith.cmpi slt, %offs_qk_r, %mask_qk_r_214 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked3}>> loc(#loc469)
    %mask_k_r = arith.constant 576 : i32 loc(#loc470)
    %mask_k_r_216 = arith.constant dense<576> : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc470)
    %mask_k_r_217 = arith.cmpi slt, %offs_k_r, %mask_k_r_216 : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc470)
    %blocks_per_split = tt.call @"triton.language.standard.cdiv__i32__(1,)cconstexpr_8_"(%cur_batch_block_nums) : (i32) -> i32 loc(#loc471)
    %split_kv_start = arith.extsi %blocks_per_split : i32 to i64 loc(#loc472)
    %split_kv_start_218 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc472)
    %split_kv_start_219 = arith.muli %split_kv_start, %split_kv_start_218 : i64 loc(#loc472)
    %split_kv_start_220 = arith.constant 2147483647 : i64 loc(#loc472)
    %split_kv_start_221 = arith.constant -2147483648 : i64 loc(#loc472)
    %split_kv_start_222 = arith.cmpi sle, %split_kv_start_219, %split_kv_start_220 : i64 loc(#loc472)
    %split_kv_start_223 = arith.cmpi sge, %split_kv_start_219, %split_kv_start_221 : i64 loc(#loc472)
    %split_kv_start_224 = arith.andi %split_kv_start_222, %split_kv_start_223 : i1 loc(#loc472)
    %split_kv_start_225 = arith.muli %blocks_per_split, %split_kv_id_25 : i32 loc(#loc472)
    %c64_i32 = arith.constant 64 : i32 loc(#loc68)
    %c64_i32_226 = arith.constant 64 : i32 loc(#loc68)
    %0 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc68)
    %1 = arith.extsi %c64_i32_226 : i32 to i64 loc(#loc68)
    %2 = arith.muli %0, %1 : i64 loc(#loc68)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc68)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc68)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc68)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc68)
    %5 = arith.andi %3, %4 : i1 loc(#loc68)
    %6 = arith.muli %split_kv_start_225, %c64_i32_226 : i32 loc(#loc68)
    %7 = arith.cmpi sgt, %6, %cur_batch_seq_len_115 : i32 loc(#loc69)
    cf.cond_br %7, ^bb1, ^bb2 loc(#loc69)
  ^bb1:  // pred: ^bb0
    tt.return loc(#loc70)
  ^bb2:  // pred: ^bb0
    cf.br ^bb4 loc(#loc)
  ^bb3:  // no predecessors
    cf.br ^bb4 loc(#loc)
  ^bb4:  // 2 preds: ^bb2, ^bb3
    %tail_block = arith.constant false loc(#loc719)
    %8 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc72)
    %9 = arith.extsi %blocks_per_split : i32 to i64 loc(#loc72)
    %10 = arith.addi %8, %9 : i64 loc(#loc72)
    %c2147483647_i64_227 = arith.constant 2147483647 : i64 loc(#loc72)
    %c-2147483648_i64_228 = arith.constant -2147483648 : i64 loc(#loc72)
    %11 = arith.cmpi sle, %10, %c2147483647_i64_227 : i64 loc(#loc72)
    %12 = arith.cmpi sge, %10, %c-2147483648_i64_228 : i64 loc(#loc72)
    %13 = arith.andi %11, %12 : i1 loc(#loc72)
    %14 = arith.addi %split_kv_start_225, %blocks_per_split : i32 loc(#loc72)
    %c64_i32_229 = arith.constant 64 : i32 loc(#loc73)
    %c64_i32_230 = arith.constant 64 : i32 loc(#loc73)
    %15 = arith.extsi %14 : i32 to i64 loc(#loc73)
    %16 = arith.extsi %c64_i32_230 : i32 to i64 loc(#loc73)
    %17 = arith.muli %15, %16 : i64 loc(#loc73)
    %c2147483647_i64_231 = arith.constant 2147483647 : i64 loc(#loc73)
    %c-2147483648_i64_232 = arith.constant -2147483648 : i64 loc(#loc73)
    %18 = arith.cmpi sle, %17, %c2147483647_i64_231 : i64 loc(#loc73)
    %19 = arith.cmpi sge, %17, %c-2147483648_i64_232 : i64 loc(#loc73)
    %20 = arith.andi %18, %19 : i1 loc(#loc73)
    %21 = arith.muli %14, %c64_i32_230 : i32 loc(#loc73)
    %22 = arith.cmpi sgt, %21, %cur_batch_seq_len_115 : i32 loc(#loc74)
    %23 = scf.if %22 -> (i1) {
      %tail_block_724 = arith.constant true loc(#loc720)
      scf.yield %tail_block_724 : i1 loc(#loc720)
    } else {
      scf.yield %tail_block : i1 loc(#loc)
    } loc(#loc75)
    %split_kv_end = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc475)
    %split_kv_end_233 = arith.extsi %blocks_per_split : i32 to i64 loc(#loc475)
    %split_kv_end_234 = arith.addi %split_kv_end, %split_kv_end_233 : i64 loc(#loc475)
    %split_kv_end_235 = arith.constant 2147483647 : i64 loc(#loc475)
    %split_kv_end_236 = arith.constant -2147483648 : i64 loc(#loc475)
    %split_kv_end_237 = arith.cmpi sle, %split_kv_end_234, %split_kv_end_235 : i64 loc(#loc475)
    %split_kv_end_238 = arith.cmpi sge, %split_kv_end_234, %split_kv_end_236 : i64 loc(#loc475)
    %split_kv_end_239 = arith.andi %split_kv_end_237, %split_kv_end_238 : i1 loc(#loc475)
    %split_kv_end_240 = arith.addi %split_kv_start_225, %blocks_per_split : i32 loc(#loc475)
    %split_kv_end_241 = arith.minsi %split_kv_end_240, %cur_batch_block_nums : i32 loc(#loc476)
    %block_tail = arith.constant 1 : i32 loc(#loc477)
    %block_tail_242 = arith.constant 1 : i32 loc(#loc477)
    %block_tail_243 = arith.extsi %cur_batch_seq_len_115 : i32 to i64 loc(#loc477)
    %block_tail_244 = arith.extsi %block_tail_242 : i32 to i64 loc(#loc477)
    %block_tail_245 = arith.subi %block_tail_243, %block_tail_244 : i64 loc(#loc477)
    %block_tail_246 = arith.constant 2147483647 : i64 loc(#loc477)
    %block_tail_247 = arith.constant -2147483648 : i64 loc(#loc477)
    %block_tail_248 = arith.cmpi sle, %block_tail_245, %block_tail_246 : i64 loc(#loc477)
    %block_tail_249 = arith.cmpi sge, %block_tail_245, %block_tail_247 : i64 loc(#loc477)
    %block_tail_250 = arith.andi %block_tail_248, %block_tail_249 : i1 loc(#loc477)
    %block_tail_251 = arith.subi %cur_batch_seq_len_115, %block_tail_242 : i32 loc(#loc477)
    %block_tail_252 = arith.constant 64 : i32 loc(#loc478)
    %block_tail_253 = arith.constant 64 : i32 loc(#loc478)
    %block_tail_254 = arith.remsi %block_tail_251, %block_tail_253 : i32 loc(#loc478)
    %block_tail_255 = arith.constant 32 : i32 loc(#loc479)
    %block_tail_256 = arith.constant 32 : i32 loc(#loc479)
    %block_tail_257 = arith.divsi %block_tail_254, %block_tail_256 : i32 loc(#loc479)
    %q = tt.expand_dims %mask_h_93 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi1, #blocked> loc(#loc480)
    %q_258 = tt.expand_dims %mask_c_211 {axis = 0 : i32} : tensor<512xi1, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi1, #blocked> loc(#loc481)
    %q_259 = tt.broadcast %q : tensor<16x1xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc482)
    %q_260 = tt.broadcast %q_258 : tensor<1x512xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc482)
    %q_261 = arith.andi %q_259, %q_260 : tensor<16x512xi1, #blocked> loc(#loc482)
    %q_262 = amdgpu.buffer_load %Q[%offs_q_209], %q_261 : tensor<16x512xbf16, #blocked> loc(#loc483)
    %q_pe = tt.expand_dims %mask_h_pe_99 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<16x1xi1, #blocked3> loc(#loc484)
    %q_pe_263 = tt.expand_dims %mask_qk_r_215 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked3}>> -> tensor<1x64xi1, #blocked3> loc(#loc485)
    %q_pe_264 = tt.broadcast %q_pe : tensor<16x1xi1, #blocked3> -> tensor<16x64xi1, #blocked3> loc(#loc486)
    %q_pe_265 = tt.broadcast %q_pe_263 : tensor<1x64xi1, #blocked3> -> tensor<16x64xi1, #blocked3> loc(#loc486)
    %q_pe_266 = arith.andi %q_pe_264, %q_pe_265 : tensor<16x64xi1, #blocked3> loc(#loc486)
    %q_pe_267 = amdgpu.buffer_load %Q[%off_q_pe_162], %q_pe_266 : tensor<16x64xbf16, #blocked3> loc(#loc487)
    %kv_loc = tt.addptr %kv_indices, %split_kv_start_225 : !tt.ptr<i32>, i32 loc(#loc488)
    %kv_loc_268 = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc489)
    %kv_loc_269 = arith.extsi %stride_b_block_table : i32 to i64 loc(#loc489)
    %kv_loc_270 = arith.muli %kv_loc_268, %kv_loc_269 : i64 loc(#loc489)
    %kv_loc_271 = arith.constant 2147483647 : i64 loc(#loc489)
    %kv_loc_272 = arith.constant -2147483648 : i64 loc(#loc489)
    %kv_loc_273 = arith.cmpi sle, %kv_loc_270, %kv_loc_271 : i64 loc(#loc489)
    %kv_loc_274 = arith.cmpi sge, %kv_loc_270, %kv_loc_272 : i64 loc(#loc489)
    %kv_loc_275 = arith.andi %kv_loc_273, %kv_loc_274 : i1 loc(#loc489)
    %kv_loc_276 = arith.muli %cur_batch_39, %stride_b_block_table : i32 loc(#loc489)
    %kv_loc_277 = tt.addptr %kv_loc, %kv_loc_276 : !tt.ptr<i32>, i32 loc(#loc490)
    %kv_loc_278 = tt.load %kv_loc_277 : !tt.ptr<i32> loc(#loc491)
    %q_279 = tt.reshape %q_262 : tensor<16x512xbf16, #blocked> -> tensor<16x2x256xbf16, #blocked4> loc(#loc492)
    %q_280 = tt.trans %q_279 {order = array<i32: 0, 2, 1>} : tensor<16x2x256xbf16, #blocked4> -> tensor<16x256x2xbf16, #blocked5> loc(#loc493)
    %outLHS, %outRHS = tt.split %q_280 : tensor<16x256x2xbf16, #blocked5> -> tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> loc(#loc96)
    ttg.local_store %outLHS, %smem_q0_nope : tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc97)
    ttg.local_store %outRHS, %smem_q1_nope : tensor<16x256xbf16, #ttg.slice<{dim = 2, parent = #blocked5}>> -> !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc98)
    %q0 = ttg.local_load %smem_q0_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> -> tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc494)
    %q1 = ttg.local_load %smem_q1_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> -> tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc495)
    ttg.local_store %q_pe_267, %smem_q_rope : tensor<16x64xbf16, #blocked3> -> !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc101)
    %q_pe_281 = ttg.local_load %smem_q_rope : !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> -> tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> loc(#loc496)
    ttg.local_dealloc %smem_q0_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc103)
    ttg.local_dealloc %smem_q1_nope : !ttg.memdesc<16x256xbf16, #shared, #smem, mutable> loc(#loc104)
    ttg.local_dealloc %smem_q_rope : !ttg.memdesc<16x64xbf16, #shared, #smem, mutable> loc(#loc105)
    %smem_k_rope = ttg.local_alloc : () -> !ttg.memdesc<64x32xbf16, #shared2, #smem, mutable> loc(#loc497)
    %acc1 = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16 ,16), transposed=True, warps_per_cta=(1 ,4), elem_type=triton_d_language_d_float32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x256xf32, #mma> loc(#loc498)
    %acc2 = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16 ,16), transposed=True, warps_per_cta=(1 ,4), elem_type=triton_d_language_d_float32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x256xf32, #mma> loc(#loc499)
    %zeros = tt.call @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_32__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16 ,16), transposed=True, warps_per_cta=(1 ,4), elem_type=triton_d_language_d_float32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() : () -> tensor<16x32xf32, #mma> loc(#loc500)
    %k_id = arith.constant 64 : i32 loc(#loc501)
    %k_id_282 = arith.constant 64 : i32 loc(#loc501)
    %k_id_283 = arith.extsi %kv_loc_278 : i32 to i64 loc(#loc501)
    %k_id_284 = arith.extsi %k_id_282 : i32 to i64 loc(#loc501)
    %k_id_285 = arith.muli %k_id_283, %k_id_284 : i64 loc(#loc501)
    %k_id_286 = arith.constant 2147483647 : i64 loc(#loc501)
    %k_id_287 = arith.constant -2147483648 : i64 loc(#loc501)
    %k_id_288 = arith.cmpi sle, %k_id_285, %k_id_286 : i64 loc(#loc501)
    %k_id_289 = arith.cmpi sge, %k_id_285, %k_id_287 : i64 loc(#loc501)
    %k_id_290 = arith.andi %k_id_288, %k_id_289 : i1 loc(#loc501)
    %k_id_291 = arith.muli %kv_loc_278, %k_id_282 : i32 loc(#loc501)
    %k_id_292 = tt.splat %k_id_291 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_293 = arith.extsi %k_id_292 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_294 = arith.extsi %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_295 = arith.addi %k_id_293, %k_id_294 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_296 = arith.constant 2147483647 : i64 loc(#loc502)
    %k_id_297 = arith.constant -2147483648 : i64 loc(#loc502)
    %k_id_298 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_299 = arith.cmpi sle, %k_id_295, %k_id_298 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_300 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_301 = arith.cmpi sge, %k_id_295, %k_id_300 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_302 = arith.andi %k_id_299, %k_id_301 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %k_id_303 = arith.addi %k_id_292, %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc502)
    %mask_k_id = arith.constant 64 : i32 loc(#loc503)
    %mask_k_id_304 = arith.constant 64 : i32 loc(#loc503)
    %mask_k_id_305 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc503)
    %mask_k_id_306 = arith.extsi %mask_k_id_304 : i32 to i64 loc(#loc503)
    %mask_k_id_307 = arith.muli %mask_k_id_305, %mask_k_id_306 : i64 loc(#loc503)
    %mask_k_id_308 = arith.constant 2147483647 : i64 loc(#loc503)
    %mask_k_id_309 = arith.constant -2147483648 : i64 loc(#loc503)
    %mask_k_id_310 = arith.cmpi sle, %mask_k_id_307, %mask_k_id_308 : i64 loc(#loc503)
    %mask_k_id_311 = arith.cmpi sge, %mask_k_id_307, %mask_k_id_309 : i64 loc(#loc503)
    %mask_k_id_312 = arith.andi %mask_k_id_310, %mask_k_id_311 : i1 loc(#loc503)
    %mask_k_id_313 = arith.muli %split_kv_start_225, %mask_k_id_304 : i32 loc(#loc503)
    %mask_k_id_314 = tt.splat %mask_k_id_313 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_315 = arith.extsi %mask_k_id_314 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_316 = arith.extsi %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_317 = arith.addi %mask_k_id_315, %mask_k_id_316 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_318 = arith.constant 2147483647 : i64 loc(#loc504)
    %mask_k_id_319 = arith.constant -2147483648 : i64 loc(#loc504)
    %mask_k_id_320 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_321 = arith.cmpi sle, %mask_k_id_317, %mask_k_id_320 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_322 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_323 = arith.cmpi sge, %mask_k_id_317, %mask_k_id_322 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_324 = arith.andi %mask_k_id_321, %mask_k_id_323 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k_id_325 = arith.addi %mask_k_id_314, %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc504)
    %mask_k = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc505)
    %mask_k_326 = arith.cmpi slt, %mask_k_id_325, %mask_k : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc505)
    %offs_buf_kv = tt.expand_dims %k_id_303 {axis = 1 : i32} : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<32x1xi32, #blocked1> loc(#loc506)
    %offs_buf_kv_327 = tt.splat %stride_buf_kh : i32 -> tensor<32x1xi32, #blocked1> loc(#loc507)
    %offs_buf_kv_328 = arith.extsi %offs_buf_kv : tensor<32x1xi32, #blocked1> to tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_329 = arith.extsi %offs_buf_kv_327 : tensor<32x1xi32, #blocked1> to tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_330 = arith.muli %offs_buf_kv_328, %offs_buf_kv_329 : tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_331 = arith.constant 2147483647 : i64 loc(#loc507)
    %offs_buf_kv_332 = arith.constant -2147483648 : i64 loc(#loc507)
    %offs_buf_kv_333 = arith.constant dense<2147483647> : tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_334 = arith.cmpi sle, %offs_buf_kv_330, %offs_buf_kv_333 : tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_335 = arith.constant dense<-2147483648> : tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_336 = arith.cmpi sge, %offs_buf_kv_330, %offs_buf_kv_335 : tensor<32x1xi64, #blocked1> loc(#loc507)
    %offs_buf_kv_337 = arith.andi %offs_buf_kv_334, %offs_buf_kv_336 : tensor<32x1xi1, #blocked1> loc(#loc507)
    %offs_buf_kv_338 = arith.muli %offs_buf_kv, %offs_buf_kv_327 : tensor<32x1xi32, #blocked1> loc(#loc507)
    %offs_buf_kv_339 = tt.expand_dims %offs_k_c {axis = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi32, #blocked1> loc(#loc508)
    %offs_buf_kv_340 = tt.broadcast %offs_buf_kv_338 : tensor<32x1xi32, #blocked1> -> tensor<32x256xi32, #blocked1> loc(#loc509)
    %offs_buf_kv_341 = tt.broadcast %offs_buf_kv_339 : tensor<1x256xi32, #blocked1> -> tensor<32x256xi32, #blocked1> loc(#loc509)
    %offs_buf_kv_342 = arith.extsi %offs_buf_kv_340 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_343 = arith.extsi %offs_buf_kv_341 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_344 = arith.addi %offs_buf_kv_342, %offs_buf_kv_343 : tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_345 = arith.constant 2147483647 : i64 loc(#loc509)
    %offs_buf_kv_346 = arith.constant -2147483648 : i64 loc(#loc509)
    %offs_buf_kv_347 = arith.constant dense<2147483647> : tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_348 = arith.cmpi sle, %offs_buf_kv_344, %offs_buf_kv_347 : tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_349 = arith.constant dense<-2147483648> : tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_350 = arith.cmpi sge, %offs_buf_kv_344, %offs_buf_kv_349 : tensor<32x256xi64, #blocked1> loc(#loc509)
    %offs_buf_kv_351 = arith.andi %offs_buf_kv_348, %offs_buf_kv_350 : tensor<32x256xi1, #blocked1> loc(#loc509)
    %offs_buf_kv_352 = arith.addi %offs_buf_kv_340, %offs_buf_kv_341 : tensor<32x256xi32, #blocked1> loc(#loc509)
    %kv1 = tt.expand_dims %mask_k_326 {axis = 1 : i32} : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<32x1xi1, #blocked1> loc(#loc510)
    %kv1_353 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc511)
    %kv1_354 = tt.broadcast %kv1 : tensor<32x1xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc512)
    %kv1_355 = tt.broadcast %kv1_353 : tensor<1x256xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc512)
    %kv1_356 = arith.andi %kv1_354, %kv1_355 : tensor<32x256xi1, #blocked1> loc(#loc512)
    %kv1_357 = amdgpu.buffer_load %K_Buffer[%offs_buf_kv_352], %kv1_356 : tensor<32x256xbf16, #blocked1> loc(#loc513)
    %kv2 = arith.constant 256 : i32 loc(#loc514)
    %kv2_358 = arith.constant 256 : i32 loc(#loc514)
    %kv2_359 = arith.constant dense<256> : tensor<32x256xi32, #blocked1> loc(#loc514)
    %kv2_360 = arith.extsi %offs_buf_kv_352 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_361 = arith.extsi %kv2_359 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_362 = arith.addi %kv2_360, %kv2_361 : tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_363 = arith.constant 2147483647 : i64 loc(#loc514)
    %kv2_364 = arith.constant -2147483648 : i64 loc(#loc514)
    %kv2_365 = arith.constant dense<2147483647> : tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_366 = arith.cmpi sle, %kv2_362, %kv2_365 : tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_367 = arith.constant dense<-2147483648> : tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_368 = arith.cmpi sge, %kv2_362, %kv2_367 : tensor<32x256xi64, #blocked1> loc(#loc514)
    %kv2_369 = arith.andi %kv2_366, %kv2_368 : tensor<32x256xi1, #blocked1> loc(#loc514)
    %kv2_370 = arith.addi %offs_buf_kv_352, %kv2_359 : tensor<32x256xi32, #blocked1> loc(#loc514)
    %kv2_371 = tt.expand_dims %mask_k_326 {axis = 1 : i32} : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<32x1xi1, #blocked1> loc(#loc515)
    %kv2_372 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc516)
    %kv2_373 = tt.broadcast %kv2_371 : tensor<32x1xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc517)
    %kv2_374 = tt.broadcast %kv2_372 : tensor<1x256xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc517)
    %kv2_375 = arith.andi %kv2_373, %kv2_374 : tensor<32x256xi1, #blocked1> loc(#loc517)
    %kv2_376 = amdgpu.buffer_load %K_Buffer[%kv2_370], %kv2_375 : tensor<32x256xbf16, #blocked1> loc(#loc518)
    %smem_kv1 = ttg.local_alloc : () -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc519)
    %smem_kv2 = ttg.local_alloc : () -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc520)
    rocdl.sched.barrier 0 loc(#loc130)
    %24 = tt.trans %kv1_357 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc131)
    ttg.local_store %24, %smem_kv1 : tensor<256x32xbf16, #blocked6> -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc131)
    %25 = tt.trans %kv2_376 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc132)
    ttg.local_store %25, %smem_kv2 : tensor<256x32xbf16, #blocked6> -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc132)
    %k_id_pe = arith.constant 64 : i32 loc(#loc521)
    %k_id_pe_377 = arith.constant 64 : i32 loc(#loc521)
    %k_id_pe_378 = arith.extsi %kv_loc_278 : i32 to i64 loc(#loc521)
    %k_id_pe_379 = arith.extsi %k_id_pe_377 : i32 to i64 loc(#loc521)
    %k_id_pe_380 = arith.muli %k_id_pe_378, %k_id_pe_379 : i64 loc(#loc521)
    %k_id_pe_381 = arith.constant 2147483647 : i64 loc(#loc521)
    %k_id_pe_382 = arith.constant -2147483648 : i64 loc(#loc521)
    %k_id_pe_383 = arith.cmpi sle, %k_id_pe_380, %k_id_pe_381 : i64 loc(#loc521)
    %k_id_pe_384 = arith.cmpi sge, %k_id_pe_380, %k_id_pe_382 : i64 loc(#loc521)
    %k_id_pe_385 = arith.andi %k_id_pe_383, %k_id_pe_384 : i1 loc(#loc521)
    %k_id_pe_386 = arith.muli %kv_loc_278, %k_id_pe_377 : i32 loc(#loc521)
    %k_id_pe_387 = tt.splat %k_id_pe_386 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_388 = arith.extsi %k_id_pe_387 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_389 = arith.extsi %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_390 = arith.addi %k_id_pe_388, %k_id_pe_389 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_391 = arith.constant 2147483647 : i64 loc(#loc522)
    %k_id_pe_392 = arith.constant -2147483648 : i64 loc(#loc522)
    %k_id_pe_393 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_394 = arith.cmpi sle, %k_id_pe_390, %k_id_pe_393 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_395 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_396 = arith.cmpi sge, %k_id_pe_390, %k_id_pe_395 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_397 = arith.andi %k_id_pe_394, %k_id_pe_396 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %k_id_pe_398 = arith.addi %k_id_pe_387, %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc522)
    %offs_buf_k_pe = tt.expand_dims %k_id_pe_398 {axis = 1 : i32} : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<32x1xi32, #blocked2> loc(#loc523)
    %offs_buf_k_pe_399 = tt.splat %stride_buf_kh : i32 -> tensor<32x1xi32, #blocked2> loc(#loc524)
    %offs_buf_k_pe_400 = arith.extsi %offs_buf_k_pe : tensor<32x1xi32, #blocked2> to tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_401 = arith.extsi %offs_buf_k_pe_399 : tensor<32x1xi32, #blocked2> to tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_402 = arith.muli %offs_buf_k_pe_400, %offs_buf_k_pe_401 : tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_403 = arith.constant 2147483647 : i64 loc(#loc524)
    %offs_buf_k_pe_404 = arith.constant -2147483648 : i64 loc(#loc524)
    %offs_buf_k_pe_405 = arith.constant dense<2147483647> : tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_406 = arith.cmpi sle, %offs_buf_k_pe_402, %offs_buf_k_pe_405 : tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_407 = arith.constant dense<-2147483648> : tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_408 = arith.cmpi sge, %offs_buf_k_pe_402, %offs_buf_k_pe_407 : tensor<32x1xi64, #blocked2> loc(#loc524)
    %offs_buf_k_pe_409 = arith.andi %offs_buf_k_pe_406, %offs_buf_k_pe_408 : tensor<32x1xi1, #blocked2> loc(#loc524)
    %offs_buf_k_pe_410 = arith.muli %offs_buf_k_pe, %offs_buf_k_pe_399 : tensor<32x1xi32, #blocked2> loc(#loc524)
    %offs_buf_k_pe_411 = tt.expand_dims %offs_k_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc525)
    %offs_buf_k_pe_412 = tt.broadcast %offs_buf_k_pe_410 : tensor<32x1xi32, #blocked2> -> tensor<32x64xi32, #blocked2> loc(#loc526)
    %offs_buf_k_pe_413 = tt.broadcast %offs_buf_k_pe_411 : tensor<1x64xi32, #blocked2> -> tensor<32x64xi32, #blocked2> loc(#loc526)
    %offs_buf_k_pe_414 = arith.extsi %offs_buf_k_pe_412 : tensor<32x64xi32, #blocked2> to tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_415 = arith.extsi %offs_buf_k_pe_413 : tensor<32x64xi32, #blocked2> to tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_416 = arith.addi %offs_buf_k_pe_414, %offs_buf_k_pe_415 : tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_417 = arith.constant 2147483647 : i64 loc(#loc526)
    %offs_buf_k_pe_418 = arith.constant -2147483648 : i64 loc(#loc526)
    %offs_buf_k_pe_419 = arith.constant dense<2147483647> : tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_420 = arith.cmpi sle, %offs_buf_k_pe_416, %offs_buf_k_pe_419 : tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_421 = arith.constant dense<-2147483648> : tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_422 = arith.cmpi sge, %offs_buf_k_pe_416, %offs_buf_k_pe_421 : tensor<32x64xi64, #blocked2> loc(#loc526)
    %offs_buf_k_pe_423 = arith.andi %offs_buf_k_pe_420, %offs_buf_k_pe_422 : tensor<32x64xi1, #blocked2> loc(#loc526)
    %offs_buf_k_pe_424 = arith.addi %offs_buf_k_pe_412, %offs_buf_k_pe_413 : tensor<32x64xi32, #blocked2> loc(#loc526)
    %mask_k_id_425 = arith.constant 64 : i32 loc(#loc527)
    %mask_k_id_426 = arith.constant 64 : i32 loc(#loc527)
    %mask_k_id_427 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc527)
    %mask_k_id_428 = arith.extsi %mask_k_id_426 : i32 to i64 loc(#loc527)
    %mask_k_id_429 = arith.muli %mask_k_id_427, %mask_k_id_428 : i64 loc(#loc527)
    %mask_k_id_430 = arith.constant 2147483647 : i64 loc(#loc527)
    %mask_k_id_431 = arith.constant -2147483648 : i64 loc(#loc527)
    %mask_k_id_432 = arith.cmpi sle, %mask_k_id_429, %mask_k_id_430 : i64 loc(#loc527)
    %mask_k_id_433 = arith.cmpi sge, %mask_k_id_429, %mask_k_id_431 : i64 loc(#loc527)
    %mask_k_id_434 = arith.andi %mask_k_id_432, %mask_k_id_433 : i1 loc(#loc527)
    %mask_k_id_435 = arith.muli %split_kv_start_225, %mask_k_id_426 : i32 loc(#loc527)
    %mask_k_id_436 = tt.splat %mask_k_id_435 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_437 = arith.extsi %mask_k_id_436 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_438 = arith.extsi %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_439 = arith.addi %mask_k_id_437, %mask_k_id_438 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_440 = arith.constant 2147483647 : i64 loc(#loc528)
    %mask_k_id_441 = arith.constant -2147483648 : i64 loc(#loc528)
    %mask_k_id_442 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_443 = arith.cmpi sle, %mask_k_id_439, %mask_k_id_442 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_444 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_445 = arith.cmpi sge, %mask_k_id_439, %mask_k_id_444 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_446 = arith.andi %mask_k_id_443, %mask_k_id_445 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_id_447 = arith.addi %mask_k_id_436, %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc528)
    %mask_k_pe = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc529)
    %mask_k_pe_448 = arith.cmpi slt, %mask_k_id_447, %mask_k_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc529)
    %k_pe = tt.expand_dims %mask_k_pe_448 {axis = 1 : i32} : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<32x1xi1, #blocked2> loc(#loc530)
    %k_pe_449 = tt.expand_dims %mask_k_r_217 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi1, #blocked2> loc(#loc531)
    %k_pe_450 = tt.broadcast %k_pe : tensor<32x1xi1, #blocked2> -> tensor<32x64xi1, #blocked2> loc(#loc532)
    %k_pe_451 = tt.broadcast %k_pe_449 : tensor<1x64xi1, #blocked2> -> tensor<32x64xi1, #blocked2> loc(#loc532)
    %k_pe_452 = arith.andi %k_pe_450, %k_pe_451 : tensor<32x64xi1, #blocked2> loc(#loc532)
    %k_pe_453 = amdgpu.buffer_load %K_Buffer[%offs_buf_k_pe_424], %k_pe_452 : tensor<32x64xbf16, #blocked2> loc(#loc533)
    %e_sum = arith.constant 0.000000e+00 : f32 loc(#loc534)
    %e_sum_454 = arith.constant dense<0.000000e+00> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc534)
    %e_max = arith.constant 0x7F800000 : f32 loc(#loc535)
    %e_max_455 = arith.constant 0x7F800000 : f32 loc(#loc535)
    %e_max_456 = arith.constant dense<0x7F800000> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc535)
    %e_max_457 = arith.subf %e_sum_454, %e_max_456 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc535)
    %cur_k1 = ttg.local_load %smem_kv1 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc536)
    %cur_k2 = ttg.local_load %smem_kv2 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc537)
    %smem_kv1_458 = ttg.memdesc_reinterpret %smem_kv1 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc538)
    %kv1_transpose = tt.trans %kv1_357 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc539)
    %26 = tt.trans %kv1_transpose {order = array<i32: 1, 0>} : tensor<256x32xbf16, #blocked6> -> tensor<32x256xbf16, #blocked1> loc(#loc152)
    ttg.local_store %26, %smem_kv1_458 : tensor<32x256xbf16, #blocked1> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc152)
    %smem_kv2_459 = ttg.memdesc_reinterpret %smem_kv2 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc540)
    %kv2_transpose = tt.trans %kv2_376 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc541)
    %27 = tt.trans %kv2_transpose {order = array<i32: 1, 0>} : tensor<256x32xbf16, #blocked6> -> tensor<32x256xbf16, #blocked1> loc(#loc155)
    ttg.local_store %27, %smem_kv2_459 : tensor<32x256xbf16, #blocked1> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc155)
    %28 = tt.trans %k_pe_453 {order = array<i32: 1, 0>} : tensor<32x64xbf16, #blocked2> -> tensor<64x32xbf16, #blocked7> loc(#loc156)
    ttg.local_store %28, %smem_k_rope : tensor<64x32xbf16, #blocked7> -> !ttg.memdesc<64x32xbf16, #shared2, #smem, mutable> loc(#loc156)
    rocdl.sched.barrier 0 loc(#loc157)
    %mask_qk_h = tt.make_range {end = 16 : i32, start = 0 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc542)
    %loop_begin = arith.extsi %page_block_per_block_N : i32 to i64 loc(#loc543)
    %loop_begin_460 = arith.extsi %split_kv_start_225 : i32 to i64 loc(#loc543)
    %loop_begin_461 = arith.muli %loop_begin, %loop_begin_460 : i64 loc(#loc543)
    %loop_begin_462 = arith.constant 2147483647 : i64 loc(#loc543)
    %loop_begin_463 = arith.constant -2147483648 : i64 loc(#loc543)
    %loop_begin_464 = arith.cmpi sle, %loop_begin_461, %loop_begin_462 : i64 loc(#loc543)
    %loop_begin_465 = arith.cmpi sge, %loop_begin_461, %loop_begin_463 : i64 loc(#loc543)
    %loop_begin_466 = arith.andi %loop_begin_464, %loop_begin_465 : i1 loc(#loc543)
    %loop_begin_467 = arith.muli %page_block_per_block_N, %split_kv_start_225 : i32 loc(#loc543)
    %loop_begin_468 = arith.extsi %loop_begin_467 : i32 to i64 loc(#loc544)
    %loop_begin_469 = arith.extsi %page_block_per_block_N : i32 to i64 loc(#loc544)
    %loop_begin_470 = arith.addi %loop_begin_468, %loop_begin_469 : i64 loc(#loc544)
    %loop_begin_471 = arith.constant 2147483647 : i64 loc(#loc544)
    %loop_begin_472 = arith.constant -2147483648 : i64 loc(#loc544)
    %loop_begin_473 = arith.cmpi sle, %loop_begin_470, %loop_begin_471 : i64 loc(#loc544)
    %loop_begin_474 = arith.cmpi sge, %loop_begin_470, %loop_begin_472 : i64 loc(#loc544)
    %loop_begin_475 = arith.andi %loop_begin_473, %loop_begin_474 : i1 loc(#loc544)
    %loop_begin_476 = arith.addi %loop_begin_467, %page_block_per_block_N : i32 loc(#loc544)
    %loop_begin_477 = arith.constant 1 : i32 loc(#loc545)
    %loop_begin_478 = arith.constant 1 : i32 loc(#loc545)
    %loop_begin_479 = arith.extsi %loop_begin_476 : i32 to i64 loc(#loc545)
    %loop_begin_480 = arith.extsi %loop_begin_478 : i32 to i64 loc(#loc545)
    %loop_begin_481 = arith.subi %loop_begin_479, %loop_begin_480 : i64 loc(#loc545)
    %loop_begin_482 = arith.constant 2147483647 : i64 loc(#loc545)
    %loop_begin_483 = arith.constant -2147483648 : i64 loc(#loc545)
    %loop_begin_484 = arith.cmpi sle, %loop_begin_481, %loop_begin_482 : i64 loc(#loc545)
    %loop_begin_485 = arith.cmpi sge, %loop_begin_481, %loop_begin_483 : i64 loc(#loc545)
    %loop_begin_486 = arith.andi %loop_begin_484, %loop_begin_485 : i1 loc(#loc545)
    %loop_begin_487 = arith.subi %loop_begin_476, %loop_begin_478 : i32 loc(#loc545)
    %loop_end = scf.if %23 -> (i32) {
      %loop_end_724 = arith.extsi %page_block_per_block_N : i32 to i64 loc(#loc547)
      %loop_end_725 = arith.extsi %split_kv_end_241 : i32 to i64 loc(#loc547)
      %loop_end_726 = arith.muli %loop_end_724, %loop_end_725 : i64 loc(#loc547)
      %loop_end_727 = arith.constant 2147483647 : i64 loc(#loc547)
      %loop_end_728 = arith.constant -2147483648 : i64 loc(#loc547)
      %loop_end_729 = arith.cmpi sle, %loop_end_726, %loop_end_727 : i64 loc(#loc547)
      %loop_end_730 = arith.cmpi sge, %loop_end_726, %loop_end_728 : i64 loc(#loc547)
      %loop_end_731 = arith.andi %loop_end_729, %loop_end_730 : i1 loc(#loc547)
      %loop_end_732 = arith.muli %page_block_per_block_N, %split_kv_end_241 : i32 loc(#loc547)
      %loop_end_733 = arith.extsi %loop_end_732 : i32 to i64 loc(#loc548)
      %loop_end_734 = arith.extsi %page_block_per_block_N : i32 to i64 loc(#loc548)
      %loop_end_735 = arith.subi %loop_end_733, %loop_end_734 : i64 loc(#loc548)
      %loop_end_736 = arith.constant 2147483647 : i64 loc(#loc548)
      %loop_end_737 = arith.constant -2147483648 : i64 loc(#loc548)
      %loop_end_738 = arith.cmpi sle, %loop_end_735, %loop_end_736 : i64 loc(#loc548)
      %loop_end_739 = arith.cmpi sge, %loop_end_735, %loop_end_737 : i64 loc(#loc548)
      %loop_end_740 = arith.andi %loop_end_738, %loop_end_739 : i1 loc(#loc548)
      %loop_end_741 = arith.subi %loop_end_732, %page_block_per_block_N : i32 loc(#loc548)
      %loop_end_742 = arith.constant 1 : i32 loc(#loc549)
      %loop_end_743 = arith.constant 1 : i32 loc(#loc549)
      %loop_end_744 = arith.extsi %loop_end_741 : i32 to i64 loc(#loc549)
      %loop_end_745 = arith.extsi %loop_end_743 : i32 to i64 loc(#loc549)
      %loop_end_746 = arith.addi %loop_end_744, %loop_end_745 : i64 loc(#loc549)
      %loop_end_747 = arith.constant 2147483647 : i64 loc(#loc549)
      %loop_end_748 = arith.constant -2147483648 : i64 loc(#loc549)
      %loop_end_749 = arith.cmpi sle, %loop_end_746, %loop_end_747 : i64 loc(#loc549)
      %loop_end_750 = arith.cmpi sge, %loop_end_746, %loop_end_748 : i64 loc(#loc549)
      %loop_end_751 = arith.andi %loop_end_749, %loop_end_750 : i1 loc(#loc549)
      %loop_end_752 = arith.addi %loop_end_741, %loop_end_743 : i32 loc(#loc549)
      %loop_end_753 = arith.extsi %loop_end_752 : i32 to i64 loc(#loc550)
      %loop_end_754 = arith.extsi %block_tail_257 : i32 to i64 loc(#loc550)
      %loop_end_755 = arith.addi %loop_end_753, %loop_end_754 : i64 loc(#loc550)
      %loop_end_756 = arith.constant 2147483647 : i64 loc(#loc550)
      %loop_end_757 = arith.constant -2147483648 : i64 loc(#loc550)
      %loop_end_758 = arith.cmpi sle, %loop_end_755, %loop_end_756 : i64 loc(#loc550)
      %loop_end_759 = arith.cmpi sge, %loop_end_755, %loop_end_757 : i64 loc(#loc550)
      %loop_end_760 = arith.andi %loop_end_758, %loop_end_759 : i1 loc(#loc550)
      %loop_end_761 = arith.addi %loop_end_752, %block_tail_257 : i32 loc(#loc550)
      scf.yield %loop_end_761 : i32 loc(#loc550)
    } else {
      %loop_end_724 = arith.extsi %page_block_per_block_N : i32 to i64 loc(#loc551)
      %loop_end_725 = arith.extsi %split_kv_end_241 : i32 to i64 loc(#loc551)
      %loop_end_726 = arith.muli %loop_end_724, %loop_end_725 : i64 loc(#loc551)
      %loop_end_727 = arith.constant 2147483647 : i64 loc(#loc551)
      %loop_end_728 = arith.constant -2147483648 : i64 loc(#loc551)
      %loop_end_729 = arith.cmpi sle, %loop_end_726, %loop_end_727 : i64 loc(#loc551)
      %loop_end_730 = arith.cmpi sge, %loop_end_726, %loop_end_728 : i64 loc(#loc551)
      %loop_end_731 = arith.andi %loop_end_729, %loop_end_730 : i1 loc(#loc551)
      %loop_end_732 = arith.muli %page_block_per_block_N, %split_kv_end_241 : i32 loc(#loc551)
      scf.yield %loop_end_732 : i32 loc(#loc551)
    } loc(#loc546)
    %c1_i32 = arith.constant 1 : i32 loc(#loc168)
    %29 = arith.bitcast %loop_begin_487 : i32 to i32 loc(#loc168)
    %30 = arith.bitcast %loop_end : i32 to i32 loc(#loc168)
    %31 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc168)
    %32 = ub.poison : i32 loc(#loc168)
    %kv2_transpose_488:21 = scf.for %start_n = %29 to %30 step %31 iter_args(%kv_loc_724 = %kv_loc_278, %acc1_725 = %acc1, %acc2_726 = %acc2, %k_id_727 = %k_id_303, %mask_k_id_728 = %mask_k_id_447, %mask_k_729 = %mask_k_326, %offs_buf_kv_730 = %offs_buf_kv_352, %kv1_731 = %kv1_357, %kv2_732 = %kv2_376, %smem_kv1_733 = %smem_kv1_458, %smem_kv2_734 = %smem_kv2_459, %k_id_pe_735 = %k_id_pe_398, %offs_buf_k_pe_736 = %offs_buf_k_pe_424, %mask_k_pe_737 = %mask_k_pe_448, %k_pe_738 = %k_pe_453, %e_sum_739 = %e_sum_454, %e_max_740 = %e_max_457, %cur_k1_741 = %cur_k1, %cur_k2_742 = %cur_k2, %kv1_transpose_743 = %kv1_transpose, %kv2_transpose_744 = %kv2_transpose) -> (i32, tensor<16x256xf32, #mma>, tensor<16x256xf32, #mma>, tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<32x256xi32, #blocked1>, tensor<32x256xbf16, #blocked1>, tensor<32x256xbf16, #blocked1>, !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable>, !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable>, tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<32x64xi32, #blocked2>, tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<32x64xbf16, #blocked2>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x32xbf16, #blocked6>, tensor<256x32xbf16, #blocked6>)  : i32 {
      %start_n_block = arith.divsi %start_n, %page_block_per_block_N : i32 loc(#loc553)
      %start_n_inner = arith.remsi %start_n, %page_block_per_block_N : i32 loc(#loc554)
      %kv_loc_745 = tt.addptr %kv_indices, %start_n_block : !tt.ptr<i32>, i32 loc(#loc555)
      %kv_loc_746 = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc556)
      %kv_loc_747 = arith.extsi %stride_b_block_table : i32 to i64 loc(#loc556)
      %kv_loc_748 = arith.muli %kv_loc_746, %kv_loc_747 : i64 loc(#loc556)
      %kv_loc_749 = arith.constant 2147483647 : i64 loc(#loc556)
      %kv_loc_750 = arith.constant -2147483648 : i64 loc(#loc556)
      %kv_loc_751 = arith.cmpi sle, %kv_loc_748, %kv_loc_749 : i64 loc(#loc556)
      %kv_loc_752 = arith.cmpi sge, %kv_loc_748, %kv_loc_750 : i64 loc(#loc556)
      %kv_loc_753 = arith.andi %kv_loc_751, %kv_loc_752 : i1 loc(#loc556)
      %kv_loc_754 = arith.muli %cur_batch_39, %stride_b_block_table : i32 loc(#loc556)
      %kv_loc_755 = tt.addptr %kv_loc_745, %kv_loc_754 : !tt.ptr<i32>, i32 loc(#loc557)
      %kv_loc_756 = tt.load %kv_loc_755 : !tt.ptr<i32> loc(#loc558)
      %cur_k_pe_757 = ttg.local_load %smem_k_rope : !ttg.memdesc<64x32xbf16, #shared2, #smem, mutable> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc559)
      rocdl.sched.barrier 0 loc(#loc176)
      %k_id_758 = arith.constant 64 : i32 loc(#loc560)
      %k_id_759 = arith.constant 64 : i32 loc(#loc560)
      %k_id_760 = arith.extsi %kv_loc_756 : i32 to i64 loc(#loc560)
      %k_id_761 = arith.extsi %k_id_759 : i32 to i64 loc(#loc560)
      %k_id_762 = arith.muli %k_id_760, %k_id_761 : i64 loc(#loc560)
      %k_id_763 = arith.constant 2147483647 : i64 loc(#loc560)
      %k_id_764 = arith.constant -2147483648 : i64 loc(#loc560)
      %k_id_765 = arith.cmpi sle, %k_id_762, %k_id_763 : i64 loc(#loc560)
      %k_id_766 = arith.cmpi sge, %k_id_762, %k_id_764 : i64 loc(#loc560)
      %k_id_767 = arith.andi %k_id_765, %k_id_766 : i1 loc(#loc560)
      %k_id_768 = arith.muli %kv_loc_756, %k_id_759 : i32 loc(#loc560)
      %k_id_769 = tt.splat %k_id_768 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_770 = arith.extsi %k_id_769 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_771 = arith.extsi %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_772 = arith.addi %k_id_770, %k_id_771 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_773 = arith.constant 2147483647 : i64 loc(#loc561)
      %k_id_774 = arith.constant -2147483648 : i64 loc(#loc561)
      %k_id_775 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_776 = arith.cmpi sle, %k_id_772, %k_id_775 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_777 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_778 = arith.cmpi sge, %k_id_772, %k_id_777 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_779 = arith.andi %k_id_776, %k_id_778 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_780 = arith.addi %k_id_769, %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc561)
      %k_id_781 = arith.constant 32 : i32 loc(#loc562)
      %k_id_782 = arith.constant 32 : i32 loc(#loc562)
      %k_id_783 = arith.extsi %start_n_inner : i32 to i64 loc(#loc562)
      %k_id_784 = arith.extsi %k_id_782 : i32 to i64 loc(#loc562)
      %k_id_785 = arith.muli %k_id_783, %k_id_784 : i64 loc(#loc562)
      %k_id_786 = arith.constant 2147483647 : i64 loc(#loc562)
      %k_id_787 = arith.constant -2147483648 : i64 loc(#loc562)
      %k_id_788 = arith.cmpi sle, %k_id_785, %k_id_786 : i64 loc(#loc562)
      %k_id_789 = arith.cmpi sge, %k_id_785, %k_id_787 : i64 loc(#loc562)
      %k_id_790 = arith.andi %k_id_788, %k_id_789 : i1 loc(#loc562)
      %k_id_791 = arith.muli %start_n_inner, %k_id_782 : i32 loc(#loc562)
      %k_id_792 = tt.splat %k_id_791 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_793 = arith.extsi %k_id_780 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_794 = arith.extsi %k_id_792 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_795 = arith.addi %k_id_793, %k_id_794 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_796 = arith.constant 2147483647 : i64 loc(#loc563)
      %k_id_797 = arith.constant -2147483648 : i64 loc(#loc563)
      %k_id_798 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_799 = arith.cmpi sle, %k_id_795, %k_id_798 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_800 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_801 = arith.cmpi sge, %k_id_795, %k_id_800 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_802 = arith.andi %k_id_799, %k_id_801 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %k_id_803 = arith.addi %k_id_780, %k_id_792 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc563)
      %offs_buf_kv_804 = tt.expand_dims %k_id_803 {axis = 1 : i32} : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<32x1xi32, #blocked1> loc(#loc564)
      %offs_buf_kv_805 = tt.splat %stride_buf_kh : i32 -> tensor<32x1xi32, #blocked1> loc(#loc565)
      %offs_buf_kv_806 = arith.extsi %offs_buf_kv_804 : tensor<32x1xi32, #blocked1> to tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_807 = arith.extsi %offs_buf_kv_805 : tensor<32x1xi32, #blocked1> to tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_808 = arith.muli %offs_buf_kv_806, %offs_buf_kv_807 : tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_809 = arith.constant 2147483647 : i64 loc(#loc565)
      %offs_buf_kv_810 = arith.constant -2147483648 : i64 loc(#loc565)
      %offs_buf_kv_811 = arith.constant dense<2147483647> : tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_812 = arith.cmpi sle, %offs_buf_kv_808, %offs_buf_kv_811 : tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_813 = arith.constant dense<-2147483648> : tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_814 = arith.cmpi sge, %offs_buf_kv_808, %offs_buf_kv_813 : tensor<32x1xi64, #blocked1> loc(#loc565)
      %offs_buf_kv_815 = arith.andi %offs_buf_kv_812, %offs_buf_kv_814 : tensor<32x1xi1, #blocked1> loc(#loc565)
      %offs_buf_kv_816 = arith.muli %offs_buf_kv_804, %offs_buf_kv_805 : tensor<32x1xi32, #blocked1> loc(#loc565)
      %offs_buf_kv_817 = tt.expand_dims %offs_k_c {axis = 0 : i32} : tensor<256xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi32, #blocked1> loc(#loc566)
      %offs_buf_kv_818 = tt.broadcast %offs_buf_kv_816 : tensor<32x1xi32, #blocked1> -> tensor<32x256xi32, #blocked1> loc(#loc567)
      %offs_buf_kv_819 = tt.broadcast %offs_buf_kv_817 : tensor<1x256xi32, #blocked1> -> tensor<32x256xi32, #blocked1> loc(#loc567)
      %offs_buf_kv_820 = arith.extsi %offs_buf_kv_818 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_821 = arith.extsi %offs_buf_kv_819 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_822 = arith.addi %offs_buf_kv_820, %offs_buf_kv_821 : tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_823 = arith.constant 2147483647 : i64 loc(#loc567)
      %offs_buf_kv_824 = arith.constant -2147483648 : i64 loc(#loc567)
      %offs_buf_kv_825 = arith.constant dense<2147483647> : tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_826 = arith.cmpi sle, %offs_buf_kv_822, %offs_buf_kv_825 : tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_827 = arith.constant dense<-2147483648> : tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_828 = arith.cmpi sge, %offs_buf_kv_822, %offs_buf_kv_827 : tensor<32x256xi64, #blocked1> loc(#loc567)
      %offs_buf_kv_829 = arith.andi %offs_buf_kv_826, %offs_buf_kv_828 : tensor<32x256xi1, #blocked1> loc(#loc567)
      %offs_buf_kv_830 = arith.addi %offs_buf_kv_818, %offs_buf_kv_819 : tensor<32x256xi32, #blocked1> loc(#loc567)
      %mask_k_id_831 = arith.constant 64 : i32 loc(#loc568)
      %mask_k_id_832 = arith.constant 64 : i32 loc(#loc568)
      %mask_k_id_833 = arith.extsi %start_n_block : i32 to i64 loc(#loc568)
      %mask_k_id_834 = arith.extsi %mask_k_id_832 : i32 to i64 loc(#loc568)
      %mask_k_id_835 = arith.muli %mask_k_id_833, %mask_k_id_834 : i64 loc(#loc568)
      %mask_k_id_836 = arith.constant 2147483647 : i64 loc(#loc568)
      %mask_k_id_837 = arith.constant -2147483648 : i64 loc(#loc568)
      %mask_k_id_838 = arith.cmpi sle, %mask_k_id_835, %mask_k_id_836 : i64 loc(#loc568)
      %mask_k_id_839 = arith.cmpi sge, %mask_k_id_835, %mask_k_id_837 : i64 loc(#loc568)
      %mask_k_id_840 = arith.andi %mask_k_id_838, %mask_k_id_839 : i1 loc(#loc568)
      %mask_k_id_841 = arith.muli %start_n_block, %mask_k_id_832 : i32 loc(#loc568)
      %mask_k_id_842 = tt.splat %mask_k_id_841 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_843 = arith.extsi %mask_k_id_842 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_844 = arith.extsi %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_845 = arith.addi %mask_k_id_843, %mask_k_id_844 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_846 = arith.constant 2147483647 : i64 loc(#loc569)
      %mask_k_id_847 = arith.constant -2147483648 : i64 loc(#loc569)
      %mask_k_id_848 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_849 = arith.cmpi sle, %mask_k_id_845, %mask_k_id_848 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_850 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_851 = arith.cmpi sge, %mask_k_id_845, %mask_k_id_850 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_852 = arith.andi %mask_k_id_849, %mask_k_id_851 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_853 = arith.addi %mask_k_id_842, %cur_N : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc569)
      %mask_k_id_854 = arith.constant 32 : i32 loc(#loc570)
      %mask_k_id_855 = arith.constant 32 : i32 loc(#loc570)
      %mask_k_id_856 = arith.extsi %start_n_inner : i32 to i64 loc(#loc570)
      %mask_k_id_857 = arith.extsi %mask_k_id_855 : i32 to i64 loc(#loc570)
      %mask_k_id_858 = arith.muli %mask_k_id_856, %mask_k_id_857 : i64 loc(#loc570)
      %mask_k_id_859 = arith.constant 2147483647 : i64 loc(#loc570)
      %mask_k_id_860 = arith.constant -2147483648 : i64 loc(#loc570)
      %mask_k_id_861 = arith.cmpi sle, %mask_k_id_858, %mask_k_id_859 : i64 loc(#loc570)
      %mask_k_id_862 = arith.cmpi sge, %mask_k_id_858, %mask_k_id_860 : i64 loc(#loc570)
      %mask_k_id_863 = arith.andi %mask_k_id_861, %mask_k_id_862 : i1 loc(#loc570)
      %mask_k_id_864 = arith.muli %start_n_inner, %mask_k_id_855 : i32 loc(#loc570)
      %mask_k_id_865 = tt.splat %mask_k_id_864 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_866 = arith.extsi %mask_k_id_853 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_867 = arith.extsi %mask_k_id_865 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_868 = arith.addi %mask_k_id_866, %mask_k_id_867 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_869 = arith.constant 2147483647 : i64 loc(#loc571)
      %mask_k_id_870 = arith.constant -2147483648 : i64 loc(#loc571)
      %mask_k_id_871 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_872 = arith.cmpi sle, %mask_k_id_868, %mask_k_id_871 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_873 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_874 = arith.cmpi sge, %mask_k_id_868, %mask_k_id_873 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_875 = arith.andi %mask_k_id_872, %mask_k_id_874 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_id_876 = arith.addi %mask_k_id_853, %mask_k_id_865 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc571)
      %mask_k_877 = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc572)
      %mask_k_878 = arith.cmpi slt, %mask_k_id_876, %mask_k_877 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc572)
      rocdl.sched.barrier 0 loc(#loc190)
      %qk_879 = arith.constant 0.000000e+00 : f32 loc(#loc573)
      %qk_880 = tt.dot %q0, %cur_k1_741, %zeros : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x32xf32, #mma> loc(#loc573)
      %kv1_881 = tt.expand_dims %mask_k_878 {axis = 1 : i32} : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<32x1xi1, #blocked1> loc(#loc574)
      %kv1_882 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc575)
      %kv1_883 = tt.broadcast %kv1_881 : tensor<32x1xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc576)
      %kv1_884 = tt.broadcast %kv1_882 : tensor<1x256xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc576)
      %kv1_885 = arith.andi %kv1_883, %kv1_884 : tensor<32x256xi1, #blocked1> loc(#loc576)
      %kv1_886 = amdgpu.buffer_load %K_Buffer[%offs_buf_kv_830], %kv1_885 : tensor<32x256xbf16, #blocked1> loc(#loc577)
      rocdl.sched.barrier 0 loc(#loc196)
      %qk_887 = arith.constant 0.000000e+00 : f32 loc(#loc578)
      %qk_888 = tt.dot %q1, %cur_k2_742, %qk_880 : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x32xf32, #mma> loc(#loc578)
      %kv2_889 = arith.constant 256 : i32 loc(#loc579)
      %kv2_890 = arith.constant 256 : i32 loc(#loc579)
      %kv2_891 = arith.constant dense<256> : tensor<32x256xi32, #blocked1> loc(#loc579)
      %kv2_892 = arith.extsi %offs_buf_kv_830 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_893 = arith.extsi %kv2_891 : tensor<32x256xi32, #blocked1> to tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_894 = arith.addi %kv2_892, %kv2_893 : tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_895 = arith.constant 2147483647 : i64 loc(#loc579)
      %kv2_896 = arith.constant -2147483648 : i64 loc(#loc579)
      %kv2_897 = arith.constant dense<2147483647> : tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_898 = arith.cmpi sle, %kv2_894, %kv2_897 : tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_899 = arith.constant dense<-2147483648> : tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_900 = arith.cmpi sge, %kv2_894, %kv2_899 : tensor<32x256xi64, #blocked1> loc(#loc579)
      %kv2_901 = arith.andi %kv2_898, %kv2_900 : tensor<32x256xi1, #blocked1> loc(#loc579)
      %kv2_902 = arith.addi %offs_buf_kv_830, %kv2_891 : tensor<32x256xi32, #blocked1> loc(#loc579)
      %kv2_903 = tt.expand_dims %mask_k_878 {axis = 1 : i32} : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<32x1xi1, #blocked1> loc(#loc580)
      %kv2_904 = tt.expand_dims %mask_k_c_213 {axis = 0 : i32} : tensor<256xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x256xi1, #blocked1> loc(#loc581)
      %kv2_905 = tt.broadcast %kv2_903 : tensor<32x1xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc582)
      %kv2_906 = tt.broadcast %kv2_904 : tensor<1x256xi1, #blocked1> -> tensor<32x256xi1, #blocked1> loc(#loc582)
      %kv2_907 = arith.andi %kv2_905, %kv2_906 : tensor<32x256xi1, #blocked1> loc(#loc582)
      %kv2_908 = amdgpu.buffer_load %K_Buffer[%kv2_902], %kv2_907 : tensor<32x256xbf16, #blocked1> loc(#loc583)
      %cur_k1_909 = ttg.local_load %smem_kv1_733 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> -> tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc584)
      %cur_k2_910 = ttg.local_load %smem_kv2_734 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> -> tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc585)
      %qk_911 = arith.constant 0.000000e+00 : f32 loc(#loc586)
      %qk_912 = tt.dot %q_pe_281, %cur_k_pe_757, %qk_888 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x32xf32, #mma> loc(#loc586)
      %qk_913 = tt.splat %sm_scale : f32 -> tensor<16x32xf32, #mma> loc(#loc587)
      %qk_914 = arith.mulf %qk_912, %qk_913 : tensor<16x32xf32, #mma> loc(#loc587)
      %k_id_pe_915 = arith.constant 64 : i32 loc(#loc588)
      %k_id_pe_916 = arith.constant 64 : i32 loc(#loc588)
      %k_id_pe_917 = arith.extsi %kv_loc_756 : i32 to i64 loc(#loc588)
      %k_id_pe_918 = arith.extsi %k_id_pe_916 : i32 to i64 loc(#loc588)
      %k_id_pe_919 = arith.muli %k_id_pe_917, %k_id_pe_918 : i64 loc(#loc588)
      %k_id_pe_920 = arith.constant 2147483647 : i64 loc(#loc588)
      %k_id_pe_921 = arith.constant -2147483648 : i64 loc(#loc588)
      %k_id_pe_922 = arith.cmpi sle, %k_id_pe_919, %k_id_pe_920 : i64 loc(#loc588)
      %k_id_pe_923 = arith.cmpi sge, %k_id_pe_919, %k_id_pe_921 : i64 loc(#loc588)
      %k_id_pe_924 = arith.andi %k_id_pe_922, %k_id_pe_923 : i1 loc(#loc588)
      %k_id_pe_925 = arith.muli %kv_loc_756, %k_id_pe_916 : i32 loc(#loc588)
      %k_id_pe_926 = tt.splat %k_id_pe_925 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_927 = arith.extsi %k_id_pe_926 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_928 = arith.extsi %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_929 = arith.addi %k_id_pe_927, %k_id_pe_928 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_930 = arith.constant 2147483647 : i64 loc(#loc589)
      %k_id_pe_931 = arith.constant -2147483648 : i64 loc(#loc589)
      %k_id_pe_932 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_933 = arith.cmpi sle, %k_id_pe_929, %k_id_pe_932 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_934 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_935 = arith.cmpi sge, %k_id_pe_929, %k_id_pe_934 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_936 = arith.andi %k_id_pe_933, %k_id_pe_935 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_937 = arith.addi %k_id_pe_926, %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc589)
      %k_id_pe_938 = arith.constant 32 : i32 loc(#loc590)
      %k_id_pe_939 = arith.constant 32 : i32 loc(#loc590)
      %k_id_pe_940 = arith.extsi %start_n_inner : i32 to i64 loc(#loc590)
      %k_id_pe_941 = arith.extsi %k_id_pe_939 : i32 to i64 loc(#loc590)
      %k_id_pe_942 = arith.muli %k_id_pe_940, %k_id_pe_941 : i64 loc(#loc590)
      %k_id_pe_943 = arith.constant 2147483647 : i64 loc(#loc590)
      %k_id_pe_944 = arith.constant -2147483648 : i64 loc(#loc590)
      %k_id_pe_945 = arith.cmpi sle, %k_id_pe_942, %k_id_pe_943 : i64 loc(#loc590)
      %k_id_pe_946 = arith.cmpi sge, %k_id_pe_942, %k_id_pe_944 : i64 loc(#loc590)
      %k_id_pe_947 = arith.andi %k_id_pe_945, %k_id_pe_946 : i1 loc(#loc590)
      %k_id_pe_948 = arith.muli %start_n_inner, %k_id_pe_939 : i32 loc(#loc590)
      %k_id_pe_949 = tt.splat %k_id_pe_948 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_950 = arith.extsi %k_id_pe_937 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_951 = arith.extsi %k_id_pe_949 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_952 = arith.addi %k_id_pe_950, %k_id_pe_951 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_953 = arith.constant 2147483647 : i64 loc(#loc591)
      %k_id_pe_954 = arith.constant -2147483648 : i64 loc(#loc591)
      %k_id_pe_955 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_956 = arith.cmpi sle, %k_id_pe_952, %k_id_pe_955 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_957 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_958 = arith.cmpi sge, %k_id_pe_952, %k_id_pe_957 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_959 = arith.andi %k_id_pe_956, %k_id_pe_958 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %k_id_pe_960 = arith.addi %k_id_pe_937, %k_id_pe_949 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc591)
      %offs_buf_k_pe_961 = tt.expand_dims %k_id_pe_960 {axis = 1 : i32} : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<32x1xi32, #blocked2> loc(#loc592)
      %offs_buf_k_pe_962 = tt.splat %stride_buf_kh : i32 -> tensor<32x1xi32, #blocked2> loc(#loc593)
      %offs_buf_k_pe_963 = arith.extsi %offs_buf_k_pe_961 : tensor<32x1xi32, #blocked2> to tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_964 = arith.extsi %offs_buf_k_pe_962 : tensor<32x1xi32, #blocked2> to tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_965 = arith.muli %offs_buf_k_pe_963, %offs_buf_k_pe_964 : tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_966 = arith.constant 2147483647 : i64 loc(#loc593)
      %offs_buf_k_pe_967 = arith.constant -2147483648 : i64 loc(#loc593)
      %offs_buf_k_pe_968 = arith.constant dense<2147483647> : tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_969 = arith.cmpi sle, %offs_buf_k_pe_965, %offs_buf_k_pe_968 : tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_970 = arith.constant dense<-2147483648> : tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_971 = arith.cmpi sge, %offs_buf_k_pe_965, %offs_buf_k_pe_970 : tensor<32x1xi64, #blocked2> loc(#loc593)
      %offs_buf_k_pe_972 = arith.andi %offs_buf_k_pe_969, %offs_buf_k_pe_971 : tensor<32x1xi1, #blocked2> loc(#loc593)
      %offs_buf_k_pe_973 = arith.muli %offs_buf_k_pe_961, %offs_buf_k_pe_962 : tensor<32x1xi32, #blocked2> loc(#loc593)
      %offs_buf_k_pe_974 = tt.expand_dims %offs_k_r {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc594)
      %offs_buf_k_pe_975 = tt.broadcast %offs_buf_k_pe_973 : tensor<32x1xi32, #blocked2> -> tensor<32x64xi32, #blocked2> loc(#loc595)
      %offs_buf_k_pe_976 = tt.broadcast %offs_buf_k_pe_974 : tensor<1x64xi32, #blocked2> -> tensor<32x64xi32, #blocked2> loc(#loc595)
      %offs_buf_k_pe_977 = arith.extsi %offs_buf_k_pe_975 : tensor<32x64xi32, #blocked2> to tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_978 = arith.extsi %offs_buf_k_pe_976 : tensor<32x64xi32, #blocked2> to tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_979 = arith.addi %offs_buf_k_pe_977, %offs_buf_k_pe_978 : tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_980 = arith.constant 2147483647 : i64 loc(#loc595)
      %offs_buf_k_pe_981 = arith.constant -2147483648 : i64 loc(#loc595)
      %offs_buf_k_pe_982 = arith.constant dense<2147483647> : tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_983 = arith.cmpi sle, %offs_buf_k_pe_979, %offs_buf_k_pe_982 : tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_984 = arith.constant dense<-2147483648> : tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_985 = arith.cmpi sge, %offs_buf_k_pe_979, %offs_buf_k_pe_984 : tensor<32x64xi64, #blocked2> loc(#loc595)
      %offs_buf_k_pe_986 = arith.andi %offs_buf_k_pe_983, %offs_buf_k_pe_985 : tensor<32x64xi1, #blocked2> loc(#loc595)
      %offs_buf_k_pe_987 = arith.addi %offs_buf_k_pe_975, %offs_buf_k_pe_976 : tensor<32x64xi32, #blocked2> loc(#loc595)
      %mask_k_id_988 = arith.constant 64 : i32 loc(#loc596)
      %mask_k_id_989 = arith.constant 64 : i32 loc(#loc596)
      %mask_k_id_990 = arith.extsi %start_n_block : i32 to i64 loc(#loc596)
      %mask_k_id_991 = arith.extsi %mask_k_id_989 : i32 to i64 loc(#loc596)
      %mask_k_id_992 = arith.muli %mask_k_id_990, %mask_k_id_991 : i64 loc(#loc596)
      %mask_k_id_993 = arith.constant 2147483647 : i64 loc(#loc596)
      %mask_k_id_994 = arith.constant -2147483648 : i64 loc(#loc596)
      %mask_k_id_995 = arith.cmpi sle, %mask_k_id_992, %mask_k_id_993 : i64 loc(#loc596)
      %mask_k_id_996 = arith.cmpi sge, %mask_k_id_992, %mask_k_id_994 : i64 loc(#loc596)
      %mask_k_id_997 = arith.andi %mask_k_id_995, %mask_k_id_996 : i1 loc(#loc596)
      %mask_k_id_998 = arith.muli %start_n_block, %mask_k_id_989 : i32 loc(#loc596)
      %mask_k_id_999 = tt.splat %mask_k_id_998 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1000 = arith.extsi %mask_k_id_999 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1001 = arith.extsi %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1002 = arith.addi %mask_k_id_1000, %mask_k_id_1001 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1003 = arith.constant 2147483647 : i64 loc(#loc597)
      %mask_k_id_1004 = arith.constant -2147483648 : i64 loc(#loc597)
      %mask_k_id_1005 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1006 = arith.cmpi sle, %mask_k_id_1002, %mask_k_id_1005 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1007 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1008 = arith.cmpi sge, %mask_k_id_1002, %mask_k_id_1007 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1009 = arith.andi %mask_k_id_1006, %mask_k_id_1008 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1010 = arith.addi %mask_k_id_999, %cur_N_pe : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc597)
      %mask_k_id_1011 = arith.constant 32 : i32 loc(#loc598)
      %mask_k_id_1012 = arith.constant 32 : i32 loc(#loc598)
      %mask_k_id_1013 = arith.extsi %start_n_inner : i32 to i64 loc(#loc598)
      %mask_k_id_1014 = arith.extsi %mask_k_id_1012 : i32 to i64 loc(#loc598)
      %mask_k_id_1015 = arith.muli %mask_k_id_1013, %mask_k_id_1014 : i64 loc(#loc598)
      %mask_k_id_1016 = arith.constant 2147483647 : i64 loc(#loc598)
      %mask_k_id_1017 = arith.constant -2147483648 : i64 loc(#loc598)
      %mask_k_id_1018 = arith.cmpi sle, %mask_k_id_1015, %mask_k_id_1016 : i64 loc(#loc598)
      %mask_k_id_1019 = arith.cmpi sge, %mask_k_id_1015, %mask_k_id_1017 : i64 loc(#loc598)
      %mask_k_id_1020 = arith.andi %mask_k_id_1018, %mask_k_id_1019 : i1 loc(#loc598)
      %mask_k_id_1021 = arith.muli %start_n_inner, %mask_k_id_1012 : i32 loc(#loc598)
      %mask_k_id_1022 = tt.splat %mask_k_id_1021 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1023 = arith.extsi %mask_k_id_1010 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1024 = arith.extsi %mask_k_id_1022 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> to tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1025 = arith.addi %mask_k_id_1023, %mask_k_id_1024 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1026 = arith.constant 2147483647 : i64 loc(#loc599)
      %mask_k_id_1027 = arith.constant -2147483648 : i64 loc(#loc599)
      %mask_k_id_1028 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1029 = arith.cmpi sle, %mask_k_id_1025, %mask_k_id_1028 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1030 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1031 = arith.cmpi sge, %mask_k_id_1025, %mask_k_id_1030 : tensor<32xi64, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1032 = arith.andi %mask_k_id_1029, %mask_k_id_1031 : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_id_1033 = arith.addi %mask_k_id_1010, %mask_k_id_1022 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc599)
      %mask_k_pe_1034 = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc600)
      %mask_k_pe_1035 = arith.cmpi slt, %mask_k_id_1033, %mask_k_pe_1034 : tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc600)
      rocdl.sched.barrier 0 loc(#loc220)
      %k_pe_1036 = tt.expand_dims %mask_k_pe_1035 {axis = 1 : i32} : tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<32x1xi1, #blocked2> loc(#loc601)
      %k_pe_1037 = tt.expand_dims %mask_k_r_217 {axis = 0 : i32} : tensor<64xi1, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi1, #blocked2> loc(#loc602)
      %k_pe_1038 = tt.broadcast %k_pe_1036 : tensor<32x1xi1, #blocked2> -> tensor<32x64xi1, #blocked2> loc(#loc603)
      %k_pe_1039 = tt.broadcast %k_pe_1037 : tensor<1x64xi1, #blocked2> -> tensor<32x64xi1, #blocked2> loc(#loc603)
      %k_pe_1040 = arith.andi %k_pe_1038, %k_pe_1039 : tensor<32x64xi1, #blocked2> loc(#loc603)
      %k_pe_1041 = amdgpu.buffer_load %K_Buffer[%offs_buf_k_pe_987], %k_pe_1040 : tensor<32x64xbf16, #blocked2> loc(#loc604)
      %n_e_max_1042 = tt.call @"triton.language.standard.max__fp32S16_32SLMFMA_3_16_16_True_1_4_1_1_fp32_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%qk_914) : (tensor<16x32xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc605)
      %n_e_max_1043 = ttg.convert_layout %n_e_max_1042 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc606)
      %n_e_max_1044 = arith.maxnumf %n_e_max_1043, %e_max_740 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc607)
      %re_scale_1045 = arith.subf %e_max_740, %n_e_max_1044 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc608)
      %re_scale_1046 = arith.constant 1.44269502 : f32 loc(#loc609)
      %re_scale_1047 = arith.constant 1.44269502 : f32 loc(#loc609)
      %re_scale_1048 = arith.constant dense<1.44269502> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc609)
      %re_scale_1049 = arith.mulf %re_scale_1045, %re_scale_1048 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc609)
      %re_scale_1050 = math.exp2 %re_scale_1049 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc610)
      %p_1051 = tt.expand_dims %n_e_max_1044 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc611)
      %p_1052 = tt.broadcast %p_1051 : tensor<16x1xf32, #mma> -> tensor<16x32xf32, #mma> loc(#loc612)
      %p_1053 = arith.subf %qk_914, %p_1052 : tensor<16x32xf32, #mma> loc(#loc612)
      %p_1054 = arith.constant 1.44269502 : f32 loc(#loc613)
      %p_1055 = arith.constant 1.44269502 : f32 loc(#loc613)
      %p_1056 = arith.constant dense<1.44269502> : tensor<16x32xf32, #mma> loc(#loc613)
      %p_1057 = arith.mulf %p_1053, %p_1056 : tensor<16x32xf32, #mma> loc(#loc613)
      %p_1058 = math.exp2 %p_1057 : tensor<16x32xf32, #mma> loc(#loc614)
      %44 = arith.truncf %p_1058 : tensor<16x32xf32, #mma> to tensor<16x32xbf16, #mma> loc(#loc235)
      ttg.local_store %44, %smem_p : tensor<16x32xbf16, #mma> -> !ttg.memdesc<16x32xbf16, #shared1, #smem, mutable> loc(#loc236)
      rocdl.sched.barrier 0 loc(#loc237)
      %cur_p_1059 = ttg.local_load %smem_p : !ttg.memdesc<16x32xbf16, #shared1, #smem, mutable> -> tensor<16x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc615)
      %smem_kv1_1060 = ttg.memdesc_reinterpret %smem_kv1_733 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc616)
      %smem_kv2_1061 = ttg.memdesc_reinterpret %smem_kv2_734 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc617)
      %45 = tt.trans %kv1_886 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc241)
      ttg.local_store %45, %smem_kv1_1060 : tensor<256x32xbf16, #blocked6> -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc241)
      %acc1_1062 = tt.expand_dims %re_scale_1050 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc618)
      %acc1_1063 = tt.broadcast %acc1_1062 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc619)
      %acc1_1064 = arith.mulf %acc1_725, %acc1_1063 : tensor<16x256xf32, #mma> loc(#loc619)
      %acc1_1065 = arith.constant 0.000000e+00 : f32 loc(#loc620)
      %acc1_1066 = tt.dot %cur_p_1059, %cur_k1_909, %acc1_1064 : tensor<16x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<16x256xf32, #mma> loc(#loc620)
      %e_sum_1067 = arith.mulf %e_sum_739, %re_scale_1050 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc621)
      %e_sum_1068 = tt.call @"triton.language.standard.sum__fp32S16_32SLMFMA_3_16_16_True_1_4_1_1_fp32_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%p_1058) : (tensor<16x32xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc622)
      %e_sum_1069 = arith.addf %e_sum_1067, %e_sum_1068 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc623)
      %46 = tt.trans %kv2_908 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc248)
      ttg.local_store %46, %smem_kv2_1061 : tensor<256x32xbf16, #blocked6> -> !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> loc(#loc248)
      %acc2_1070 = tt.expand_dims %re_scale_1050 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc624)
      %acc2_1071 = tt.broadcast %acc2_1070 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc625)
      %acc2_1072 = arith.mulf %acc2_726, %acc2_1071 : tensor<16x256xf32, #mma> loc(#loc625)
      %acc2_1073 = arith.constant 0.000000e+00 : f32 loc(#loc626)
      %acc2_1074 = tt.dot %cur_p_1059, %cur_k2_910, %acc2_1072 : tensor<16x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<16x256xf32, #mma> loc(#loc626)
      %47 = tt.trans %k_pe_1041 {order = array<i32: 1, 0>} : tensor<32x64xbf16, #blocked2> -> tensor<64x32xbf16, #blocked7> loc(#loc252)
      ttg.local_store %47, %smem_k_rope : tensor<64x32xbf16, #blocked7> -> !ttg.memdesc<64x32xbf16, #shared2, #smem, mutable> loc(#loc252)
      %cur_k1_1075 = ttg.local_load %smem_kv1_1060 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc627)
      %kv1_transpose_1076 = tt.trans %kv1_886 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc628)
      rocdl.sched.barrier 0 loc(#loc255)
      %smem_kv1_1077 = ttg.memdesc_reinterpret %smem_kv1_1060 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc629)
      %48 = tt.trans %kv1_transpose_1076 {order = array<i32: 1, 0>} : tensor<256x32xbf16, #blocked6> -> tensor<32x256xbf16, #blocked1> loc(#loc257)
      ttg.local_store %48, %smem_kv1_1077 : tensor<32x256xbf16, #blocked1> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc257)
      %cur_k2_1078 = ttg.local_load %smem_kv2_1061 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc630)
      %kv2_transpose_1079 = tt.trans %kv2_908 {order = array<i32: 1, 0>} : tensor<32x256xbf16, #blocked1> -> tensor<256x32xbf16, #blocked6> loc(#loc631)
      rocdl.sched.barrier 0 loc(#loc260)
      %smem_kv2_1080 = ttg.memdesc_reinterpret %smem_kv2_1061 : !ttg.memdesc<256x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc632)
      %49 = tt.trans %kv2_transpose_1079 {order = array<i32: 1, 0>} : tensor<256x32xbf16, #blocked6> -> tensor<32x256xbf16, #blocked1> loc(#loc262)
      ttg.local_store %49, %smem_kv2_1080 : tensor<32x256xbf16, #blocked1> -> !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc262)
      scf.yield %kv_loc_756, %acc1_1066, %acc2_1074, %k_id_803, %mask_k_id_1033, %mask_k_878, %offs_buf_kv_830, %kv1_886, %kv2_908, %smem_kv1_1077, %smem_kv2_1080, %k_id_pe_960, %offs_buf_k_pe_987, %mask_k_pe_1035, %k_pe_1041, %e_sum_1069, %n_e_max_1044, %cur_k1_1075, %cur_k2_1078, %kv1_transpose_1076, %kv2_transpose_1079 : i32, tensor<16x256xf32, #mma>, tensor<16x256xf32, #mma>, tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<32x256xi32, #blocked1>, tensor<32x256xbf16, #blocked1>, tensor<32x256xbf16, #blocked1>, !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable>, !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable>, tensor<32xi32, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<32x64xi32, #blocked2>, tensor<32xi1, #ttg.slice<{dim = 1, parent = #blocked2}>>, tensor<32x64xbf16, #blocked2>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>>, tensor<256x32xbf16, #blocked6>, tensor<256x32xbf16, #blocked6> loc(#loc263)
    } loc(#loc742)
    %qk = arith.constant 0.000000e+00 : f32 loc(#loc633)
    %qk_489 = tt.dot %q0, %kv2_transpose_488#17, %zeros : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x32xf32, #mma> loc(#loc633)
    %qk_490 = arith.constant 0.000000e+00 : f32 loc(#loc634)
    %qk_491 = tt.dot %q1, %kv2_transpose_488#18, %qk_489 : tensor<16x256xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<256x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x32xf32, #mma> loc(#loc634)
    %cur_k_pe = ttg.local_load %smem_k_rope : !ttg.memdesc<64x32xbf16, #shared2, #smem, mutable> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> loc(#loc635)
    %qk_492 = arith.constant 0.000000e+00 : f32 loc(#loc636)
    %qk_493 = tt.dot %q_pe_281, %cur_k_pe, %qk_491 : tensor<16x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 16}>> * tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 16}>> -> tensor<16x32xf32, #mma> loc(#loc636)
    %cur_k1_494 = ttg.local_load %kv2_transpose_488#9 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> -> tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc637)
    %cur_k2_495 = ttg.local_load %kv2_transpose_488#10 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> -> tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc638)
    %qk_496 = tt.splat %sm_scale : f32 -> tensor<16x32xf32, #mma> loc(#loc639)
    %qk_497 = arith.mulf %qk_493, %qk_496 : tensor<16x32xf32, #mma> loc(#loc639)
    %mask_qk_n = arith.constant 1 : i32 loc(#loc640)
    %mask_qk_n_498 = arith.constant 1 : i32 loc(#loc640)
    %mask_qk_n_499 = arith.extsi %split_kv_end_241 : i32 to i64 loc(#loc640)
    %mask_qk_n_500 = arith.extsi %mask_qk_n_498 : i32 to i64 loc(#loc640)
    %mask_qk_n_501 = arith.subi %mask_qk_n_499, %mask_qk_n_500 : i64 loc(#loc640)
    %mask_qk_n_502 = arith.constant 2147483647 : i64 loc(#loc640)
    %mask_qk_n_503 = arith.constant -2147483648 : i64 loc(#loc640)
    %mask_qk_n_504 = arith.cmpi sle, %mask_qk_n_501, %mask_qk_n_502 : i64 loc(#loc640)
    %mask_qk_n_505 = arith.cmpi sge, %mask_qk_n_501, %mask_qk_n_503 : i64 loc(#loc640)
    %mask_qk_n_506 = arith.andi %mask_qk_n_504, %mask_qk_n_505 : i1 loc(#loc640)
    %mask_qk_n_507 = arith.subi %split_kv_end_241, %mask_qk_n_498 : i32 loc(#loc640)
    %mask_qk_n_508 = arith.constant 64 : i32 loc(#loc641)
    %mask_qk_n_509 = arith.constant 64 : i32 loc(#loc641)
    %mask_qk_n_510 = arith.extsi %mask_qk_n_507 : i32 to i64 loc(#loc641)
    %mask_qk_n_511 = arith.extsi %mask_qk_n_509 : i32 to i64 loc(#loc641)
    %mask_qk_n_512 = arith.muli %mask_qk_n_510, %mask_qk_n_511 : i64 loc(#loc641)
    %mask_qk_n_513 = arith.constant 2147483647 : i64 loc(#loc641)
    %mask_qk_n_514 = arith.constant -2147483648 : i64 loc(#loc641)
    %mask_qk_n_515 = arith.cmpi sle, %mask_qk_n_512, %mask_qk_n_513 : i64 loc(#loc641)
    %mask_qk_n_516 = arith.cmpi sge, %mask_qk_n_512, %mask_qk_n_514 : i64 loc(#loc641)
    %mask_qk_n_517 = arith.andi %mask_qk_n_515, %mask_qk_n_516 : i1 loc(#loc641)
    %mask_qk_n_518 = arith.muli %mask_qk_n_507, %mask_qk_n_509 : i32 loc(#loc641)
    %mask_qk_n_519 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc642)
    %mask_qk_n_520 = tt.splat %mask_qk_n_518 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_521 = arith.extsi %mask_qk_n_520 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_522 = arith.extsi %mask_qk_n_519 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_523 = arith.addi %mask_qk_n_521, %mask_qk_n_522 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_524 = arith.constant 2147483647 : i64 loc(#loc643)
    %mask_qk_n_525 = arith.constant -2147483648 : i64 loc(#loc643)
    %mask_qk_n_526 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_527 = arith.cmpi sle, %mask_qk_n_523, %mask_qk_n_526 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_528 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_529 = arith.cmpi sge, %mask_qk_n_523, %mask_qk_n_528 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_530 = arith.andi %mask_qk_n_527, %mask_qk_n_529 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %mask_qk_n_531 = arith.addi %mask_qk_n_520, %mask_qk_n_519 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc643)
    %qk_532 = tt.expand_dims %mask_qk_n_531 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc644)
    %qk_533 = tt.splat %cur_batch_seq_len_115 : i32 -> tensor<1x32xi32, #mma> loc(#loc645)
    %qk_534 = arith.cmpi slt, %qk_532, %qk_533 : tensor<1x32xi32, #mma> loc(#loc645)
    %qk_535 = tt.expand_dims %mask_qk_h {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xi32, #mma> loc(#loc646)
    %qk_536 = arith.constant 0 : i32 loc(#loc647)
    %qk_537 = arith.constant dense<0> : tensor<16x1xi32, #mma> loc(#loc647)
    %qk_538 = arith.cmpi sge, %qk_535, %qk_537 : tensor<16x1xi32, #mma> loc(#loc647)
    %qk_539 = tt.broadcast %qk_534 : tensor<1x32xi1, #mma> -> tensor<16x32xi1, #mma> loc(#loc648)
    %qk_540 = tt.broadcast %qk_538 : tensor<16x1xi1, #mma> -> tensor<16x32xi1, #mma> loc(#loc648)
    %qk_541 = arith.andi %qk_539, %qk_540 : tensor<16x32xi1, #mma> loc(#loc648)
    %qk_542 = arith.constant 0xFF800000 : f32 loc(#loc649)
    %qk_543 = arith.constant 0xFF800000 : f32 loc(#loc649)
    %qk_544 = arith.constant dense<0xFF800000> : tensor<16x32xf32, #mma> loc(#loc649)
    %qk_545 = arith.select %qk_541, %qk_497, %qk_544 : tensor<16x32xi1, #mma>, tensor<16x32xf32, #mma> loc(#loc649)
    %n_e_max = tt.call @"triton.language.standard.max__fp32S16_32SLMFMA_3_16_16_True_1_4_1_1_fp32_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%qk_545) : (tensor<16x32xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc650)
    %n_e_max_546 = ttg.convert_layout %n_e_max : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc651)
    %n_e_max_547 = arith.maxnumf %n_e_max_546, %kv2_transpose_488#16 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc652)
    %re_scale = arith.subf %kv2_transpose_488#16, %n_e_max_547 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc653)
    %re_scale_548 = arith.constant 1.44269502 : f32 loc(#loc654)
    %re_scale_549 = arith.constant 1.44269502 : f32 loc(#loc654)
    %re_scale_550 = arith.constant dense<1.44269502> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc654)
    %re_scale_551 = arith.mulf %re_scale, %re_scale_550 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc654)
    %re_scale_552 = math.exp2 %re_scale_551 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc655)
    %p = tt.expand_dims %n_e_max_547 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc656)
    %p_553 = tt.broadcast %p : tensor<16x1xf32, #mma> -> tensor<16x32xf32, #mma> loc(#loc657)
    %p_554 = arith.subf %qk_545, %p_553 : tensor<16x32xf32, #mma> loc(#loc657)
    %p_555 = arith.constant 1.44269502 : f32 loc(#loc658)
    %p_556 = arith.constant 1.44269502 : f32 loc(#loc658)
    %p_557 = arith.constant dense<1.44269502> : tensor<16x32xf32, #mma> loc(#loc658)
    %p_558 = arith.mulf %p_554, %p_557 : tensor<16x32xf32, #mma> loc(#loc658)
    %p_559 = math.exp2 %p_558 : tensor<16x32xf32, #mma> loc(#loc659)
    %33 = arith.truncf %p_559 : tensor<16x32xf32, #mma> to tensor<16x32xbf16, #mma> loc(#loc291)
    ttg.local_store %33, %smem_p : tensor<16x32xbf16, #mma> -> !ttg.memdesc<16x32xbf16, #shared1, #smem, mutable> loc(#loc292)
    %acc1_560 = tt.expand_dims %re_scale_552 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc660)
    %acc1_561 = tt.broadcast %acc1_560 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc661)
    %acc1_562 = arith.mulf %kv2_transpose_488#1, %acc1_561 : tensor<16x256xf32, #mma> loc(#loc661)
    %acc2_563 = tt.expand_dims %re_scale_552 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc662)
    %acc2_564 = tt.broadcast %acc2_563 : tensor<16x1xf32, #mma> -> tensor<16x256xf32, #mma> loc(#loc663)
    %acc2_565 = arith.mulf %kv2_transpose_488#2, %acc2_564 : tensor<16x256xf32, #mma> loc(#loc663)
    %e_sum_566 = arith.mulf %kv2_transpose_488#15, %re_scale_552 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc664)
    %e_sum_567 = tt.call @"triton.language.standard.sum__fp32S16_32SLMFMA_3_16_16_True_1_4_1_1_fp32_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%p_559) : (tensor<16x32xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc665)
    %e_sum_568 = arith.addf %e_sum_566, %e_sum_567 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc666)
    rocdl.sched.barrier 0 loc(#loc300)
    %cur_p = ttg.local_load %smem_p : !ttg.memdesc<16x32xbf16, #shared1, #smem, mutable> -> tensor<16x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc667)
    %acc1_569 = arith.constant 0.000000e+00 : f32 loc(#loc668)
    %acc1_570 = tt.dot %cur_p, %cur_k1_494, %acc1_562 : tensor<16x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<16x256xf32, #mma> loc(#loc668)
    %acc2_571 = arith.constant 0.000000e+00 : f32 loc(#loc669)
    %acc2_572 = tt.dot %cur_p, %cur_k2_495, %acc2_565 : tensor<16x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x256xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<16x256xf32, #mma> loc(#loc669)
    ttg.local_dealloc %kv2_transpose_488#9 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc304)
    ttg.local_dealloc %kv2_transpose_488#10 : !ttg.memdesc<32x256xbf16, #shared3, #smem, mutable> loc(#loc305)
    %acc = tt.join %acc1_570, %acc2_572 : tensor<16x256xf32, #mma> -> tensor<16x256x2xf32, #linear> loc(#loc670)
    %acc_573 = tt.trans %acc {order = array<i32: 0, 2, 1>} : tensor<16x256x2xf32, #linear> -> tensor<16x2x256xf32, #linear1> loc(#loc671)
    %acc_574 = tt.reshape %acc_573 : tensor<16x2x256xf32, #linear1> -> tensor<16x512xf32, #linear2> loc(#loc672)
    %acc_575 = ttg.convert_layout %acc_574 : tensor<16x512xf32, #linear2> -> tensor<16x512xf32, #mma> loc(#loc673)
    %smem_o = ttg.local_alloc : () -> !ttg.memdesc<16x512xf32, #shared, #smem, mutable> loc(#loc674)
    %e_sum_576 = arith.constant 1 : i32 loc(#loc675)
    %e_sum_577 = arith.constant 1.000000e+00 : f32 loc(#loc675)
    %e_sum_578 = arith.constant dense<1.000000e+00> : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc675)
    %e_sum_579 = arith.divf %e_sum_578, %e_sum_568 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc675)
    %34 = tt.expand_dims %e_sum_579 {axis = 1 : i32} : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<16x1xf32, #mma> loc(#loc312)
    %35 = tt.broadcast %34 : tensor<16x1xf32, #mma> -> tensor<16x512xf32, #mma> loc(#loc313)
    %36 = arith.mulf %acc_575, %35 : tensor<16x512xf32, #mma> loc(#loc313)
    ttg.local_store %36, %smem_o : tensor<16x512xf32, #mma> -> !ttg.memdesc<16x512xf32, #shared, #smem, mutable> loc(#loc314)
    %cur_o = ttg.local_load %smem_o : !ttg.memdesc<16x512xf32, #shared, #smem, mutable> -> tensor<16x512xf32, #blocked> loc(#loc676)
    %offs_mid_o = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc677)
    %offs_mid_o_580 = arith.extsi %stride_mid_ob : i32 to i64 loc(#loc677)
    %offs_mid_o_581 = arith.muli %offs_mid_o, %offs_mid_o_580 : i64 loc(#loc677)
    %offs_mid_o_582 = arith.constant 2147483647 : i64 loc(#loc677)
    %offs_mid_o_583 = arith.constant -2147483648 : i64 loc(#loc677)
    %offs_mid_o_584 = arith.cmpi sle, %offs_mid_o_581, %offs_mid_o_582 : i64 loc(#loc677)
    %offs_mid_o_585 = arith.cmpi sge, %offs_mid_o_581, %offs_mid_o_583 : i64 loc(#loc677)
    %offs_mid_o_586 = arith.andi %offs_mid_o_584, %offs_mid_o_585 : i1 loc(#loc677)
    %offs_mid_o_587 = arith.muli %cur_batch_39, %stride_mid_ob : i32 loc(#loc677)
    %offs_mid_o_588 = tt.expand_dims %cur_head_66 {axis = 1 : i32} : tensor<16xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi32, #blocked> loc(#loc678)
    %offs_mid_o_589 = tt.splat %stride_mid_oh : i32 -> tensor<16x1xi32, #blocked> loc(#loc679)
    %offs_mid_o_590 = arith.extsi %offs_mid_o_588 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_591 = arith.extsi %offs_mid_o_589 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_592 = arith.muli %offs_mid_o_590, %offs_mid_o_591 : tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_593 = arith.constant 2147483647 : i64 loc(#loc679)
    %offs_mid_o_594 = arith.constant -2147483648 : i64 loc(#loc679)
    %offs_mid_o_595 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_596 = arith.cmpi sle, %offs_mid_o_592, %offs_mid_o_595 : tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_597 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_598 = arith.cmpi sge, %offs_mid_o_592, %offs_mid_o_597 : tensor<16x1xi64, #blocked> loc(#loc679)
    %offs_mid_o_599 = arith.andi %offs_mid_o_596, %offs_mid_o_598 : tensor<16x1xi1, #blocked> loc(#loc679)
    %offs_mid_o_600 = arith.muli %offs_mid_o_588, %offs_mid_o_589 : tensor<16x1xi32, #blocked> loc(#loc679)
    %offs_mid_o_601 = tt.splat %offs_mid_o_587 : i32 -> tensor<16x1xi32, #blocked> loc(#loc680)
    %offs_mid_o_602 = arith.extsi %offs_mid_o_601 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_603 = arith.extsi %offs_mid_o_600 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_604 = arith.addi %offs_mid_o_602, %offs_mid_o_603 : tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_605 = arith.constant 2147483647 : i64 loc(#loc680)
    %offs_mid_o_606 = arith.constant -2147483648 : i64 loc(#loc680)
    %offs_mid_o_607 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_608 = arith.cmpi sle, %offs_mid_o_604, %offs_mid_o_607 : tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_609 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_610 = arith.cmpi sge, %offs_mid_o_604, %offs_mid_o_609 : tensor<16x1xi64, #blocked> loc(#loc680)
    %offs_mid_o_611 = arith.andi %offs_mid_o_608, %offs_mid_o_610 : tensor<16x1xi1, #blocked> loc(#loc680)
    %offs_mid_o_612 = arith.addi %offs_mid_o_601, %offs_mid_o_600 : tensor<16x1xi32, #blocked> loc(#loc680)
    %offs_mid_o_613 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc681)
    %offs_mid_o_614 = arith.extsi %stride_mid_os : i32 to i64 loc(#loc681)
    %offs_mid_o_615 = arith.muli %offs_mid_o_613, %offs_mid_o_614 : i64 loc(#loc681)
    %offs_mid_o_616 = arith.constant 2147483647 : i64 loc(#loc681)
    %offs_mid_o_617 = arith.constant -2147483648 : i64 loc(#loc681)
    %offs_mid_o_618 = arith.cmpi sle, %offs_mid_o_615, %offs_mid_o_616 : i64 loc(#loc681)
    %offs_mid_o_619 = arith.cmpi sge, %offs_mid_o_615, %offs_mid_o_617 : i64 loc(#loc681)
    %offs_mid_o_620 = arith.andi %offs_mid_o_618, %offs_mid_o_619 : i1 loc(#loc681)
    %offs_mid_o_621 = arith.muli %split_kv_id_25, %stride_mid_os : i32 loc(#loc681)
    %offs_mid_o_622 = tt.splat %offs_mid_o_621 : i32 -> tensor<16x1xi32, #blocked> loc(#loc682)
    %offs_mid_o_623 = arith.extsi %offs_mid_o_612 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_624 = arith.extsi %offs_mid_o_622 : tensor<16x1xi32, #blocked> to tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_625 = arith.addi %offs_mid_o_623, %offs_mid_o_624 : tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_626 = arith.constant 2147483647 : i64 loc(#loc682)
    %offs_mid_o_627 = arith.constant -2147483648 : i64 loc(#loc682)
    %offs_mid_o_628 = arith.constant dense<2147483647> : tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_629 = arith.cmpi sle, %offs_mid_o_625, %offs_mid_o_628 : tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_630 = arith.constant dense<-2147483648> : tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_631 = arith.cmpi sge, %offs_mid_o_625, %offs_mid_o_630 : tensor<16x1xi64, #blocked> loc(#loc682)
    %offs_mid_o_632 = arith.andi %offs_mid_o_629, %offs_mid_o_631 : tensor<16x1xi1, #blocked> loc(#loc682)
    %offs_mid_o_633 = arith.addi %offs_mid_o_612, %offs_mid_o_622 : tensor<16x1xi32, #blocked> loc(#loc682)
    %offs_mid_o_634 = tt.expand_dims %offs_c {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc683)
    %offs_mid_o_635 = tt.broadcast %offs_mid_o_633 : tensor<16x1xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc684)
    %offs_mid_o_636 = tt.broadcast %offs_mid_o_634 : tensor<1x512xi32, #blocked> -> tensor<16x512xi32, #blocked> loc(#loc684)
    %offs_mid_o_637 = arith.extsi %offs_mid_o_635 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_638 = arith.extsi %offs_mid_o_636 : tensor<16x512xi32, #blocked> to tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_639 = arith.addi %offs_mid_o_637, %offs_mid_o_638 : tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_640 = arith.constant 2147483647 : i64 loc(#loc684)
    %offs_mid_o_641 = arith.constant -2147483648 : i64 loc(#loc684)
    %offs_mid_o_642 = arith.constant dense<2147483647> : tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_643 = arith.cmpi sle, %offs_mid_o_639, %offs_mid_o_642 : tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_644 = arith.constant dense<-2147483648> : tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_645 = arith.cmpi sge, %offs_mid_o_639, %offs_mid_o_644 : tensor<16x512xi64, #blocked> loc(#loc684)
    %offs_mid_o_646 = arith.andi %offs_mid_o_643, %offs_mid_o_645 : tensor<16x512xi1, #blocked> loc(#loc684)
    %offs_mid_o_647 = arith.addi %offs_mid_o_635, %offs_mid_o_636 : tensor<16x512xi32, #blocked> loc(#loc684)
    %37 = tt.expand_dims %mask_h_93 {axis = 1 : i32} : tensor<16xi1, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<16x1xi1, #blocked> loc(#loc324)
    %38 = tt.expand_dims %mask_c_211 {axis = 0 : i32} : tensor<512xi1, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi1, #blocked> loc(#loc325)
    %39 = tt.broadcast %37 : tensor<16x1xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc326)
    %40 = tt.broadcast %38 : tensor<1x512xi1, #blocked> -> tensor<16x512xi1, #blocked> loc(#loc326)
    %41 = arith.andi %39, %40 : tensor<16x512xi1, #blocked> loc(#loc326)
    amdgpu.buffer_store %cur_o, %Att_Out[%offs_mid_o_647], %41 : tensor<16x512xf32, #blocked> loc(#loc327)
    %offs_mid_lse = arith.extsi %cur_batch_39 : i32 to i64 loc(#loc685)
    %offs_mid_lse_648 = arith.extsi %stride_mid_lse_b : i32 to i64 loc(#loc685)
    %offs_mid_lse_649 = arith.muli %offs_mid_lse, %offs_mid_lse_648 : i64 loc(#loc685)
    %offs_mid_lse_650 = arith.constant 2147483647 : i64 loc(#loc685)
    %offs_mid_lse_651 = arith.constant -2147483648 : i64 loc(#loc685)
    %offs_mid_lse_652 = arith.cmpi sle, %offs_mid_lse_649, %offs_mid_lse_650 : i64 loc(#loc685)
    %offs_mid_lse_653 = arith.cmpi sge, %offs_mid_lse_649, %offs_mid_lse_651 : i64 loc(#loc685)
    %offs_mid_lse_654 = arith.andi %offs_mid_lse_652, %offs_mid_lse_653 : i1 loc(#loc685)
    %offs_mid_lse_655 = arith.muli %cur_batch_39, %stride_mid_lse_b : i32 loc(#loc685)
    %offs_mid_lse_656 = tt.splat %stride_mid_lse_h : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_657 = arith.extsi %offs_om : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_658 = arith.extsi %offs_mid_lse_656 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_659 = arith.muli %offs_mid_lse_657, %offs_mid_lse_658 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_660 = arith.constant 2147483647 : i64 loc(#loc686)
    %offs_mid_lse_661 = arith.constant -2147483648 : i64 loc(#loc686)
    %offs_mid_lse_662 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_663 = arith.cmpi sle, %offs_mid_lse_659, %offs_mid_lse_662 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_664 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_665 = arith.cmpi sge, %offs_mid_lse_659, %offs_mid_lse_664 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_666 = arith.andi %offs_mid_lse_663, %offs_mid_lse_665 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_667 = arith.muli %offs_om, %offs_mid_lse_656 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc686)
    %offs_mid_lse_668 = tt.splat %offs_mid_lse_655 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_669 = arith.extsi %offs_mid_lse_668 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_670 = arith.extsi %offs_mid_lse_667 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_671 = arith.addi %offs_mid_lse_669, %offs_mid_lse_670 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_672 = arith.constant 2147483647 : i64 loc(#loc687)
    %offs_mid_lse_673 = arith.constant -2147483648 : i64 loc(#loc687)
    %offs_mid_lse_674 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_675 = arith.cmpi sle, %offs_mid_lse_671, %offs_mid_lse_674 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_676 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_677 = arith.cmpi sge, %offs_mid_lse_671, %offs_mid_lse_676 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_678 = arith.andi %offs_mid_lse_675, %offs_mid_lse_677 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_679 = arith.addi %offs_mid_lse_668, %offs_mid_lse_667 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc687)
    %offs_mid_lse_680 = arith.extsi %split_kv_id_25 : i32 to i64 loc(#loc688)
    %offs_mid_lse_681 = arith.extsi %stride_mid_lse_s : i32 to i64 loc(#loc688)
    %offs_mid_lse_682 = arith.muli %offs_mid_lse_680, %offs_mid_lse_681 : i64 loc(#loc688)
    %offs_mid_lse_683 = arith.constant 2147483647 : i64 loc(#loc688)
    %offs_mid_lse_684 = arith.constant -2147483648 : i64 loc(#loc688)
    %offs_mid_lse_685 = arith.cmpi sle, %offs_mid_lse_682, %offs_mid_lse_683 : i64 loc(#loc688)
    %offs_mid_lse_686 = arith.cmpi sge, %offs_mid_lse_682, %offs_mid_lse_684 : i64 loc(#loc688)
    %offs_mid_lse_687 = arith.andi %offs_mid_lse_685, %offs_mid_lse_686 : i1 loc(#loc688)
    %offs_mid_lse_688 = arith.muli %split_kv_id_25, %stride_mid_lse_s : i32 loc(#loc688)
    %offs_mid_lse_689 = tt.splat %offs_mid_lse_688 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_690 = arith.extsi %offs_mid_lse_679 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_691 = arith.extsi %offs_mid_lse_689 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_692 = arith.addi %offs_mid_lse_690, %offs_mid_lse_691 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_693 = arith.constant 2147483647 : i64 loc(#loc689)
    %offs_mid_lse_694 = arith.constant -2147483648 : i64 loc(#loc689)
    %offs_mid_lse_695 = arith.constant dense<2147483647> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_696 = arith.cmpi sle, %offs_mid_lse_692, %offs_mid_lse_695 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_697 = arith.constant dense<-2147483648> : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_698 = arith.cmpi sge, %offs_mid_lse_692, %offs_mid_lse_697 : tensor<16xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_699 = arith.andi %offs_mid_lse_696, %offs_mid_lse_698 : tensor<16xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %offs_mid_lse_700 = arith.addi %offs_mid_lse_679, %offs_mid_lse_689 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc689)
    %mask_lse = arith.constant 1 : i32 loc(#loc690)
    %mask_lse_701 = arith.constant 1 : i32 loc(#loc690)
    %mask_lse_702 = arith.extsi %cur_head_id : i32 to i64 loc(#loc690)
    %mask_lse_703 = arith.extsi %mask_lse_701 : i32 to i64 loc(#loc690)
    %mask_lse_704 = arith.addi %mask_lse_702, %mask_lse_703 : i64 loc(#loc690)
    %mask_lse_705 = arith.constant 2147483647 : i64 loc(#loc690)
    %mask_lse_706 = arith.constant -2147483648 : i64 loc(#loc690)
    %mask_lse_707 = arith.cmpi sle, %mask_lse_704, %mask_lse_705 : i64 loc(#loc690)
    %mask_lse_708 = arith.cmpi sge, %mask_lse_704, %mask_lse_706 : i64 loc(#loc690)
    %mask_lse_709 = arith.andi %mask_lse_707, %mask_lse_708 : i1 loc(#loc690)
    %mask_lse_710 = arith.addi %cur_head_id, %mask_lse_701 : i32 loc(#loc690)
    %mask_lse_711 = arith.constant 8 : i32 loc(#loc691)
    %mask_lse_712 = arith.constant 8 : i32 loc(#loc691)
    %mask_lse_713 = arith.extsi %mask_lse_710 : i32 to i64 loc(#loc691)
    %mask_lse_714 = arith.extsi %mask_lse_712 : i32 to i64 loc(#loc691)
    %mask_lse_715 = arith.muli %mask_lse_713, %mask_lse_714 : i64 loc(#loc691)
    %mask_lse_716 = arith.constant 2147483647 : i64 loc(#loc691)
    %mask_lse_717 = arith.constant -2147483648 : i64 loc(#loc691)
    %mask_lse_718 = arith.cmpi sle, %mask_lse_715, %mask_lse_716 : i64 loc(#loc691)
    %mask_lse_719 = arith.cmpi sge, %mask_lse_715, %mask_lse_717 : i64 loc(#loc691)
    %mask_lse_720 = arith.andi %mask_lse_718, %mask_lse_719 : i1 loc(#loc691)
    %mask_lse_721 = arith.muli %mask_lse_710, %mask_lse_712 : i32 loc(#loc691)
    %mask_lse_722 = tt.splat %mask_lse_721 : i32 -> tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc692)
    %mask_lse_723 = arith.cmpi slt, %offs_om, %mask_lse_722 : tensor<16xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc692)
    %42 = math.log %e_sum_579 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc336)
    %43 = arith.subf %n_e_max_547, %42 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc337)
    amdgpu.buffer_store %43, %Att_Lse[%offs_mid_lse_700], %mask_lse_723 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc338)
    tt.return loc(#loc339)
  } loc(#loc1)
  tt.func private @"triton.language.standard.cdiv____(0,)cconstexpr_8__(1,)cconstexpr_16_"() -> i32 attributes {noinline = false} {
    %c1_i32 = arith.constant 1 : i32 loc(#loc341)
    tt.return %c1_i32 : i32 loc(#loc341)
  ^bb1:  // no predecessors
    %0 = ub.poison : i32 loc(#loc342)
    tt.return %0 : i32 loc(#loc342)
  } loc(#loc340)
  tt.func private @"aiter.ops.triton.utils._triton.pid_preprocessing.remap_xcd__i32_i32__(2,)cconstexpr_8_"(%pid: i32 loc("pid"(#loc343)), %GRID_MN: i32 loc("GRID_MN"(#loc343))) -> i32 attributes {noinline = false} {
    %pids_per_xcd = arith.constant 8 : i32 loc(#loc695)
    %pids_per_xcd_0 = arith.constant 8 : i32 loc(#loc695)
    %pids_per_xcd_1 = arith.extsi %GRID_MN : i32 to i64 loc(#loc695)
    %pids_per_xcd_2 = arith.extsi %pids_per_xcd_0 : i32 to i64 loc(#loc695)
    %pids_per_xcd_3 = arith.addi %pids_per_xcd_1, %pids_per_xcd_2 : i64 loc(#loc695)
    %pids_per_xcd_4 = arith.constant 2147483647 : i64 loc(#loc695)
    %pids_per_xcd_5 = arith.constant -2147483648 : i64 loc(#loc695)
    %pids_per_xcd_6 = arith.cmpi sle, %pids_per_xcd_3, %pids_per_xcd_4 : i64 loc(#loc695)
    %pids_per_xcd_7 = arith.cmpi sge, %pids_per_xcd_3, %pids_per_xcd_5 : i64 loc(#loc695)
    %pids_per_xcd_8 = arith.andi %pids_per_xcd_6, %pids_per_xcd_7 : i1 loc(#loc695)
    %pids_per_xcd_9 = arith.addi %GRID_MN, %pids_per_xcd_0 : i32 loc(#loc695)
    %pids_per_xcd_10 = arith.constant 1 : i32 loc(#loc696)
    %pids_per_xcd_11 = arith.constant 1 : i32 loc(#loc696)
    %pids_per_xcd_12 = arith.extsi %pids_per_xcd_9 : i32 to i64 loc(#loc696)
    %pids_per_xcd_13 = arith.extsi %pids_per_xcd_11 : i32 to i64 loc(#loc696)
    %pids_per_xcd_14 = arith.subi %pids_per_xcd_12, %pids_per_xcd_13 : i64 loc(#loc696)
    %pids_per_xcd_15 = arith.constant 2147483647 : i64 loc(#loc696)
    %pids_per_xcd_16 = arith.constant -2147483648 : i64 loc(#loc696)
    %pids_per_xcd_17 = arith.cmpi sle, %pids_per_xcd_14, %pids_per_xcd_15 : i64 loc(#loc696)
    %pids_per_xcd_18 = arith.cmpi sge, %pids_per_xcd_14, %pids_per_xcd_16 : i64 loc(#loc696)
    %pids_per_xcd_19 = arith.andi %pids_per_xcd_17, %pids_per_xcd_18 : i1 loc(#loc696)
    %pids_per_xcd_20 = arith.subi %pids_per_xcd_9, %pids_per_xcd_11 : i32 loc(#loc696)
    %pids_per_xcd_21 = arith.constant 8 : i32 loc(#loc697)
    %pids_per_xcd_22 = arith.constant 8 : i32 loc(#loc697)
    %pids_per_xcd_23 = arith.divsi %pids_per_xcd_20, %pids_per_xcd_22 : i32 loc(#loc697)
    %tall_xcds = arith.constant 8 : i32 loc(#loc698)
    %tall_xcds_24 = arith.constant 8 : i32 loc(#loc698)
    %tall_xcds_25 = arith.remsi %GRID_MN, %tall_xcds_24 : i32 loc(#loc698)
    %tall_xcds_26 = arith.constant 0 : i32 loc(#loc699)
    %tall_xcds_27 = arith.cmpi eq, %tall_xcds_25, %tall_xcds_26 : i32 loc(#loc699)
    %tall_xcds_28 = scf.if %tall_xcds_27 -> (i32) {
      %tall_xcds_33 = arith.constant 8 : i32 loc(#loc701)
      scf.yield %tall_xcds_33 : i32 loc(#loc701)
    } else {
      scf.yield %tall_xcds_25 : i32 loc(#loc)
    } loc(#loc700)
    %xcd = arith.constant 8 : i32 loc(#loc702)
    %xcd_29 = arith.constant 8 : i32 loc(#loc702)
    %xcd_30 = arith.remsi %pid, %xcd_29 : i32 loc(#loc702)
    %local_pid = arith.constant 8 : i32 loc(#loc703)
    %local_pid_31 = arith.constant 8 : i32 loc(#loc703)
    %local_pid_32 = arith.divsi %pid, %local_pid_31 : i32 loc(#loc703)
    %0 = arith.cmpi slt, %xcd_30, %tall_xcds_28 : i32 loc(#loc353)
    %1 = scf.if %0 -> (i32) {
      %pid_33 = arith.extsi %xcd_30 : i32 to i64 loc(#loc704)
      %pid_34 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc704)
      %pid_35 = arith.muli %pid_33, %pid_34 : i64 loc(#loc704)
      %pid_36 = arith.constant 2147483647 : i64 loc(#loc704)
      %pid_37 = arith.constant -2147483648 : i64 loc(#loc704)
      %pid_38 = arith.cmpi sle, %pid_35, %pid_36 : i64 loc(#loc704)
      %pid_39 = arith.cmpi sge, %pid_35, %pid_37 : i64 loc(#loc704)
      %pid_40 = arith.andi %pid_38, %pid_39 : i1 loc(#loc704)
      %pid_41 = arith.muli %xcd_30, %pids_per_xcd_23 : i32 loc(#loc704)
      %pid_42 = arith.extsi %pid_41 : i32 to i64 loc(#loc705)
      %pid_43 = arith.extsi %local_pid_32 : i32 to i64 loc(#loc705)
      %pid_44 = arith.addi %pid_42, %pid_43 : i64 loc(#loc705)
      %pid_45 = arith.constant 2147483647 : i64 loc(#loc705)
      %pid_46 = arith.constant -2147483648 : i64 loc(#loc705)
      %pid_47 = arith.cmpi sle, %pid_44, %pid_45 : i64 loc(#loc705)
      %pid_48 = arith.cmpi sge, %pid_44, %pid_46 : i64 loc(#loc705)
      %pid_49 = arith.andi %pid_47, %pid_48 : i1 loc(#loc705)
      %pid_50 = arith.addi %pid_41, %local_pid_32 : i32 loc(#loc722)
      scf.yield %pid_50 : i32 loc(#loc722)
    } else {
      %pid_33 = arith.extsi %tall_xcds_28 : i32 to i64 loc(#loc706)
      %pid_34 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc706)
      %pid_35 = arith.muli %pid_33, %pid_34 : i64 loc(#loc706)
      %pid_36 = arith.constant 2147483647 : i64 loc(#loc706)
      %pid_37 = arith.constant -2147483648 : i64 loc(#loc706)
      %pid_38 = arith.cmpi sle, %pid_35, %pid_36 : i64 loc(#loc706)
      %pid_39 = arith.cmpi sge, %pid_35, %pid_37 : i64 loc(#loc706)
      %pid_40 = arith.andi %pid_38, %pid_39 : i1 loc(#loc706)
      %pid_41 = arith.muli %tall_xcds_28, %pids_per_xcd_23 : i32 loc(#loc706)
      %pid_42 = arith.extsi %xcd_30 : i32 to i64 loc(#loc707)
      %pid_43 = arith.extsi %tall_xcds_28 : i32 to i64 loc(#loc707)
      %pid_44 = arith.subi %pid_42, %pid_43 : i64 loc(#loc707)
      %pid_45 = arith.constant 2147483647 : i64 loc(#loc707)
      %pid_46 = arith.constant -2147483648 : i64 loc(#loc707)
      %pid_47 = arith.cmpi sle, %pid_44, %pid_45 : i64 loc(#loc707)
      %pid_48 = arith.cmpi sge, %pid_44, %pid_46 : i64 loc(#loc707)
      %pid_49 = arith.andi %pid_47, %pid_48 : i1 loc(#loc707)
      %pid_50 = arith.subi %xcd_30, %tall_xcds_28 : i32 loc(#loc707)
      %pid_51 = arith.constant 1 : i32 loc(#loc708)
      %pid_52 = arith.constant 1 : i32 loc(#loc708)
      %pid_53 = arith.extsi %pids_per_xcd_23 : i32 to i64 loc(#loc708)
      %pid_54 = arith.extsi %pid_52 : i32 to i64 loc(#loc708)
      %pid_55 = arith.subi %pid_53, %pid_54 : i64 loc(#loc708)
      %pid_56 = arith.constant 2147483647 : i64 loc(#loc708)
      %pid_57 = arith.constant -2147483648 : i64 loc(#loc708)
      %pid_58 = arith.cmpi sle, %pid_55, %pid_56 : i64 loc(#loc708)
      %pid_59 = arith.cmpi sge, %pid_55, %pid_57 : i64 loc(#loc708)
      %pid_60 = arith.andi %pid_58, %pid_59 : i1 loc(#loc708)
      %pid_61 = arith.subi %pids_per_xcd_23, %pid_52 : i32 loc(#loc708)
      %pid_62 = arith.extsi %pid_50 : i32 to i64 loc(#loc709)
      %pid_63 = arith.extsi %pid_61 : i32 to i64 loc(#loc709)
      %pid_64 = arith.muli %pid_62, %pid_63 : i64 loc(#loc709)
      %pid_65 = arith.constant 2147483647 : i64 loc(#loc709)
      %pid_66 = arith.constant -2147483648 : i64 loc(#loc709)
      %pid_67 = arith.cmpi sle, %pid_64, %pid_65 : i64 loc(#loc709)
      %pid_68 = arith.cmpi sge, %pid_64, %pid_66 : i64 loc(#loc709)
      %pid_69 = arith.andi %pid_67, %pid_68 : i1 loc(#loc709)
      %pid_70 = arith.muli %pid_50, %pid_61 : i32 loc(#loc709)
      %pid_71 = arith.extsi %pid_41 : i32 to i64 loc(#loc710)
      %pid_72 = arith.extsi %pid_70 : i32 to i64 loc(#loc710)
      %pid_73 = arith.addi %pid_71, %pid_72 : i64 loc(#loc710)
      %pid_74 = arith.constant 2147483647 : i64 loc(#loc710)
      %pid_75 = arith.constant -2147483648 : i64 loc(#loc710)
      %pid_76 = arith.cmpi sle, %pid_73, %pid_74 : i64 loc(#loc710)
      %pid_77 = arith.cmpi sge, %pid_73, %pid_75 : i64 loc(#loc710)
      %pid_78 = arith.andi %pid_76, %pid_77 : i1 loc(#loc710)
      %pid_79 = arith.addi %pid_41, %pid_70 : i32 loc(#loc710)
      %pid_80 = arith.extsi %pid_79 : i32 to i64 loc(#loc711)
      %pid_81 = arith.extsi %local_pid_32 : i32 to i64 loc(#loc711)
      %pid_82 = arith.addi %pid_80, %pid_81 : i64 loc(#loc711)
      %pid_83 = arith.constant 2147483647 : i64 loc(#loc711)
      %pid_84 = arith.constant -2147483648 : i64 loc(#loc711)
      %pid_85 = arith.cmpi sle, %pid_82, %pid_83 : i64 loc(#loc711)
      %pid_86 = arith.cmpi sge, %pid_82, %pid_84 : i64 loc(#loc711)
      %pid_87 = arith.andi %pid_85, %pid_86 : i1 loc(#loc711)
      %pid_88 = arith.addi %pid_79, %local_pid_32 : i32 loc(#loc723)
      scf.yield %pid_88 : i32 loc(#loc711)
    } loc(#loc354)
    tt.return %1 : i32 loc(#loc363)
  ^bb1:  // no predecessors
    %2 = ub.poison : i32 loc(#loc364)
    tt.return %2 : i32 loc(#loc364)
  } loc(#loc343)
  tt.func private @"triton.language.standard.cdiv__i32__(1,)cconstexpr_64_"(%x: i32 loc("x"(#loc340))) -> i32 attributes {noinline = false} {
    %c64_i32 = arith.constant 64 : i32 loc(#loc365)
    %c64_i32_0 = arith.constant 64 : i32 loc(#loc365)
    %0 = arith.extsi %x : i32 to i64 loc(#loc365)
    %1 = arith.extsi %c64_i32_0 : i32 to i64 loc(#loc365)
    %2 = arith.addi %0, %1 : i64 loc(#loc365)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc365)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc365)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc365)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc365)
    %5 = arith.andi %3, %4 : i1 loc(#loc365)
    %6 = arith.addi %x, %c64_i32_0 : i32 loc(#loc365)
    %c1_i32 = arith.constant 1 : i32 loc(#loc366)
    %c1_i32_1 = arith.constant 1 : i32 loc(#loc366)
    %7 = arith.extsi %6 : i32 to i64 loc(#loc366)
    %8 = arith.extsi %c1_i32_1 : i32 to i64 loc(#loc366)
    %9 = arith.subi %7, %8 : i64 loc(#loc366)
    %c2147483647_i64_2 = arith.constant 2147483647 : i64 loc(#loc366)
    %c-2147483648_i64_3 = arith.constant -2147483648 : i64 loc(#loc366)
    %10 = arith.cmpi sle, %9, %c2147483647_i64_2 : i64 loc(#loc366)
    %11 = arith.cmpi sge, %9, %c-2147483648_i64_3 : i64 loc(#loc366)
    %12 = arith.andi %10, %11 : i1 loc(#loc366)
    %13 = arith.subi %6, %c1_i32_1 : i32 loc(#loc366)
    %c64_i32_4 = arith.constant 64 : i32 loc(#loc367)
    %c64_i32_5 = arith.constant 64 : i32 loc(#loc367)
    %14 = arith.divsi %13, %c64_i32_5 : i32 loc(#loc367)
    tt.return %14 : i32 loc(#loc341)
  ^bb1:  // no predecessors
    %15 = ub.poison : i32 loc(#loc342)
    tt.return %15 : i32 loc(#loc342)
  } loc(#loc340)
  tt.func private @"triton.language.standard.cdiv__i32__(1,)cconstexpr_8_"(%x: i32 loc("x"(#loc340))) -> i32 attributes {noinline = false} {
    %c8_i32 = arith.constant 8 : i32 loc(#loc365)
    %c8_i32_0 = arith.constant 8 : i32 loc(#loc365)
    %0 = arith.extsi %x : i32 to i64 loc(#loc365)
    %1 = arith.extsi %c8_i32_0 : i32 to i64 loc(#loc365)
    %2 = arith.addi %0, %1 : i64 loc(#loc365)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc365)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc365)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc365)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc365)
    %5 = arith.andi %3, %4 : i1 loc(#loc365)
    %6 = arith.addi %x, %c8_i32_0 : i32 loc(#loc365)
    %c1_i32 = arith.constant 1 : i32 loc(#loc366)
    %c1_i32_1 = arith.constant 1 : i32 loc(#loc366)
    %7 = arith.extsi %6 : i32 to i64 loc(#loc366)
    %8 = arith.extsi %c1_i32_1 : i32 to i64 loc(#loc366)
    %9 = arith.subi %7, %8 : i64 loc(#loc366)
    %c2147483647_i64_2 = arith.constant 2147483647 : i64 loc(#loc366)
    %c-2147483648_i64_3 = arith.constant -2147483648 : i64 loc(#loc366)
    %10 = arith.cmpi sle, %9, %c2147483647_i64_2 : i64 loc(#loc366)
    %11 = arith.cmpi sge, %9, %c-2147483648_i64_3 : i64 loc(#loc366)
    %12 = arith.andi %10, %11 : i1 loc(#loc366)
    %13 = arith.subi %6, %c1_i32_1 : i32 loc(#loc366)
    %c8_i32_4 = arith.constant 8 : i32 loc(#loc367)
    %c8_i32_5 = arith.constant 8 : i32 loc(#loc367)
    %14 = arith.divsi %13, %c8_i32_5 : i32 loc(#loc367)
    tt.return %14 : i32 loc(#loc341)
  ^bb1:  // no predecessors
    %15 = ub.poison : i32 loc(#loc342)
    tt.return %15 : i32 loc(#loc342)
  } loc(#loc340)
  tt.func private @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_256__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16 ,16), transposed=True, warps_per_cta=(1 ,4), elem_type=triton_d_language_d_float32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() -> tensor<16x256xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc369)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<16x256xf32, #mma> loc(#loc369)
    tt.return %cst_0 : tensor<16x256xf32, #mma> loc(#loc370)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<16x256xf32, #mma> loc(#loc371)
    tt.return %0 : tensor<16x256xf32, #mma> loc(#loc371)
  } loc(#loc368)
  tt.func private @"triton.experimental.gluon.language._standard.zeros____(0, 0)cconstexpr_16__(0, 1)cconstexpr_32__(1,)cconstexpr_fp32__(2,)cconstexpr_AMDMFMALayout(version=3, instr_shape=(16 ,16), transposed=True, warps_per_cta=(1 ,4), elem_type=triton_d_language_d_float32, tiles_per_warp=_1, 1_, ctas_per_cga=_1, 1_, cta_split_num=_1, 1_, cta_order=_1, 0_)_"() -> tensor<16x32xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc369)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<16x32xf32, #mma> loc(#loc369)
    tt.return %cst_0 : tensor<16x32xf32, #mma> loc(#loc370)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<16x32xf32, #mma> loc(#loc371)
    tt.return %0 : tensor<16x32xf32, #mma> loc(#loc371)
  } loc(#loc368)
  tt.func private @"triton.language.standard.max__fp32S16_32SLMFMA_3_16_16_True_1_4_1_1_fp32_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cconstexpr_True__(4,)cconstexpr_False_"(%input: tensor<16x32xf32, #mma> loc("input"(#loc372))) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._elementwise_max__fp32_fp32__(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc373)
      tt.reduce.return %2 : f32 loc(#loc373)
    }) : (tensor<16x32xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc373)
    tt.return %0 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc374)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc375)
    tt.return %1 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc375)
  } loc(#loc372)
  tt.func private @triton.language.standard._elementwise_max__fp32_fp32__(%a: f32 loc("a"(#loc376)), %b: f32 loc("b"(#loc376))) -> f32 attributes {noinline = false} {
    %0 = arith.maxnumf %a, %b : f32 loc(#loc377)
    tt.return %0 : f32 loc(#loc378)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc379)
    tt.return %1 : f32 loc(#loc379)
  } loc(#loc376)
  tt.func private @"triton.language.standard.sum__fp32S16_32SLMFMA_3_16_16_True_1_4_1_1_fp32_1_1_1_1_1_0_MFMAL__(1,)cconstexpr_1__(2,)cconstexpr_False__(3,)cNone"(%input: tensor<16x32xf32, #mma> loc("input"(#loc380))) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._sum_combine__fp32_fp32__(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc381)
      tt.reduce.return %2 : f32 loc(#loc381)
    }) : (tensor<16x32xf32, #mma>) -> tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc381)
    tt.return %0 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc382)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc383)
    tt.return %1 : tensor<16xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc383)
  } loc(#loc380)
  tt.func private @triton.language.standard._sum_combine__fp32_fp32__(%a: f32 loc("a"(#loc384)), %b: f32 loc("b"(#loc384))) -> f32 attributes {noinline = false} {
    %0 = arith.addf %a, %b : f32 loc(#loc385)
    tt.return %0 : f32 loc(#loc386)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc387)
    tt.return %1 : f32 loc(#loc387)
  } loc(#loc384)
} loc(#loc)
#loc2 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":568:24)
#loc3 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":569:41)
#loc4 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":571:48)
#loc5 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":571:31)
#loc6 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":572:71)
#loc7 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":572:54)
#loc8 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":574:38)
#loc9 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":575:40)
#loc10 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":575:58)
#loc11 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":578:29)
#loc12 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":580:42)
#loc13 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":580:25)
#loc14 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":580:60)
#loc15 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":583:49)
#loc16 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":583:37)
#loc17 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":584:47)
#loc18 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":584:62)
#loc19 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":584:35)
#loc20 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":630:27)
#loc21 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":633:27)
#loc22 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":636:27)
#loc23 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":640:27)
#loc24 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":669:29)
#loc25 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":670:11)
#loc26 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":669:45)
#loc27 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":672:39)
#loc28 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":672:44)
#loc29 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":672:24)
#loc30 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":673:34)
#loc31 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":673:23)
#loc32 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":676:11)
#loc33 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":680:11)
#loc34 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":684:11)
#loc35 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":686:30)
#loc36 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":687:43)
#loc37 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":687:29)
#loc38 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":690:11)
#loc39 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":694:11)
#loc40 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":696:24)
#loc41 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":697:35)
#loc42 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":697:25)
#loc43 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":699:11)
#loc44 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":701:24)
#loc45 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":705:8)
#loc46 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":713:11)
#loc47 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":717:8)
#loc48 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":721:47)
#loc49 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":722:54)
#loc50 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":725:20)
#loc51 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":725:44)
#loc52 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":725:55)
#loc53 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":725:32)
#loc54 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":725:77)
#loc55 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":725:67)
#loc56 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":727:25)
#loc57 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":727:46)
#loc58 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":727:57)
#loc59 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":727:37)
#loc60 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":727:76)
#loc61 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":727:69)
#loc62 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":729:22)
#loc63 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":730:26)
#loc64 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":731:29)
#loc65 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":732:27)
#loc66 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":734:53)
#loc67 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":735:40)
#loc68 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":741:24)
#loc69 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":741:42)
#loc70 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":742:8)
#loc71 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":744:17)
#loc72 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":745:25)
#loc73 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":745:45)
#loc74 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":745:63)
#loc75 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":745:7)
#loc76 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":746:21)
#loc77 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":748:47)
#loc78 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":748:65)
#loc79 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":750:38)
#loc80 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":750:43)
#loc81 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":750:62)
#loc82 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":755:21)
#loc83 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":755:41)
#loc84 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":755:34)
#loc85 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":755:8)
#loc86 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":760:24)
#loc87 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":760:47)
#loc88 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":760:37)
#loc89 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":760:8)
#loc90 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":763:21)
#loc91 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":763:50)
#loc92 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":763:38)
#loc93 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":763:8)
#loc94 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":769:22)
#loc95 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":770:22)
#loc96 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":771:22)
#loc97 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":773:23)
#loc98 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":774:23)
#loc99 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":775:27)
#loc100 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":776:27)
#loc101 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":778:22)
#loc102 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":779:28)
#loc103 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":781:4)
#loc104 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":782:4)
#loc105 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":783:4)
#loc106 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":789:34)
#loc107 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":792:20)
#loc108 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":795:20)
#loc109 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":800:8)
#loc110 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":802:20)
#loc111 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":802:38)
#loc112 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":803:33)
#loc113 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":803:51)
#loc114 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":804:25)
#loc115 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":805:23)
#loc116 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":805:34)
#loc117 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":805:59)
#loc118 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":805:50)
#loc119 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":813:20)
#loc120 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":813:40)
#loc121 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":813:31)
#loc122 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":813:8)
#loc123 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":818:30)
#loc124 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":819:20)
#loc125 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":819:40)
#loc126 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":819:31)
#loc127 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":819:8)
#loc128 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":826:34)
#loc129 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":829:34)
#loc130 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":832:31)
#loc131 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":834:19)
#loc132 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":835:19)
#loc133 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":837:23)
#loc134 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":837:41)
#loc135 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":838:28)
#loc136 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":838:39)
#loc137 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":838:64)
#loc138 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":838:55)
#loc139 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":839:33)
#loc140 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":839:51)
#loc141 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":840:28)
#loc142 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":848:23)
#loc143 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":848:43)
#loc144 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":848:34)
#loc145 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":848:8)
#loc146 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":855:32)
#loc147 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":856:20)
#loc148 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":861:27)
#loc149 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":862:27)
#loc150 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":865:34)
#loc151 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":866:29)
#loc152 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":868:19)
#loc153 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":870:34)
#loc154 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":871:29)
#loc155 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":873:19)
#loc156 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":875:22)
#loc157 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":876:31)
#loc158 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":879:38)
#loc159 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":880:42)
#loc160 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":880:59)
#loc161 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":880:84)
#loc162 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":881:98)
#loc163 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":881:40)
#loc164 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":881:55)
#loc165 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":881:80)
#loc166 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":881:84)
#loc167 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":881:139)
#loc168 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":887:37)
#loc169 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":888:35)
#loc170 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":889:34)
#loc171 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":896:25)
#loc172 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":896:53)
#loc173 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":896:41)
#loc174 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":896:12)
#loc175 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":899:36)
#loc176 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":901:35)
#loc177 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":902:24)
#loc178 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":902:42)
#loc179 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":902:66)
#loc180 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":902:50)
#loc181 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":903:27)
#loc182 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":903:38)
#loc183 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":903:63)
#loc184 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":903:54)
#loc185 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":904:36)
#loc186 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":904:54)
#loc187 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":904:78)
#loc188 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":904:62)
#loc189 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":905:29)
#loc190 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":906:35)
#loc191 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":911:43)
#loc192 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":915:24)
#loc193 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":915:44)
#loc194 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":915:35)
#loc195 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":915:12)
#loc196 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":918:35)
#loc197 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":920:43)
#loc198 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":923:34)
#loc199 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":924:24)
#loc200 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":924:44)
#loc201 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":924:35)
#loc202 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":924:12)
#loc203 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":930:31)
#loc204 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":931:31)
#loc205 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":933:47)
#loc206 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":935:14)
#loc207 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":937:27)
#loc208 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":937:45)
#loc209 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":937:72)
#loc210 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":937:56)
#loc211 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":938:32)
#loc212 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":938:43)
#loc213 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":938:68)
#loc214 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":938:59)
#loc215 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":939:36)
#loc216 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":939:54)
#loc217 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":939:81)
#loc218 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":939:65)
#loc219 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":940:32)
#loc220 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":942:35)
#loc221 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":946:27)
#loc222 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":946:47)
#loc223 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":946:38)
#loc224 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":946:12)
#loc225 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":952:47)
#loc226 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":952:51)
#loc227 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":953:38)
#loc228 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":957:41)
#loc229 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":957:52)
#loc230 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":957:32)
#loc231 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":958:39)
#loc232 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":958:31)
#loc233 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":958:51)
#loc234 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":958:25)
#loc235 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":959:26)
#loc236 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":959:21)
#loc237 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":960:35)
#loc238 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":962:28)
#loc239 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":964:38)
#loc240 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":966:38)
#loc241 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":968:23)
#loc242 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":969:31)
#loc243 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":969:22)
#loc244 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":974:48)
#loc245 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":975:24)
#loc246 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":975:45)
#loc247 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":975:35)
#loc248 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":977:23)
#loc249 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":978:31)
#loc250 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":978:22)
#loc251 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":979:48)
#loc252 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":980:26)
#loc253 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":983:31)
#loc254 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":984:33)
#loc255 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":985:35)
#loc256 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":987:38)
#loc257 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":989:23)
#loc258 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":990:31)
#loc259 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":992:33)
#loc260 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":993:35)
#loc261 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":995:38)
#loc262 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":996:23)
#loc263 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":996:8)
#loc264 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":998:39)
#loc265 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":999:39)
#loc266 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1001:32)
#loc267 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1003:43)
#loc268 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1005:27)
#loc269 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1006:27)
#loc270 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1008:10)
#loc271 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1010:32)
#loc272 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1010:37)
#loc273 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1010:77)
#loc274 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1010:55)
#loc275 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1013:19)
#loc276 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1013:30)
#loc277 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1013:62)
#loc278 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1013:74)
#loc279 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1013:52)
#loc280 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1013:82)
#loc281 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1016:43)
#loc282 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1016:47)
#loc283 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1018:34)
#loc284 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1019:37)
#loc285 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1019:48)
#loc286 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1019:28)
#loc287 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1020:35)
#loc288 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1020:27)
#loc289 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1020:47)
#loc290 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1020:21)
#loc291 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1022:22)
#loc292 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1022:17)
#loc293 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1024:27)
#loc294 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1024:18)
#loc295 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1025:27)
#loc296 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1025:18)
#loc297 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1026:20)
#loc298 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1026:41)
#loc299 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1026:31)
#loc300 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1027:31)
#loc301 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1028:24)
#loc302 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1031:44)
#loc303 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1034:44)
#loc304 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1036:4)
#loc305 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1037:4)
#loc306 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1039:24)
#loc307 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1040:27)
#loc308 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1041:26)
#loc309 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1042:33)
#loc310 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1045:33)
#loc311 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1048:16)
#loc312 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1049:29)
#loc313 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1049:23)
#loc314 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1049:17)
#loc315 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1051:24)
#loc316 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1054:20)
#loc317 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1055:19)
#loc318 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1055:30)
#loc319 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1055:10)
#loc320 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1056:24)
#loc321 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1056:10)
#loc322 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1057:17)
#loc323 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1057:10)
#loc324 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1070:21)
#loc325 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1070:41)
#loc326 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1070:34)
#loc327 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1070:8)
#loc328 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1074:20)
#loc329 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1075:20)
#loc330 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1075:10)
#loc331 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1076:24)
#loc332 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1076:10)
#loc333 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1079:40)
#loc334 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1079:45)
#loc335 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1079:25)
#loc336 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1081:36)
#loc337 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1081:29)
#loc338 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1085:8)
#loc339 = loc("/workspace/aiter/aiter/ops/triton/gluon/mla_decode.py":1080:4)
#loc341 = loc("/workspace/triton/python/triton/language/standard.py":41:11)
#loc342 = loc("/workspace/triton/python/triton/language/standard.py":41:4)
#loc344 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:30)
#loc345 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:41)
#loc346 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":31:47)
#loc347 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":36:26)
#loc348 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:41)
#loc349 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:28)
#loc350 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":37:16)
#loc351 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":39:16)
#loc352 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":40:23)
#loc353 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":45:13)
#loc354 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":45:7)
#loc355 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":46:20)
#loc356 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":46:35)
#loc357 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":49:24)
#loc358 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:21)
#loc359 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:50)
#loc360 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:35)
#loc361 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":50:14)
#loc362 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":51:14)
#loc363 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":54:11)
#loc364 = loc("/workspace/aiter/aiter/ops/triton/utils/_triton/pid_preprocessing.py":54:4)
#loc365 = loc("/workspace/triton/python/triton/language/standard.py":41:16)
#loc366 = loc("/workspace/triton/python/triton/language/standard.py":41:22)
#loc367 = loc("/workspace/triton/python/triton/language/standard.py":41:28)
#loc368 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":28:0)
#loc369 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:38)
#loc370 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:11)
#loc371 = loc("/workspace/triton/python/triton/experimental/gluon/language/_standard.py":40:4)
#loc373 = loc("/workspace/triton/python/triton/language/standard.py":189:40)
#loc374 = loc("/workspace/triton/python/triton/language/standard.py":189:15)
#loc375 = loc("/workspace/triton/python/triton/language/standard.py":177:4)
#loc377 = loc("/workspace/triton/python/triton/language/standard.py":168:27)
#loc378 = loc("/workspace/triton/python/triton/language/standard.py":168:11)
#loc379 = loc("/workspace/triton/python/triton/language/standard.py":168:4)
#loc381 = loc("/workspace/triton/python/triton/language/standard.py":291:36)
#loc382 = loc("/workspace/triton/python/triton/language/standard.py":291:11)
#loc383 = loc("/workspace/triton/python/triton/language/standard.py":291:4)
#loc385 = loc("/workspace/triton/python/triton/language/standard.py":261:15)
#loc386 = loc("/workspace/triton/python/triton/language/standard.py":261:11)
#loc387 = loc("/workspace/triton/python/triton/language/standard.py":261:4)
#loc407 = loc("pid"(#loc2))
#loc408 = loc("num_q_head_blk"(#loc3))
#loc409 = loc("pid_head_kv_split"(#loc4))
#loc410 = loc("pid_head_kv_split"(#loc5))
#loc411 = loc("pid_head_kv_split"(#loc6))
#loc412 = loc("pid_head_kv_split"(#loc7))
#loc413 = loc("cur_head_id"(#loc8))
#loc414 = loc("split_kv_id"(#loc9))
#loc415 = loc("split_kv_id"(#loc10))
#loc416 = loc("page_block_per_block_N"(#loc11))
#loc417 = loc("cur_batch"(#loc12))
#loc418 = loc("cur_batch"(#loc13))
#loc419 = loc("cur_batch"(#loc14))
#loc420 = loc("cur_batch_kv_start_idx"(#loc15))
#loc421 = loc("cur_batch_kv_start_idx"(#loc16))
#loc422 = loc("cur_batch_kv_end_idx"(#loc17))
#loc423 = loc("cur_batch_kv_end_idx"(#loc18))
#loc424 = loc("cur_batch_kv_end_idx"(#loc19))
#loc425 = loc("smem_q0_nope"(#loc20))
#loc426 = loc("smem_q1_nope"(#loc21))
#loc427 = loc("smem_q_rope"(#loc22))
#loc428 = loc("smem_p"(#loc23))
#loc429 = loc("cur_head"(#loc24))
#loc430 = loc("cur_head"(#loc25))
#loc431 = loc("cur_head"(#loc26))
#loc432 = loc("mask_h"(#loc27))
#loc433 = loc("mask_h"(#loc28))
#loc434 = loc("mask_h"(#loc29))
#loc435 = loc("mask_h"(#loc30))
#loc436 = loc("mask_h"(#loc31))
#loc437 = loc("cur_N"(#loc32))
#loc438 = loc("cur_N_pe"(#loc33))
#loc439 = loc("cur_head_pe"(#loc34))
#loc440 = loc("mask_h_pe"(#loc35))
#loc441 = loc("mask_h_pe"(#loc36))
#loc442 = loc("mask_h_pe"(#loc37))
#loc443 = loc("offs_c"(#loc38))
#loc444 = loc("offs_om"(#loc39))
#loc445 = loc("mask_om"(#loc40))
#loc446 = loc("mask_om"(#loc41))
#loc447 = loc("mask_om"(#loc42))
#loc448 = loc("offs_on"(#loc43))
#loc449 = loc("mask_on"(#loc44))
#loc450 = loc("offs_qk_r"(#loc45))
#loc451 = loc("offs_k_c"(#loc46))
#loc452 = loc("offs_k_r"(#loc47))
#loc453 = loc("cur_batch_seq_len"(#loc48))
#loc454 = loc("cur_batch_block_nums"(#loc49))
#loc455 = loc("off_q_pe"(#loc50))
#loc456 = loc("off_q_pe"(#loc51))
#loc457 = loc("off_q_pe"(#loc52))
#loc458 = loc("off_q_pe"(#loc53))
#loc459 = loc("off_q_pe"(#loc54))
#loc460 = loc("off_q_pe"(#loc55))
#loc461 = loc("offs_q"(#loc56))
#loc462 = loc("offs_q"(#loc57))
#loc463 = loc("offs_q"(#loc58))
#loc464 = loc("offs_q"(#loc59))
#loc465 = loc("offs_q"(#loc60))
#loc466 = loc("offs_q"(#loc61))
#loc467 = loc("mask_c"(#loc62))
#loc468 = loc("mask_k_c"(#loc63))
#loc469 = loc("mask_qk_r"(#loc64))
#loc470 = loc("mask_k_r"(#loc65))
#loc471 = loc("blocks_per_split"(#loc66))
#loc472 = loc("split_kv_start"(#loc67))
#loc473 = loc("tail_block"(#loc71))
#loc474 = loc("tail_block"(#loc76))
#loc475 = loc("split_kv_end"(#loc77))
#loc476 = loc("split_kv_end"(#loc78))
#loc477 = loc("block_tail"(#loc79))
#loc478 = loc("block_tail"(#loc80))
#loc479 = loc("block_tail"(#loc81))
#loc480 = loc("q"(#loc82))
#loc481 = loc("q"(#loc83))
#loc482 = loc("q"(#loc84))
#loc483 = loc("q"(#loc85))
#loc484 = loc("q_pe"(#loc86))
#loc485 = loc("q_pe"(#loc87))
#loc486 = loc("q_pe"(#loc88))
#loc487 = loc("q_pe"(#loc89))
#loc488 = loc("kv_loc"(#loc90))
#loc489 = loc("kv_loc"(#loc91))
#loc490 = loc("kv_loc"(#loc92))
#loc491 = loc("kv_loc"(#loc93))
#loc492 = loc("q"(#loc94))
#loc493 = loc("q"(#loc95))
#loc494 = loc("q0"(#loc99))
#loc495 = loc("q1"(#loc100))
#loc496 = loc("q_pe"(#loc102))
#loc497 = loc("smem_k_rope"(#loc106))
#loc498 = loc("acc1"(#loc107))
#loc499 = loc("acc2"(#loc108))
#loc500 = loc("zeros"(#loc109))
#loc501 = loc("k_id"(#loc110))
#loc502 = loc("k_id"(#loc111))
#loc503 = loc("mask_k_id"(#loc112))
#loc504 = loc("mask_k_id"(#loc113))
#loc505 = loc("mask_k"(#loc114))
#loc506 = loc("offs_buf_kv"(#loc115))
#loc507 = loc("offs_buf_kv"(#loc116))
#loc508 = loc("offs_buf_kv"(#loc117))
#loc509 = loc("offs_buf_kv"(#loc118))
#loc510 = loc("kv1"(#loc119))
#loc511 = loc("kv1"(#loc120))
#loc512 = loc("kv1"(#loc121))
#loc513 = loc("kv1"(#loc122))
#loc514 = loc("kv2"(#loc123))
#loc515 = loc("kv2"(#loc124))
#loc516 = loc("kv2"(#loc125))
#loc517 = loc("kv2"(#loc126))
#loc518 = loc("kv2"(#loc127))
#loc519 = loc("smem_kv1"(#loc128))
#loc520 = loc("smem_kv2"(#loc129))
#loc521 = loc("k_id_pe"(#loc133))
#loc522 = loc("k_id_pe"(#loc134))
#loc523 = loc("offs_buf_k_pe"(#loc135))
#loc524 = loc("offs_buf_k_pe"(#loc136))
#loc525 = loc("offs_buf_k_pe"(#loc137))
#loc526 = loc("offs_buf_k_pe"(#loc138))
#loc527 = loc("mask_k_id"(#loc139))
#loc528 = loc("mask_k_id"(#loc140))
#loc529 = loc("mask_k_pe"(#loc141))
#loc530 = loc("k_pe"(#loc142))
#loc531 = loc("k_pe"(#loc143))
#loc532 = loc("k_pe"(#loc144))
#loc533 = loc("k_pe"(#loc145))
#loc534 = loc("e_sum"(#loc146))
#loc535 = loc("e_max"(#loc147))
#loc536 = loc("cur_k1"(#loc148))
#loc537 = loc("cur_k2"(#loc149))
#loc538 = loc("smem_kv1"(#loc150))
#loc539 = loc("kv1_transpose"(#loc151))
#loc540 = loc("smem_kv2"(#loc153))
#loc541 = loc("kv2_transpose"(#loc154))
#loc542 = loc("mask_qk_h"(#loc158))
#loc543 = loc("loop_begin"(#loc159))
#loc544 = loc("loop_begin"(#loc160))
#loc545 = loc("loop_begin"(#loc161))
#loc546 = loc("loop_end"(#loc162))
#loc547 = loc("loop_end"(#loc163))
#loc548 = loc("loop_end"(#loc164))
#loc549 = loc("loop_end"(#loc165))
#loc550 = loc("loop_end"(#loc166))
#loc551 = loc("loop_end"(#loc167))
#loc552 = loc("kv_loc"(#loc168))
#loc553 = loc("start_n_block"(#loc169))
#loc554 = loc("start_n_inner"(#loc170))
#loc555 = loc("kv_loc"(#loc171))
#loc556 = loc("kv_loc"(#loc172))
#loc557 = loc("kv_loc"(#loc173))
#loc558 = loc("kv_loc"(#loc174))
#loc559 = loc("cur_k_pe"(#loc175))
#loc560 = loc("k_id"(#loc177))
#loc561 = loc("k_id"(#loc178))
#loc562 = loc("k_id"(#loc179))
#loc563 = loc("k_id"(#loc180))
#loc564 = loc("offs_buf_kv"(#loc181))
#loc565 = loc("offs_buf_kv"(#loc182))
#loc566 = loc("offs_buf_kv"(#loc183))
#loc567 = loc("offs_buf_kv"(#loc184))
#loc568 = loc("mask_k_id"(#loc185))
#loc569 = loc("mask_k_id"(#loc186))
#loc570 = loc("mask_k_id"(#loc187))
#loc571 = loc("mask_k_id"(#loc188))
#loc572 = loc("mask_k"(#loc189))
#loc573 = loc("qk"(#loc191))
#loc574 = loc("kv1"(#loc192))
#loc575 = loc("kv1"(#loc193))
#loc576 = loc("kv1"(#loc194))
#loc577 = loc("kv1"(#loc195))
#loc578 = loc("qk"(#loc197))
#loc579 = loc("kv2"(#loc198))
#loc580 = loc("kv2"(#loc199))
#loc581 = loc("kv2"(#loc200))
#loc582 = loc("kv2"(#loc201))
#loc583 = loc("kv2"(#loc202))
#loc584 = loc("cur_k1"(#loc203))
#loc585 = loc("cur_k2"(#loc204))
#loc586 = loc("qk"(#loc205))
#loc587 = loc("qk"(#loc206))
#loc588 = loc("k_id_pe"(#loc207))
#loc589 = loc("k_id_pe"(#loc208))
#loc590 = loc("k_id_pe"(#loc209))
#loc591 = loc("k_id_pe"(#loc210))
#loc592 = loc("offs_buf_k_pe"(#loc211))
#loc593 = loc("offs_buf_k_pe"(#loc212))
#loc594 = loc("offs_buf_k_pe"(#loc213))
#loc595 = loc("offs_buf_k_pe"(#loc214))
#loc596 = loc("mask_k_id"(#loc215))
#loc597 = loc("mask_k_id"(#loc216))
#loc598 = loc("mask_k_id"(#loc217))
#loc599 = loc("mask_k_id"(#loc218))
#loc600 = loc("mask_k_pe"(#loc219))
#loc601 = loc("k_pe"(#loc221))
#loc602 = loc("k_pe"(#loc222))
#loc603 = loc("k_pe"(#loc223))
#loc604 = loc("k_pe"(#loc224))
#loc605 = loc("n_e_max"(#loc225))
#loc606 = loc("n_e_max"(#loc226))
#loc607 = loc("n_e_max"(#loc227))
#loc608 = loc("re_scale"(#loc228))
#loc609 = loc("re_scale"(#loc229))
#loc610 = loc("re_scale"(#loc230))
#loc611 = loc("p"(#loc231))
#loc612 = loc("p"(#loc232))
#loc613 = loc("p"(#loc233))
#loc614 = loc("p"(#loc234))
#loc615 = loc("cur_p"(#loc238))
#loc616 = loc("smem_kv1"(#loc239))
#loc617 = loc("smem_kv2"(#loc240))
#loc618 = loc("acc1"(#loc242))
#loc619 = loc("acc1"(#loc243))
#loc620 = loc("acc1"(#loc244))
#loc621 = loc("e_sum"(#loc245))
#loc622 = loc("e_sum"(#loc246))
#loc623 = loc("e_sum"(#loc247))
#loc624 = loc("acc2"(#loc249))
#loc625 = loc("acc2"(#loc250))
#loc626 = loc("acc2"(#loc251))
#loc627 = loc("cur_k1"(#loc253))
#loc628 = loc("kv1_transpose"(#loc254))
#loc629 = loc("smem_kv1"(#loc256))
#loc630 = loc("cur_k2"(#loc258))
#loc631 = loc("kv2_transpose"(#loc259))
#loc632 = loc("smem_kv2"(#loc261))
#loc633 = loc("qk"(#loc264))
#loc634 = loc("qk"(#loc265))
#loc635 = loc("cur_k_pe"(#loc266))
#loc636 = loc("qk"(#loc267))
#loc637 = loc("cur_k1"(#loc268))
#loc638 = loc("cur_k2"(#loc269))
#loc639 = loc("qk"(#loc270))
#loc640 = loc("mask_qk_n"(#loc271))
#loc641 = loc("mask_qk_n"(#loc272))
#loc642 = loc("mask_qk_n"(#loc273))
#loc643 = loc("mask_qk_n"(#loc274))
#loc644 = loc("qk"(#loc275))
#loc645 = loc("qk"(#loc276))
#loc646 = loc("qk"(#loc277))
#loc647 = loc("qk"(#loc278))
#loc648 = loc("qk"(#loc279))
#loc649 = loc("qk"(#loc280))
#loc650 = loc("n_e_max"(#loc281))
#loc651 = loc("n_e_max"(#loc282))
#loc652 = loc("n_e_max"(#loc283))
#loc653 = loc("re_scale"(#loc284))
#loc654 = loc("re_scale"(#loc285))
#loc655 = loc("re_scale"(#loc286))
#loc656 = loc("p"(#loc287))
#loc657 = loc("p"(#loc288))
#loc658 = loc("p"(#loc289))
#loc659 = loc("p"(#loc290))
#loc660 = loc("acc1"(#loc293))
#loc661 = loc("acc1"(#loc294))
#loc662 = loc("acc2"(#loc295))
#loc663 = loc("acc2"(#loc296))
#loc664 = loc("e_sum"(#loc297))
#loc665 = loc("e_sum"(#loc298))
#loc666 = loc("e_sum"(#loc299))
#loc667 = loc("cur_p"(#loc301))
#loc668 = loc("acc1"(#loc302))
#loc669 = loc("acc2"(#loc303))
#loc670 = loc("acc"(#loc306))
#loc671 = loc("acc"(#loc307))
#loc672 = loc("acc"(#loc308))
#loc673 = loc("acc"(#loc309))
#loc674 = loc("smem_o"(#loc310))
#loc675 = loc("e_sum"(#loc311))
#loc676 = loc("cur_o"(#loc315))
#loc677 = loc("offs_mid_o"(#loc316))
#loc678 = loc("offs_mid_o"(#loc317))
#loc679 = loc("offs_mid_o"(#loc318))
#loc680 = loc("offs_mid_o"(#loc319))
#loc681 = loc("offs_mid_o"(#loc320))
#loc682 = loc("offs_mid_o"(#loc321))
#loc683 = loc("offs_mid_o"(#loc322))
#loc684 = loc("offs_mid_o"(#loc323))
#loc685 = loc("offs_mid_lse"(#loc328))
#loc686 = loc("offs_mid_lse"(#loc329))
#loc687 = loc("offs_mid_lse"(#loc330))
#loc688 = loc("offs_mid_lse"(#loc331))
#loc689 = loc("offs_mid_lse"(#loc332))
#loc690 = loc("mask_lse"(#loc333))
#loc691 = loc("mask_lse"(#loc334))
#loc692 = loc("mask_lse"(#loc335))
#loc695 = loc("pids_per_xcd"(#loc344))
#loc696 = loc("pids_per_xcd"(#loc345))
#loc697 = loc("pids_per_xcd"(#loc346))
#loc698 = loc("tall_xcds"(#loc347))
#loc699 = loc("tall_xcds"(#loc348))
#loc700 = loc("tall_xcds"(#loc349))
#loc701 = loc("tall_xcds"(#loc350))
#loc702 = loc("xcd"(#loc351))
#loc703 = loc("local_pid"(#loc352))
#loc704 = loc("pid"(#loc355))
#loc705 = loc("pid"(#loc356))
#loc706 = loc("pid"(#loc357))
#loc707 = loc("pid"(#loc358))
#loc708 = loc("pid"(#loc359))
#loc709 = loc("pid"(#loc360))
#loc710 = loc("pid"(#loc361))
#loc711 = loc("pid"(#loc362))
#loc719 = loc("tail_block"(#loc473))
#loc720 = loc("tail_block"(#loc474))
#loc721 = loc("acc1"(#loc552))
#loc722 = loc("pid"(#loc705))
#loc723 = loc("pid"(#loc711))
#loc724 = loc("acc2"(#loc721))
#loc725 = loc("k_id"(#loc724))
#loc726 = loc("mask_k_id"(#loc725))
#loc727 = loc("mask_k"(#loc726))
#loc728 = loc("offs_buf_kv"(#loc727))
#loc729 = loc("kv1"(#loc728))
#loc730 = loc("kv2"(#loc729))
#loc731 = loc("smem_kv1"(#loc730))
#loc732 = loc("smem_kv2"(#loc731))
#loc733 = loc("k_id_pe"(#loc732))
#loc734 = loc("offs_buf_k_pe"(#loc733))
#loc735 = loc("mask_k_pe"(#loc734))
#loc736 = loc("k_pe"(#loc735))
#loc737 = loc("e_sum"(#loc736))
#loc738 = loc("e_max"(#loc737))
#loc739 = loc("cur_k1"(#loc738))
#loc740 = loc("cur_k2"(#loc739))
#loc741 = loc("kv1_transpose"(#loc740))
#loc742 = loc("kv2_transpose"(#loc741))
